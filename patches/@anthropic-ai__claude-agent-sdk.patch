diff --git a/sdk.mjs b/sdk.mjs
index 987d89a8b560486e3fa9333f18cc04da44b401c5..ba59beb85eb5eac556f370bc80dae6f72eaa61e7 100755
--- a/sdk.mjs
+++ b/sdk.mjs
@@ -12,11 +12,11 @@ var EK=Object.create;var{getPrototypeOf:PK,defineProperty:AQ,getOwnPropertyNames
               || ${G} === "boolean" || ${W} === null`).assign(H,m._`[${W}]`)}}}function rD({gen:Q,parentData:X,parentDataProperty:Y},$){Q.if(m._`${X} !== undefined`,()=>Q.assign(m._`${X}[${Y}]`,$))}function S$(Q,X,Y,$=r6.Correct){let W=$===r6.Correct?m.operators.EQ:m.operators.NEQ,J;switch(Q){case"null":return m._`${X} ${W} null`;case"array":J=m._`Array.isArray(${X})`;break;case"object":J=m._`${X} && typeof ${X} == "object" && !Array.isArray(${X})`;break;case"integer":J=G(m._`!(${X} % 1) && !isNaN(${X})`);break;case"number":J=G();break;default:return m._`typeof ${X} ${W} ${Q}`}return $===r6.Correct?J:(0,m.not)(J);function G(H=m.nil){return(0,m.and)(m._`typeof ${X} == "number"`,H,Y?m._`isFinite(${X})`:m.nil)}}D3.checkDataType=S$;function C$(Q,X,Y,$){if(Q.length===1)return S$(Q[0],X,Y,$);let W,J=(0,F3.toHash)(Q);if(J.array&&J.object){let G=m._`typeof ${X} != "object"`;W=J.null?G:m._`!${X} || ${G}`,delete J.null,delete J.array,delete J.object}else W=m.nil;if(J.number)delete J.integer;for(let G in J)W=(0,m.and)(W,S$(G,X,Y,$));return W}D3.checkDataTypes=C$;var tD={message:({schema:Q})=>`must be ${Q}`,params:({schema:Q,schemaValue:X})=>typeof Q=="string"?m._`{type: ${Q}}`:m._`{type: ${X}}`};function _$(Q){let X=aD(Q);(0,pD.reportError)(X,tD)}D3.reportTypeError=_$;function aD(Q){let{gen:X,data:Y,schema:$}=Q,W=(0,F3.schemaRefOrVal)(Q,$,"type");return{gen:X,keyword:"type",data:Y,schema:$.type,schemaCode:W,schemaValue:W,parentSchema:$,params:{},it:Q}}});var R3=E((A3)=>{Object.defineProperty(A3,"__esModule",{value:!0});A3.assignDefaults=void 0;var t6=c(),Ww=a();function Jw(Q,X){let{properties:Y,items:$}=Q.schema;if(X==="object"&&Y)for(let W in Y)M3(Q,W,Y[W].default);else if(X==="array"&&Array.isArray($))$.forEach((W,J)=>M3(Q,J,W.default))}A3.assignDefaults=Jw;function M3(Q,X,Y){let{gen:$,compositeRule:W,data:J,opts:G}=Q;if(Y===void 0)return;let H=t6._`${J}${(0,t6.getProperty)(X)}`;if(W){(0,Ww.checkStrictMode)(Q,`default is ignored for: ${H}`);return}let B=t6._`${H} === undefined`;if(G.useDefaults==="empty")B=t6._`${B} || ${H} === null || ${H} === ""`;$.if(B,t6._`${H} = ${(0,t6.stringify)(Y)}`)}});var o0=E((E3)=>{Object.defineProperty(E3,"__esModule",{value:!0});E3.validateUnion=E3.validateArray=E3.usePattern=E3.callValidateCode=E3.schemaProperties=E3.allSchemaProperties=E3.noPropertyInData=E3.propertyInData=E3.isOwnProperty=E3.hasPropFunc=E3.reportMissingProp=E3.checkMissingProp=E3.checkReportMissingProp=void 0;var G0=c(),k$=a(),d1=I1(),Gw=a();function Hw(Q,X){let{gen:Y,data:$,it:W}=Q;Y.if(T$(Y,$,X,W.opts.ownProperties),()=>{Q.setParams({missingProperty:G0._`${X}`},!0),Q.error()})}E3.checkReportMissingProp=Hw;function Bw({gen:Q,data:X,it:{opts:Y}},$,W){return(0,G0.or)(...$.map((J)=>(0,G0.and)(T$(Q,X,J,Y.ownProperties),G0._`${W} = ${J}`)))}E3.checkMissingProp=Bw;function zw(Q,X){Q.setParams({missingProperty:X},!0),Q.error()}E3.reportMissingProp=zw;function I3(Q){return Q.scopeValue("func",{ref:Object.prototype.hasOwnProperty,code:G0._`Object.prototype.hasOwnProperty`})}E3.hasPropFunc=I3;function v$(Q,X,Y){return G0._`${I3(Q)}.call(${X}, ${Y})`}E3.isOwnProperty=v$;function Kw(Q,X,Y,$){let W=G0._`${X}${(0,G0.getProperty)(Y)} !== undefined`;return $?G0._`${W} && ${v$(Q,X,Y)}`:W}E3.propertyInData=Kw;function T$(Q,X,Y,$){let W=G0._`${X}${(0,G0.getProperty)(Y)} === undefined`;return $?(0,G0.or)(W,(0,G0.not)(v$(Q,X,Y))):W}E3.noPropertyInData=T$;function b3(Q){return Q?Object.keys(Q).filter((X)=>X!=="__proto__"):[]}E3.allSchemaProperties=b3;function Vw(Q,X){return b3(X).filter((Y)=>!(0,k$.alwaysValidSchema)(Q,X[Y]))}E3.schemaProperties=Vw;function qw({schemaCode:Q,data:X,it:{gen:Y,topSchemaRef:$,schemaPath:W,errorPath:J},it:G},H,B,z){let K=z?G0._`${Q}, ${X}, ${$}${W}`:X,q=[[d1.default.instancePath,(0,G0.strConcat)(d1.default.instancePath,J)],[d1.default.parentData,G.parentData],[d1.default.parentDataProperty,G.parentDataProperty],[d1.default.rootData,d1.default.rootData]];if(G.opts.dynamicRef)q.push([d1.default.dynamicAnchors,d1.default.dynamicAnchors]);let U=G0._`${K}, ${Y.object(...q)}`;return B!==G0.nil?G0._`${H}.call(${B}, ${U})`:G0._`${H}(${U})`}E3.callValidateCode=qw;var Uw=G0._`new RegExp`;function Lw({gen:Q,it:{opts:X}},Y){let $=X.unicodeRegExp?"u":"",{regExp:W}=X.code,J=W(Y,$);return Q.scopeValue("pattern",{key:J.toString(),ref:J,code:G0._`${W.code==="new RegExp"?Uw:(0,Gw.useFunc)(Q,W)}(${Y}, ${$})`})}E3.usePattern=Lw;function Fw(Q){let{gen:X,data:Y,keyword:$,it:W}=Q,J=X.name("valid");if(W.allErrors){let H=X.let("valid",!0);return G(()=>X.assign(H,!1)),H}return X.var(J,!0),G(()=>X.break()),J;function G(H){let B=X.const("len",G0._`${Y}.length`);X.forRange("i",0,B,(z)=>{Q.subschema({keyword:$,dataProp:z,dataPropType:k$.Type.Num},J),X.if((0,G0.not)(J),H)})}}E3.validateArray=Fw;function Nw(Q){let{gen:X,schema:Y,keyword:$,it:W}=Q;if(!Array.isArray(Y))throw Error("ajv implementation error");if(Y.some((B)=>(0,k$.alwaysValidSchema)(W,B))&&!W.opts.unevaluated)return;let G=X.let("valid",!1),H=X.name("_valid");X.block(()=>Y.forEach((B,z)=>{let K=Q.subschema({keyword:$,schemaProp:z,compositeRule:!0},H);if(X.assign(G,G0._`${G} || ${H}`),!Q.mergeValidEvaluated(K,H))X.if((0,G0.not)(G))})),Q.result(G,()=>Q.reset(),()=>Q.error(!0))}E3.validateUnion=Nw});var k3=E((C3)=>{Object.defineProperty(C3,"__esModule",{value:!0});C3.validateKeywordUsage=C3.validSchemaType=C3.funcKeywordCode=C3.macroKeywordCode=void 0;var v0=c(),U6=I1(),Sw=o0(),Cw=Q9();function _w(Q,X){let{gen:Y,keyword:$,schema:W,parentSchema:J,it:G}=Q,H=X.macro.call(G.self,W,J,G),B=S3(Y,$,H);if(G.opts.validateSchema!==!1)G.self.validateSchema(H,!0);let z=Y.name("valid");Q.subschema({schema:H,schemaPath:v0.nil,errSchemaPath:`${G.errSchemaPath}/${$}`,topSchemaRef:B,compositeRule:!0},z),Q.pass(z,()=>Q.error(!0))}C3.macroKeywordCode=_w;function kw(Q,X){var Y;let{gen:$,keyword:W,schema:J,parentSchema:G,$data:H,it:B}=Q;Tw(B,X);let z=!H&&X.compile?X.compile.call(B.self,J,G,B):X.validate,K=S3($,W,z),q=$.let("valid");Q.block$data(q,U),Q.ok((Y=X.valid)!==null&&Y!==void 0?Y:q);function U(){if(X.errors===!1){if(F(),X.modifying)Z3(Q);w(()=>Q.error())}else{let D=X.async?V():L();if(X.modifying)Z3(Q);w(()=>vw(Q,D))}}function V(){let D=$.let("ruleErrs",null);return $.try(()=>F(v0._`await `),(j)=>$.assign(q,!1).if(v0._`${j} instanceof ${B.ValidationError}`,()=>$.assign(D,v0._`${j}.errors`),()=>$.throw(j))),D}function L(){let D=v0._`${K}.errors`;return $.assign(D,null),F(v0.nil),D}function F(D=X.async?v0._`await `:v0.nil){let j=B.opts.passContext?U6.default.this:U6.default.self,I=!(("compile"in X)&&!H||X.schema===!1);$.assign(q,v0._`${D}${(0,Sw.callValidateCode)(Q,K,j,I)}`,X.modifying)}function w(D){var j;$.if((0,v0.not)((j=X.valid)!==null&&j!==void 0?j:q),D)}}C3.funcKeywordCode=kw;function Z3(Q){let{gen:X,data:Y,it:$}=Q;X.if($.parentData,()=>X.assign(Y,v0._`${$.parentData}[${$.parentDataProperty}]`))}function vw(Q,X){let{gen:Y}=Q;Y.if(v0._`Array.isArray(${X})`,()=>{Y.assign(U6.default.vErrors,v0._`${U6.default.vErrors} === null ? ${X} : ${U6.default.vErrors}.concat(${X})`).assign(U6.default.errors,v0._`${U6.default.vErrors}.length`),(0,Cw.extendErrors)(Q)},()=>Q.error())}function Tw({schemaEnv:Q},X){if(X.async&&!Q.$async)throw Error("async keyword in sync schema")}function S3(Q,X,Y){if(Y===void 0)throw Error(`keyword "${X}" failed to compile`);return Q.scopeValue("keyword",typeof Y=="function"?{ref:Y}:{ref:Y,code:(0,v0.stringify)(Y)})}function xw(Q,X,Y=!1){return!X.length||X.some(($)=>$==="array"?Array.isArray(Q):$==="object"?Q&&typeof Q=="object"&&!Array.isArray(Q):typeof Q==$||Y&&typeof Q>"u")}C3.validSchemaType=xw;function yw({schema:Q,opts:X,self:Y,errSchemaPath:$},W,J){if(Array.isArray(W.keyword)?!W.keyword.includes(J):W.keyword!==J)throw Error("ajv implementation error");let G=W.dependencies;if(G===null||G===void 0?void 0:G.some((H)=>!Object.prototype.hasOwnProperty.call(Q,H)))throw Error(`parent schema must have dependencies of ${J}: ${G.join(",")}`);if(W.validateSchema){if(!W.validateSchema(Q[J])){let B=`keyword "${J}" value is invalid at path "${$}": `+Y.errorsText(W.validateSchema.errors);if(X.validateSchema==="log")Y.logger.error(B);else throw Error(B)}}}C3.validateKeywordUsage=yw});var y3=E((T3)=>{Object.defineProperty(T3,"__esModule",{value:!0});T3.extendSubschemaMode=T3.extendSubschemaData=T3.getSubschema=void 0;var K1=c(),v3=a();function uw(Q,{keyword:X,schemaProp:Y,schema:$,schemaPath:W,errSchemaPath:J,topSchemaRef:G}){if(X!==void 0&&$!==void 0)throw Error('both "keyword" and "schema" passed, only one allowed');if(X!==void 0){let H=Q.schema[X];return Y===void 0?{schema:H,schemaPath:K1._`${Q.schemaPath}${(0,K1.getProperty)(X)}`,errSchemaPath:`${Q.errSchemaPath}/${X}`}:{schema:H[Y],schemaPath:K1._`${Q.schemaPath}${(0,K1.getProperty)(X)}${(0,K1.getProperty)(Y)}`,errSchemaPath:`${Q.errSchemaPath}/${X}/${(0,v3.escapeFragment)(Y)}`}}if($!==void 0){if(W===void 0||J===void 0||G===void 0)throw Error('"schemaPath", "errSchemaPath" and "topSchemaRef" are required with "schema"');return{schema:$,schemaPath:W,topSchemaRef:G,errSchemaPath:J}}throw Error('either "keyword" or "schema" must be passed')}T3.getSubschema=uw;function lw(Q,X,{dataProp:Y,dataPropType:$,data:W,dataTypes:J,propertyName:G}){if(W!==void 0&&Y!==void 0)throw Error('both "data" and "dataProp" passed, only one allowed');let{gen:H}=X;if(Y!==void 0){let{errorPath:z,dataPathArr:K,opts:q}=X,U=H.let("data",K1._`${X.data}${(0,K1.getProperty)(Y)}`,!0);B(U),Q.errorPath=K1.str`${z}${(0,v3.getErrorPath)(Y,$,q.jsPropertySyntax)}`,Q.parentDataProperty=K1._`${Y}`,Q.dataPathArr=[...K,Q.parentDataProperty]}if(W!==void 0){let z=W instanceof K1.Name?W:H.let("data",W,!0);if(B(z),G!==void 0)Q.propertyName=G}if(J)Q.dataTypes=J;function B(z){Q.data=z,Q.dataLevel=X.dataLevel+1,Q.dataTypes=[],X.definedProperties=new Set,Q.parentData=X.data,Q.dataNames=[...X.dataNames,z]}}T3.extendSubschemaData=lw;function mw(Q,{jtdDiscriminator:X,jtdMetadata:Y,compositeRule:$,createErrors:W,allErrors:J}){if($!==void 0)Q.compositeRule=$;if(W!==void 0)Q.createErrors=W;if(J!==void 0)Q.allErrors=J;Q.jtdDiscriminator=X,Q.jtdMetadata=Y}T3.extendSubschemaMode=mw});var x$=E((WT,g3)=>{g3.exports=function Q(X,Y){if(X===Y)return!0;if(X&&Y&&typeof X=="object"&&typeof Y=="object"){if(X.constructor!==Y.constructor)return!1;var $,W,J;if(Array.isArray(X)){if($=X.length,$!=Y.length)return!1;for(W=$;W--!==0;)if(!Q(X[W],Y[W]))return!1;return!0}if(X.constructor===RegExp)return X.source===Y.source&&X.flags===Y.flags;if(X.valueOf!==Object.prototype.valueOf)return X.valueOf()===Y.valueOf();if(X.toString!==Object.prototype.toString)return X.toString()===Y.toString();if(J=Object.keys(X),$=J.length,$!==Object.keys(Y).length)return!1;for(W=$;W--!==0;)if(!Object.prototype.hasOwnProperty.call(Y,J[W]))return!1;for(W=$;W--!==0;){var G=J[W];if(!Q(X[G],Y[G]))return!1}return!0}return X!==X&&Y!==Y}});var f3=E((JT,h3)=>{var i1=h3.exports=function(Q,X,Y){if(typeof X=="function")Y=X,X={};Y=X.cb||Y;var $=typeof Y=="function"?Y:Y.pre||function(){},W=Y.post||function(){};o8(X,$,W,Q,"",Q)};i1.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0,if:!0,then:!0,else:!0};i1.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0};i1.propsKeywords={$defs:!0,definitions:!0,properties:!0,patternProperties:!0,dependencies:!0};i1.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0};function o8(Q,X,Y,$,W,J,G,H,B,z){if($&&typeof $=="object"&&!Array.isArray($)){X($,W,J,G,H,B,z);for(var K in $){var q=$[K];if(Array.isArray(q)){if(K in i1.arrayKeywords)for(var U=0;U<q.length;U++)o8(Q,X,Y,q[U],W+"/"+K+"/"+U,J,W,K,$,U)}else if(K in i1.propsKeywords){if(q&&typeof q=="object")for(var V in q)o8(Q,X,Y,q[V],W+"/"+K+"/"+dw(V),J,W,K,$,V)}else if(K in i1.keywords||Q.allKeys&&!(K in i1.skipKeywords))o8(Q,X,Y,q,W+"/"+K,J,W,K,$)}Y($,W,J,G,H,B,z)}}function dw(Q){return Q.replace(/~/g,"~0").replace(/\//g,"~1")}});var Y9=E((c3)=>{Object.defineProperty(c3,"__esModule",{value:!0});c3.getSchemaRefs=c3.resolveUrl=c3.normalizeId=c3._getFullPath=c3.getFullPath=c3.inlineRef=void 0;var iw=a(),nw=x$(),ow=f3(),rw=new Set(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum","const"]);function tw(Q,X=!0){if(typeof Q=="boolean")return!0;if(X===!0)return!y$(Q);if(!X)return!1;return u3(Q)<=X}c3.inlineRef=tw;var aw=new Set(["$ref","$recursiveRef","$recursiveAnchor","$dynamicRef","$dynamicAnchor"]);function y$(Q){for(let X in Q){if(aw.has(X))return!0;let Y=Q[X];if(Array.isArray(Y)&&Y.some(y$))return!0;if(typeof Y=="object"&&y$(Y))return!0}return!1}function u3(Q){let X=0;for(let Y in Q){if(Y==="$ref")return 1/0;if(X++,rw.has(Y))continue;if(typeof Q[Y]=="object")(0,iw.eachItem)(Q[Y],($)=>X+=u3($));if(X===1/0)return 1/0}return X}function l3(Q,X="",Y){if(Y!==!1)X=a6(X);let $=Q.parse(X);return m3(Q,$)}c3.getFullPath=l3;function m3(Q,X){return Q.serialize(X).split("#")[0]+"#"}c3._getFullPath=m3;var sw=/#\/?$/;function a6(Q){return Q?Q.replace(sw,""):""}c3.normalizeId=a6;function ew(Q,X,Y){return Y=a6(Y),Q.resolve(X,Y)}c3.resolveUrl=ew;var QM=/^[a-z_][-a-z0-9._]*$/i;function XM(Q,X){if(typeof Q=="boolean")return{};let{schemaId:Y,uriResolver:$}=this.opts,W=a6(Q[Y]||X),J={"":W},G=l3($,W,!1),H={},B=new Set;return ow(Q,{allKeys:!0},(q,U,V,L)=>{if(L===void 0)return;let F=G+U,w=J[L];if(typeof q[Y]=="string")w=D.call(this,q[Y]);j.call(this,q.$anchor),j.call(this,q.$dynamicAnchor),J[U]=w;function D(I){let T=this.opts.uriResolver.resolve;if(I=a6(w?T(w,I):I),B.has(I))throw K(I);B.add(I);let v=this.refs[I];if(typeof v=="string")v=this.refs[v];if(typeof v=="object")z(q,v.schema,I);else if(I!==a6(F))if(I[0]==="#")z(q,H[I],I),H[I]=q;else this.refs[I]=F;return I}function j(I){if(typeof I=="string"){if(!QM.test(I))throw Error(`invalid anchor "${I}"`);D.call(this,`#${I}`)}}}),H;function z(q,U,V){if(U!==void 0&&!nw(q,U))throw K(V)}function K(q){return Error(`reference "${q}" resolves to more than one schema`)}}c3.getSchemaRefs=XM});var J9=E((JH)=>{Object.defineProperty(JH,"__esModule",{value:!0});JH.getData=JH.KeywordCxt=JH.validateFunctionCode=void 0;var r3=B3(),d3=X9(),h$=Z$(),r8=X9(),HM=R3(),W9=k3(),g$=y3(),_=c(),f=I1(),BM=Y9(),b1=a(),$9=Q9();function zM(Q){if(s3(Q)){if(e3(Q),a3(Q)){qM(Q);return}}t3(Q,()=>(0,r3.topBoolOrEmptySchema)(Q))}JH.validateFunctionCode=zM;function t3({gen:Q,validateName:X,schema:Y,schemaEnv:$,opts:W},J){if(W.code.es5)Q.func(X,_._`${f.default.data}, ${f.default.valCxt}`,$.$async,()=>{Q.code(_._`"use strict"; ${i3(Y,W)}`),VM(Q,W),Q.code(J)});else Q.func(X,_._`${f.default.data}, ${KM(W)}`,$.$async,()=>Q.code(i3(Y,W)).code(J))}function KM(Q){return _._`{${f.default.instancePath}="", ${f.default.parentData}, ${f.default.parentDataProperty}, ${f.default.rootData}=${f.default.data}${Q.dynamicRef?_._`, ${f.default.dynamicAnchors}={}`:_.nil}}={}`}function VM(Q,X){Q.if(f.default.valCxt,()=>{if(Q.var(f.default.instancePath,_._`${f.default.valCxt}.${f.default.instancePath}`),Q.var(f.default.parentData,_._`${f.default.valCxt}.${f.default.parentData}`),Q.var(f.default.parentDataProperty,_._`${f.default.valCxt}.${f.default.parentDataProperty}`),Q.var(f.default.rootData,_._`${f.default.valCxt}.${f.default.rootData}`),X.dynamicRef)Q.var(f.default.dynamicAnchors,_._`${f.default.valCxt}.${f.default.dynamicAnchors}`)},()=>{if(Q.var(f.default.instancePath,_._`""`),Q.var(f.default.parentData,_._`undefined`),Q.var(f.default.parentDataProperty,_._`undefined`),Q.var(f.default.rootData,f.default.data),X.dynamicRef)Q.var(f.default.dynamicAnchors,_._`{}`)})}function qM(Q){let{schema:X,opts:Y,gen:$}=Q;t3(Q,()=>{if(Y.$comment&&X.$comment)XH(Q);if(OM(Q),$.let(f.default.vErrors,null),$.let(f.default.errors,0),Y.unevaluated)UM(Q);QH(Q),MM(Q)});return}function UM(Q){let{gen:X,validateName:Y}=Q;Q.evaluated=X.const("evaluated",_._`${Y}.evaluated`),X.if(_._`${Q.evaluated}.dynamicProps`,()=>X.assign(_._`${Q.evaluated}.props`,_._`undefined`)),X.if(_._`${Q.evaluated}.dynamicItems`,()=>X.assign(_._`${Q.evaluated}.items`,_._`undefined`))}function i3(Q,X){let Y=typeof Q=="object"&&Q[X.schemaId];return Y&&(X.code.source||X.code.process)?_._`/*# sourceURL=${Y} */`:_.nil}function LM(Q,X){if(s3(Q)){if(e3(Q),a3(Q)){FM(Q,X);return}}(0,r3.boolOrEmptySchema)(Q,X)}function a3({schema:Q,self:X}){if(typeof Q=="boolean")return!Q;for(let Y in Q)if(X.RULES.all[Y])return!0;return!1}function s3(Q){return typeof Q.schema!="boolean"}function FM(Q,X){let{schema:Y,gen:$,opts:W}=Q;if(W.$comment&&Y.$comment)XH(Q);DM(Q),wM(Q);let J=$.const("_errs",f.default.errors);QH(Q,J),$.var(X,_._`${J} === ${f.default.errors}`)}function e3(Q){(0,b1.checkUnknownRules)(Q),NM(Q)}function QH(Q,X){if(Q.opts.jtd)return n3(Q,[],!1,X);let Y=(0,d3.getSchemaTypes)(Q.schema),$=(0,d3.coerceAndCheckDataType)(Q,Y);n3(Q,Y,!$,X)}function NM(Q){let{schema:X,errSchemaPath:Y,opts:$,self:W}=Q;if(X.$ref&&$.ignoreKeywordsWithRef&&(0,b1.schemaHasRulesButRef)(X,W.RULES))W.logger.warn(`$ref: keywords ignored in schema at path "${Y}"`)}function OM(Q){let{schema:X,opts:Y}=Q;if(X.default!==void 0&&Y.useDefaults&&Y.strictSchema)(0,b1.checkStrictMode)(Q,"default is ignored in the schema root")}function DM(Q){let X=Q.schema[Q.opts.schemaId];if(X)Q.baseId=(0,BM.resolveUrl)(Q.opts.uriResolver,Q.baseId,X)}function wM(Q){if(Q.schema.$async&&!Q.schemaEnv.$async)throw Error("async schema in sync schema")}function XH({gen:Q,schemaEnv:X,schema:Y,errSchemaPath:$,opts:W}){let J=Y.$comment;if(W.$comment===!0)Q.code(_._`${f.default.self}.logger.log(${J})`);else if(typeof W.$comment=="function"){let G=_.str`${$}/$comment`,H=Q.scopeValue("root",{ref:X.root});Q.code(_._`${f.default.self}.opts.$comment(${J}, ${G}, ${H}.schema)`)}}function MM(Q){let{gen:X,schemaEnv:Y,validateName:$,ValidationError:W,opts:J}=Q;if(Y.$async)X.if(_._`${f.default.errors} === 0`,()=>X.return(f.default.data),()=>X.throw(_._`new ${W}(${f.default.vErrors})`));else{if(X.assign(_._`${$}.errors`,f.default.vErrors),J.unevaluated)AM(Q);X.return(_._`${f.default.errors} === 0`)}}function AM({gen:Q,evaluated:X,props:Y,items:$}){if(Y instanceof _.Name)Q.assign(_._`${X}.props`,Y);if($ instanceof _.Name)Q.assign(_._`${X}.items`,$)}function n3(Q,X,Y,$){let{gen:W,schema:J,data:G,allErrors:H,opts:B,self:z}=Q,{RULES:K}=z;if(J.$ref&&(B.ignoreKeywordsWithRef||!(0,b1.schemaHasRulesButRef)(J,K))){W.block(()=>$H(Q,"$ref",K.all.$ref.definition));return}if(!B.jtd)jM(Q,X);W.block(()=>{for(let U of K.rules)q(U);q(K.post)});function q(U){if(!(0,h$.shouldUseGroup)(J,U))return;if(U.type){if(W.if((0,r8.checkDataType)(U.type,G,B.strictNumbers)),o3(Q,U),X.length===1&&X[0]===U.type&&Y)W.else(),(0,r8.reportTypeError)(Q);W.endIf()}else o3(Q,U);if(!H)W.if(_._`${f.default.errors} === ${$||0}`)}}function o3(Q,X){let{gen:Y,schema:$,opts:{useDefaults:W}}=Q;if(W)(0,HM.assignDefaults)(Q,X.type);Y.block(()=>{for(let J of X.rules)if((0,h$.shouldUseRule)($,J))$H(Q,J.keyword,J.definition,X.type)})}function jM(Q,X){if(Q.schemaEnv.meta||!Q.opts.strictTypes)return;if(RM(Q,X),!Q.opts.allowUnionTypes)IM(Q,X);bM(Q,Q.dataTypes)}function RM(Q,X){if(!X.length)return;if(!Q.dataTypes.length){Q.dataTypes=X;return}X.forEach((Y)=>{if(!YH(Q.dataTypes,Y))f$(Q,`type "${Y}" not allowed by context "${Q.dataTypes.join(",")}"`)}),PM(Q,X)}function IM(Q,X){if(X.length>1&&!(X.length===2&&X.includes("null")))f$(Q,"use allowUnionTypes to allow union type keyword")}function bM(Q,X){let Y=Q.self.RULES.all;for(let $ in Y){let W=Y[$];if(typeof W=="object"&&(0,h$.shouldUseRule)(Q.schema,W)){let{type:J}=W.definition;if(J.length&&!J.some((G)=>EM(X,G)))f$(Q,`missing type "${J.join(",")}" for keyword "${$}"`)}}}function EM(Q,X){return Q.includes(X)||X==="number"&&Q.includes("integer")}function YH(Q,X){return Q.includes(X)||X==="integer"&&Q.includes("number")}function PM(Q,X){let Y=[];for(let $ of Q.dataTypes)if(YH(X,$))Y.push($);else if(X.includes("integer")&&$==="number")Y.push("integer");Q.dataTypes=Y}function f$(Q,X){let Y=Q.schemaEnv.baseId+Q.errSchemaPath;X+=` at "${Y}" (strictTypes)`,(0,b1.checkStrictMode)(Q,X,Q.opts.strictTypes)}class u${constructor(Q,X,Y){if((0,W9.validateKeywordUsage)(Q,X,Y),this.gen=Q.gen,this.allErrors=Q.allErrors,this.keyword=Y,this.data=Q.data,this.schema=Q.schema[Y],this.$data=X.$data&&Q.opts.$data&&this.schema&&this.schema.$data,this.schemaValue=(0,b1.schemaRefOrVal)(Q,this.schema,Y,this.$data),this.schemaType=X.schemaType,this.parentSchema=Q.schema,this.params={},this.it=Q,this.def=X,this.$data)this.schemaCode=Q.gen.const("vSchema",WH(this.$data,Q));else if(this.schemaCode=this.schemaValue,!(0,W9.validSchemaType)(this.schema,X.schemaType,X.allowUndefined))throw Error(`${Y} value must be ${JSON.stringify(X.schemaType)}`);if("code"in X?X.trackErrors:X.errors!==!1)this.errsCount=Q.gen.const("_errs",f.default.errors)}result(Q,X,Y){this.failResult((0,_.not)(Q),X,Y)}failResult(Q,X,Y){if(this.gen.if(Q),Y)Y();else this.error();if(X){if(this.gen.else(),X(),this.allErrors)this.gen.endIf()}else if(this.allErrors)this.gen.endIf();else this.gen.else()}pass(Q,X){this.failResult((0,_.not)(Q),void 0,X)}fail(Q){if(Q===void 0){if(this.error(),!this.allErrors)this.gen.if(!1);return}if(this.gen.if(Q),this.error(),this.allErrors)this.gen.endIf();else this.gen.else()}fail$data(Q){if(!this.$data)return this.fail(Q);let{schemaCode:X}=this;this.fail(_._`${X} !== undefined && (${(0,_.or)(this.invalid$data(),Q)})`)}error(Q,X,Y){if(X){this.setParams(X),this._error(Q,Y),this.setParams({});return}this._error(Q,Y)}_error(Q,X){(Q?$9.reportExtraError:$9.reportError)(this,this.def.error,X)}$dataError(){(0,$9.reportError)(this,this.def.$dataError||$9.keyword$DataError)}reset(){if(this.errsCount===void 0)throw Error('add "trackErrors" to keyword definition');(0,$9.resetErrorsCount)(this.gen,this.errsCount)}ok(Q){if(!this.allErrors)this.gen.if(Q)}setParams(Q,X){if(X)Object.assign(this.params,Q);else this.params=Q}block$data(Q,X,Y=_.nil){this.gen.block(()=>{this.check$data(Q,Y),X()})}check$data(Q=_.nil,X=_.nil){if(!this.$data)return;let{gen:Y,schemaCode:$,schemaType:W,def:J}=this;if(Y.if((0,_.or)(_._`${$} === undefined`,X)),Q!==_.nil)Y.assign(Q,!0);if(W.length||J.validateSchema){if(Y.elseIf(this.invalid$data()),this.$dataError(),Q!==_.nil)Y.assign(Q,!1)}Y.else()}invalid$data(){let{gen:Q,schemaCode:X,schemaType:Y,def:$,it:W}=this;return(0,_.or)(J(),G());function J(){if(Y.length){if(!(X instanceof _.Name))throw Error("ajv implementation error");let H=Array.isArray(Y)?Y:[Y];return _._`${(0,r8.checkDataTypes)(H,X,W.opts.strictNumbers,r8.DataType.Wrong)}`}return _.nil}function G(){if($.validateSchema){let H=Q.scopeValue("validate$data",{ref:$.validateSchema});return _._`!${H}(${X})`}return _.nil}}subschema(Q,X){let Y=(0,g$.getSubschema)(this.it,Q);(0,g$.extendSubschemaData)(Y,this.it,Q),(0,g$.extendSubschemaMode)(Y,Q);let $={...this.it,...Y,items:void 0,props:void 0};return LM($,X),$}mergeEvaluated(Q,X){let{it:Y,gen:$}=this;if(!Y.opts.unevaluated)return;if(Y.props!==!0&&Q.props!==void 0)Y.props=b1.mergeEvaluated.props($,Q.props,Y.props,X);if(Y.items!==!0&&Q.items!==void 0)Y.items=b1.mergeEvaluated.items($,Q.items,Y.items,X)}mergeValidEvaluated(Q,X){let{it:Y,gen:$}=this;if(Y.opts.unevaluated&&(Y.props!==!0||Y.items!==!0))return $.if(X,()=>this.mergeEvaluated(Q,_.Name)),!0}}JH.KeywordCxt=u$;function $H(Q,X,Y,$){let W=new u$(Q,Y,X);if("code"in Y)Y.code(W,$);else if(W.$data&&Y.validate)(0,W9.funcKeywordCode)(W,Y);else if("macro"in Y)(0,W9.macroKeywordCode)(W,Y);else if(Y.compile||Y.validate)(0,W9.funcKeywordCode)(W,Y)}var ZM=/^\/(?:[^~]|~0|~1)*$/,SM=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function WH(Q,{dataLevel:X,dataNames:Y,dataPathArr:$}){let W,J;if(Q==="")return f.default.rootData;if(Q[0]==="/"){if(!ZM.test(Q))throw Error(`Invalid JSON-pointer: ${Q}`);W=Q,J=f.default.rootData}else{let z=SM.exec(Q);if(!z)throw Error(`Invalid JSON-pointer: ${Q}`);let K=+z[1];if(W=z[2],W==="#"){if(K>=X)throw Error(B("property/index",K));return $[X-K]}if(K>X)throw Error(B("data",K));if(J=Y[X-K],!W)return J}let G=J,H=W.split("/");for(let z of H)if(z)J=_._`${J}${(0,_.getProperty)((0,b1.unescapeJsonPointer)(z))}`,G=_._`${G} && ${J}`;return G;function B(z,K){return`Cannot access ${z} ${K} levels up, current level is ${X}`}}JH.getData=WH});var t8=E((BH)=>{Object.defineProperty(BH,"__esModule",{value:!0});class HH extends Error{constructor(Q){super("validation failed");this.errors=Q,this.ajv=this.validation=!0}}BH.default=HH});var G9=E((KH)=>{Object.defineProperty(KH,"__esModule",{value:!0});var l$=Y9();class zH extends Error{constructor(Q,X,Y,$){super($||`can't resolve reference ${Y} from id ${X}`);this.missingRef=(0,l$.resolveUrl)(Q,X,Y),this.missingSchema=(0,l$.normalizeId)((0,l$.getFullPath)(Q,this.missingRef))}}KH.default=zH});var s8=E((UH)=>{Object.defineProperty(UH,"__esModule",{value:!0});UH.resolveSchema=UH.getCompilingSchema=UH.resolveRef=UH.compileSchema=UH.SchemaEnv=void 0;var Y1=c(),TM=t8(),L6=I1(),$1=Y9(),VH=a(),xM=J9();class H9{constructor(Q){var X;this.refs={},this.dynamicAnchors={};let Y;if(typeof Q.schema=="object")Y=Q.schema;this.schema=Q.schema,this.schemaId=Q.schemaId,this.root=Q.root||this,this.baseId=(X=Q.baseId)!==null&&X!==void 0?X:(0,$1.normalizeId)(Y===null||Y===void 0?void 0:Y[Q.schemaId||"$id"]),this.schemaPath=Q.schemaPath,this.localRefs=Q.localRefs,this.meta=Q.meta,this.$async=Y===null||Y===void 0?void 0:Y.$async,this.refs={}}}UH.SchemaEnv=H9;function c$(Q){let X=qH.call(this,Q);if(X)return X;let Y=(0,$1.getFullPath)(this.opts.uriResolver,Q.root.baseId),{es5:$,lines:W}=this.opts.code,{ownProperties:J}=this.opts,G=new Y1.CodeGen(this.scope,{es5:$,lines:W,ownProperties:J}),H;if(Q.$async)H=G.scopeValue("Error",{ref:TM.default,code:Y1._`require("ajv/dist/runtime/validation_error").default`});let B=G.scopeName("validate");Q.validateName=B;let z={gen:G,allErrors:this.opts.allErrors,data:L6.default.data,parentData:L6.default.parentData,parentDataProperty:L6.default.parentDataProperty,dataNames:[L6.default.data],dataPathArr:[Y1.nil],dataLevel:0,dataTypes:[],definedProperties:new Set,topSchemaRef:G.scopeValue("schema",this.opts.code.source===!0?{ref:Q.schema,code:(0,Y1.stringify)(Q.schema)}:{ref:Q.schema}),validateName:B,ValidationError:H,schema:Q.schema,schemaEnv:Q,rootId:Y,baseId:Q.baseId||Y,schemaPath:Y1.nil,errSchemaPath:Q.schemaPath||(this.opts.jtd?"":"#"),errorPath:Y1._`""`,opts:this.opts,self:this},K;try{this._compilations.add(Q),(0,xM.validateFunctionCode)(z),G.optimize(this.opts.code.optimize);let q=G.toString();if(K=`${G.scopeRefs(L6.default.scope)}return ${q}`,this.opts.code.process)K=this.opts.code.process(K,Q);let V=Function(`${L6.default.self}`,`${L6.default.scope}`,K)(this,this.scope.get());if(this.scope.value(B,{ref:V}),V.errors=null,V.schema=Q.schema,V.schemaEnv=Q,Q.$async)V.$async=!0;if(this.opts.code.source===!0)V.source={validateName:B,validateCode:q,scopeValues:G._values};if(this.opts.unevaluated){let{props:L,items:F}=z;if(V.evaluated={props:L instanceof Y1.Name?void 0:L,items:F instanceof Y1.Name?void 0:F,dynamicProps:L instanceof Y1.Name,dynamicItems:F instanceof Y1.Name},V.source)V.source.evaluated=(0,Y1.stringify)(V.evaluated)}return Q.validate=V,Q}catch(q){if(delete Q.validate,delete Q.validateName,K)this.logger.error("Error compiling schema, function code:",K);throw q}finally{this._compilations.delete(Q)}}UH.compileSchema=c$;function yM(Q,X,Y){var $;Y=(0,$1.resolveUrl)(this.opts.uriResolver,X,Y);let W=Q.refs[Y];if(W)return W;let J=fM.call(this,Q,Y);if(J===void 0){let G=($=Q.localRefs)===null||$===void 0?void 0:$[Y],{schemaId:H}=this.opts;if(G)J=new H9({schema:G,schemaId:H,root:Q,baseId:X})}if(J===void 0)return;return Q.refs[Y]=gM.call(this,J)}UH.resolveRef=yM;function gM(Q){if((0,$1.inlineRef)(Q.schema,this.opts.inlineRefs))return Q.schema;return Q.validate?Q:c$.call(this,Q)}function qH(Q){for(let X of this._compilations)if(hM(X,Q))return X}UH.getCompilingSchema=qH;function hM(Q,X){return Q.schema===X.schema&&Q.root===X.root&&Q.baseId===X.baseId}function fM(Q,X){let Y;while(typeof(Y=this.refs[X])=="string")X=Y;return Y||this.schemas[X]||a8.call(this,Q,X)}function a8(Q,X){let Y=this.opts.uriResolver.parse(X),$=(0,$1._getFullPath)(this.opts.uriResolver,Y),W=(0,$1.getFullPath)(this.opts.uriResolver,Q.baseId,void 0);if(Object.keys(Q.schema).length>0&&$===W)return m$.call(this,Y,Q);let J=(0,$1.normalizeId)($),G=this.refs[J]||this.schemas[J];if(typeof G=="string"){let H=a8.call(this,Q,G);if(typeof(H===null||H===void 0?void 0:H.schema)!=="object")return;return m$.call(this,Y,H)}if(typeof(G===null||G===void 0?void 0:G.schema)!=="object")return;if(!G.validate)c$.call(this,G);if(J===(0,$1.normalizeId)(X)){let{schema:H}=G,{schemaId:B}=this.opts,z=H[B];if(z)W=(0,$1.resolveUrl)(this.opts.uriResolver,W,z);return new H9({schema:H,schemaId:B,root:Q,baseId:W})}return m$.call(this,Y,G)}UH.resolveSchema=a8;var uM=new Set(["properties","patternProperties","enum","dependencies","definitions"]);function m$(Q,{baseId:X,schema:Y,root:$}){var W;if(((W=Q.fragment)===null||W===void 0?void 0:W[0])!=="/")return;for(let H of Q.fragment.slice(1).split("/")){if(typeof Y==="boolean")return;let B=Y[(0,VH.unescapeFragment)(H)];if(B===void 0)return;Y=B;let z=typeof Y==="object"&&Y[this.opts.schemaId];if(!uM.has(H)&&z)X=(0,$1.resolveUrl)(this.opts.uriResolver,X,z)}let J;if(typeof Y!="boolean"&&Y.$ref&&!(0,VH.schemaHasRulesButRef)(Y,this.RULES)){let H=(0,$1.resolveUrl)(this.opts.uriResolver,X,Y.$ref);J=a8.call(this,$,H)}let{schemaId:G}=this.opts;if(J=J||new H9({schema:Y,schemaId:G,root:$,baseId:X}),J.schema!==J.root.schema)return J;return}});var FH=E((VT,dM)=>{dM.exports={$id:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#",description:"Meta-schema for $data reference (JSON AnySchema extension proposal)",type:"object",required:["$data"],properties:{$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},additionalProperties:!1}});var OH=E((qT,NH)=>{var iM={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,a:10,A:10,b:11,B:11,c:12,C:12,d:13,D:13,e:14,E:14,f:15,F:15};NH.exports={HEX:iM}});var bH=E((UT,IH)=>{var{HEX:nM}=OH(),oM=/^(?:(?:25[0-5]|2[0-4]\d|1\d{2}|[1-9]\d|\d)\.){3}(?:25[0-5]|2[0-4]\d|1\d{2}|[1-9]\d|\d)$/u;function AH(Q){if(RH(Q,".")<3)return{host:Q,isIPV4:!1};let X=Q.match(oM)||[],[Y]=X;if(Y)return{host:tM(Y,"."),isIPV4:!0};else return{host:Q,isIPV4:!1}}function p$(Q,X=!1){let Y="",$=!0;for(let W of Q){if(nM[W]===void 0)return;if(W!=="0"&&$===!0)$=!1;if(!$)Y+=W}if(X&&Y.length===0)Y="0";return Y}function rM(Q){let X=0,Y={error:!1,address:"",zone:""},$=[],W=[],J=!1,G=!1,H=!1;function B(){if(W.length){if(J===!1){let z=p$(W);if(z!==void 0)$.push(z);else return Y.error=!0,!1}W.length=0}return!0}for(let z=0;z<Q.length;z++){let K=Q[z];if(K==="["||K==="]")continue;if(K===":"){if(G===!0)H=!0;if(!B())break;if(X++,$.push(":"),X>7){Y.error=!0;break}if(z-1>=0&&Q[z-1]===":")G=!0;continue}else if(K==="%"){if(!B())break;J=!0}else{W.push(K);continue}}if(W.length)if(J)Y.zone=W.join("");else if(H)$.push(W.join(""));else $.push(p$(W));return Y.address=$.join(""),Y}function jH(Q){if(RH(Q,":")<2)return{host:Q,isIPV6:!1};let X=rM(Q);if(!X.error){let{address:Y,address:$}=X;if(X.zone)Y+="%"+X.zone,$+="%25"+X.zone;return{host:Y,escapedHost:$,isIPV6:!0}}else return{host:Q,isIPV6:!1}}function tM(Q,X){let Y="",$=!0,W=Q.length;for(let J=0;J<W;J++){let G=Q[J];if(G==="0"&&$){if(J+1<=W&&Q[J+1]===X||J+1===W)Y+=G,$=!1}else{if(G===X)$=!0;else $=!1;Y+=G}}return Y}function RH(Q,X){let Y=0;for(let $=0;$<Q.length;$++)if(Q[$]===X)Y++;return Y}var DH=/^\.\.?\//u,wH=/^\/\.(?:\/|$)/u,MH=/^\/\.\.(?:\/|$)/u,aM=/^\/?(?:.|\n)*?(?=\/|$)/u;function sM(Q){let X=[];while(Q.length)if(Q.match(DH))Q=Q.replace(DH,"");else if(Q.match(wH))Q=Q.replace(wH,"/");else if(Q.match(MH))Q=Q.replace(MH,"/"),X.pop();else if(Q==="."||Q==="..")Q="";else{let Y=Q.match(aM);if(Y){let $=Y[0];Q=Q.slice($.length),X.push($)}else throw Error("Unexpected dot segment condition")}return X.join("")}function eM(Q,X){let Y=X!==!0?escape:unescape;if(Q.scheme!==void 0)Q.scheme=Y(Q.scheme);if(Q.userinfo!==void 0)Q.userinfo=Y(Q.userinfo);if(Q.host!==void 0)Q.host=Y(Q.host);if(Q.path!==void 0)Q.path=Y(Q.path);if(Q.query!==void 0)Q.query=Y(Q.query);if(Q.fragment!==void 0)Q.fragment=Y(Q.fragment);return Q}function QA(Q){let X=[];if(Q.userinfo!==void 0)X.push(Q.userinfo),X.push("@");if(Q.host!==void 0){let Y=unescape(Q.host),$=AH(Y);if($.isIPV4)Y=$.host;else{let W=jH($.host);if(W.isIPV6===!0)Y=`[${W.escapedHost}]`;else Y=Q.host}X.push(Y)}if(typeof Q.port==="number"||typeof Q.port==="string")X.push(":"),X.push(String(Q.port));return X.length?X.join(""):void 0}IH.exports={recomposeAuthority:QA,normalizeComponentEncoding:eM,removeDotSegments:sM,normalizeIPv4:AH,normalizeIPv6:jH,stringArrayToHexStripped:p$}});var _H=E((LT,CH)=>{var XA=/^[\da-f]{8}-[\da-f]{4}-[\da-f]{4}-[\da-f]{4}-[\da-f]{12}$/iu,YA=/([\da-z][\d\-a-z]{0,31}):((?:[\w!$'()*+,\-.:;=@]|%[\da-f]{2})+)/iu;function EH(Q){return typeof Q.secure==="boolean"?Q.secure:String(Q.scheme).toLowerCase()==="wss"}function PH(Q){if(!Q.host)Q.error=Q.error||"HTTP URIs must have a host.";return Q}function ZH(Q){let X=String(Q.scheme).toLowerCase()==="https";if(Q.port===(X?443:80)||Q.port==="")Q.port=void 0;if(!Q.path)Q.path="/";return Q}function $A(Q){return Q.secure=EH(Q),Q.resourceName=(Q.path||"/")+(Q.query?"?"+Q.query:""),Q.path=void 0,Q.query=void 0,Q}function WA(Q){if(Q.port===(EH(Q)?443:80)||Q.port==="")Q.port=void 0;if(typeof Q.secure==="boolean")Q.scheme=Q.secure?"wss":"ws",Q.secure=void 0;if(Q.resourceName){let[X,Y]=Q.resourceName.split("?");Q.path=X&&X!=="/"?X:void 0,Q.query=Y,Q.resourceName=void 0}return Q.fragment=void 0,Q}function JA(Q,X){if(!Q.path)return Q.error="URN can not be parsed",Q;let Y=Q.path.match(YA);if(Y){let $=X.scheme||Q.scheme||"urn";Q.nid=Y[1].toLowerCase(),Q.nss=Y[2];let W=`${$}:${X.nid||Q.nid}`,J=d$[W];if(Q.path=void 0,J)Q=J.parse(Q,X)}else Q.error=Q.error||"URN can not be parsed.";return Q}function GA(Q,X){let Y=X.scheme||Q.scheme||"urn",$=Q.nid.toLowerCase(),W=`${Y}:${X.nid||$}`,J=d$[W];if(J)Q=J.serialize(Q,X);let G=Q,H=Q.nss;return G.path=`${$||X.nid}:${H}`,X.skipEscape=!0,G}function HA(Q,X){let Y=Q;if(Y.uuid=Y.nss,Y.nss=void 0,!X.tolerant&&(!Y.uuid||!XA.test(Y.uuid)))Y.error=Y.error||"UUID is not valid.";return Y}function BA(Q){let X=Q;return X.nss=(Q.uuid||"").toLowerCase(),X}var SH={scheme:"http",domainHost:!0,parse:PH,serialize:ZH},zA={scheme:"https",domainHost:SH.domainHost,parse:PH,serialize:ZH},e8={scheme:"ws",domainHost:!0,parse:$A,serialize:WA},KA={scheme:"wss",domainHost:e8.domainHost,parse:e8.parse,serialize:e8.serialize},VA={scheme:"urn",parse:JA,serialize:GA,skipNormalize:!0},qA={scheme:"urn:uuid",parse:HA,serialize:BA,skipNormalize:!0},d$={http:SH,https:zA,ws:e8,wss:KA,urn:VA,"urn:uuid":qA};CH.exports=d$});var vH=E((FT,XQ)=>{var{normalizeIPv6:UA,normalizeIPv4:LA,removeDotSegments:B9,recomposeAuthority:FA,normalizeComponentEncoding:QQ}=bH(),i$=_H();function NA(Q,X){if(typeof Q==="string")Q=V1(E1(Q,X),X);else if(typeof Q==="object")Q=E1(V1(Q,X),X);return Q}function OA(Q,X,Y){let $=Object.assign({scheme:"null"},Y),W=kH(E1(Q,$),E1(X,$),$,!0);return V1(W,{...$,skipEscape:!0})}function kH(Q,X,Y,$){let W={};if(!$)Q=E1(V1(Q,Y),Y),X=E1(V1(X,Y),Y);if(Y=Y||{},!Y.tolerant&&X.scheme)W.scheme=X.scheme,W.userinfo=X.userinfo,W.host=X.host,W.port=X.port,W.path=B9(X.path||""),W.query=X.query;else{if(X.userinfo!==void 0||X.host!==void 0||X.port!==void 0)W.userinfo=X.userinfo,W.host=X.host,W.port=X.port,W.path=B9(X.path||""),W.query=X.query;else{if(!X.path)if(W.path=Q.path,X.query!==void 0)W.query=X.query;else W.query=Q.query;else{if(X.path.charAt(0)==="/")W.path=B9(X.path);else{if((Q.userinfo!==void 0||Q.host!==void 0||Q.port!==void 0)&&!Q.path)W.path="/"+X.path;else if(!Q.path)W.path=X.path;else W.path=Q.path.slice(0,Q.path.lastIndexOf("/")+1)+X.path;W.path=B9(W.path)}W.query=X.query}W.userinfo=Q.userinfo,W.host=Q.host,W.port=Q.port}W.scheme=Q.scheme}return W.fragment=X.fragment,W}function DA(Q,X,Y){if(typeof Q==="string")Q=unescape(Q),Q=V1(QQ(E1(Q,Y),!0),{...Y,skipEscape:!0});else if(typeof Q==="object")Q=V1(QQ(Q,!0),{...Y,skipEscape:!0});if(typeof X==="string")X=unescape(X),X=V1(QQ(E1(X,Y),!0),{...Y,skipEscape:!0});else if(typeof X==="object")X=V1(QQ(X,!0),{...Y,skipEscape:!0});return Q.toLowerCase()===X.toLowerCase()}function V1(Q,X){let Y={host:Q.host,scheme:Q.scheme,userinfo:Q.userinfo,port:Q.port,path:Q.path,query:Q.query,nid:Q.nid,nss:Q.nss,uuid:Q.uuid,fragment:Q.fragment,reference:Q.reference,resourceName:Q.resourceName,secure:Q.secure,error:""},$=Object.assign({},X),W=[],J=i$[($.scheme||Y.scheme||"").toLowerCase()];if(J&&J.serialize)J.serialize(Y,$);if(Y.path!==void 0)if(!$.skipEscape){if(Y.path=escape(Y.path),Y.scheme!==void 0)Y.path=Y.path.split("%3A").join(":")}else Y.path=unescape(Y.path);if($.reference!=="suffix"&&Y.scheme)W.push(Y.scheme,":");let G=FA(Y);if(G!==void 0){if($.reference!=="suffix")W.push("//");if(W.push(G),Y.path&&Y.path.charAt(0)!=="/")W.push("/")}if(Y.path!==void 0){let H=Y.path;if(!$.absolutePath&&(!J||!J.absolutePath))H=B9(H);if(G===void 0)H=H.replace(/^\/\//u,"/%2F");W.push(H)}if(Y.query!==void 0)W.push("?",Y.query);if(Y.fragment!==void 0)W.push("#",Y.fragment);return W.join("")}var wA=Array.from({length:127},(Q,X)=>/[^!"$&'()*+,\-.;=_`a-z{}~]/u.test(String.fromCharCode(X)));function MA(Q){let X=0;for(let Y=0,$=Q.length;Y<$;++Y)if(X=Q.charCodeAt(Y),X>126||wA[X])return!0;return!1}var AA=/^(?:([^#/:?]+):)?(?:\/\/((?:([^#/?@]*)@)?(\[[^#/?\]]+\]|[^#/:?]*)(?::(\d*))?))?([^#?]*)(?:\?([^#]*))?(?:#((?:.|[\n\r])*))?/u;function E1(Q,X){let Y=Object.assign({},X),$={scheme:void 0,userinfo:void 0,host:"",port:void 0,path:"",query:void 0,fragment:void 0},W=Q.indexOf("%")!==-1,J=!1;if(Y.reference==="suffix")Q=(Y.scheme?Y.scheme+":":"")+"//"+Q;let G=Q.match(AA);if(G){if($.scheme=G[1],$.userinfo=G[3],$.host=G[4],$.port=parseInt(G[5],10),$.path=G[6]||"",$.query=G[7],$.fragment=G[8],isNaN($.port))$.port=G[5];if($.host){let B=LA($.host);if(B.isIPV4===!1){let z=UA(B.host);$.host=z.host.toLowerCase(),J=z.isIPV6}else $.host=B.host,J=!0}if($.scheme===void 0&&$.userinfo===void 0&&$.host===void 0&&$.port===void 0&&$.query===void 0&&!$.path)$.reference="same-document";else if($.scheme===void 0)$.reference="relative";else if($.fragment===void 0)$.reference="absolute";else $.reference="uri";if(Y.reference&&Y.reference!=="suffix"&&Y.reference!==$.reference)$.error=$.error||"URI is not a "+Y.reference+" reference.";let H=i$[(Y.scheme||$.scheme||"").toLowerCase()];if(!Y.unicodeSupport&&(!H||!H.unicodeSupport)){if($.host&&(Y.domainHost||H&&H.domainHost)&&J===!1&&MA($.host))try{$.host=URL.domainToASCII($.host.toLowerCase())}catch(B){$.error=$.error||"Host's domain name can not be converted to ASCII: "+B}}if(!H||H&&!H.skipNormalize){if(W&&$.scheme!==void 0)$.scheme=unescape($.scheme);if(W&&$.host!==void 0)$.host=unescape($.host);if($.path)$.path=escape(unescape($.path));if($.fragment)$.fragment=encodeURI(decodeURIComponent($.fragment))}if(H&&H.parse)H.parse($,Y)}else $.error=$.error||"URI can not be parsed.";return $}var n$={SCHEMES:i$,normalize:NA,resolve:OA,resolveComponents:kH,equal:DA,serialize:V1,parse:E1};XQ.exports=n$;XQ.exports.default=n$;XQ.exports.fastUri=n$});var yH=E((xH)=>{Object.defineProperty(xH,"__esModule",{value:!0});var TH=vH();TH.code='require("ajv/dist/runtime/uri").default';xH.default=TH});var pH=E((P1)=>{Object.defineProperty(P1,"__esModule",{value:!0});P1.CodeGen=P1.Name=P1.nil=P1.stringify=P1.str=P1._=P1.KeywordCxt=void 0;var RA=J9();Object.defineProperty(P1,"KeywordCxt",{enumerable:!0,get:function(){return RA.KeywordCxt}});var s6=c();Object.defineProperty(P1,"_",{enumerable:!0,get:function(){return s6._}});Object.defineProperty(P1,"str",{enumerable:!0,get:function(){return s6.str}});Object.defineProperty(P1,"stringify",{enumerable:!0,get:function(){return s6.stringify}});Object.defineProperty(P1,"nil",{enumerable:!0,get:function(){return s6.nil}});Object.defineProperty(P1,"Name",{enumerable:!0,get:function(){return s6.Name}});Object.defineProperty(P1,"CodeGen",{enumerable:!0,get:function(){return s6.CodeGen}});var IA=t8(),lH=G9(),bA=P$(),z9=s8(),EA=c(),K9=Y9(),YQ=X9(),r$=a(),gH=FH(),PA=yH(),mH=(Q,X)=>new RegExp(Q,X);mH.code="new RegExp";var ZA=["removeAdditional","useDefaults","coerceTypes"],SA=new Set(["validate","serialize","parse","wrapper","root","schema","keyword","pattern","formats","validate$data","func","obj","Error"]),CA={errorDataPath:"",format:"`validateFormats: false` can be used instead.",nullable:'"nullable" keyword is supported by default.',jsonPointers:"Deprecated jsPropertySyntax can be used instead.",extendRefs:"Deprecated ignoreKeywordsWithRef can be used instead.",missingRefs:"Pass empty schema with $id that should be ignored to ajv.addSchema.",processCode:"Use option `code: {process: (code, schemaEnv: object) => string}`",sourceCode:"Use option `code: {source: true}`",strictDefaults:"It is default now, see option `strict`.",strictKeywords:"It is default now, see option `strict`.",uniqueItems:'"uniqueItems" keyword is always validated.',unknownFormats:"Disable strict mode or pass `true` to `ajv.addFormat` (or `formats` option).",cache:"Map is used as cache, schema object as key.",serialize:"Map is used as cache, schema object as key.",ajvErrors:"It is default now."},_A={ignoreKeywordsWithRef:"",jsPropertySyntax:"",unicode:'"minLength"/"maxLength" account for unicode characters by default.'},hH=200;function kA(Q){var X,Y,$,W,J,G,H,B,z,K,q,U,V,L,F,w,D,j,I,T,v,N0,O0,c0,t1;let U1=Q.strict,a1=(X=Q.code)===null||X===void 0?void 0:X.optimize,Z1=a1===!0||a1===void 0?1:a1||0,s1=($=(Y=Q.code)===null||Y===void 0?void 0:Y.regExp)!==null&&$!==void 0?$:mH,u=(W=Q.uriResolver)!==null&&W!==void 0?W:PA.default;return{strictSchema:(G=(J=Q.strictSchema)!==null&&J!==void 0?J:U1)!==null&&G!==void 0?G:!0,strictNumbers:(B=(H=Q.strictNumbers)!==null&&H!==void 0?H:U1)!==null&&B!==void 0?B:!0,strictTypes:(K=(z=Q.strictTypes)!==null&&z!==void 0?z:U1)!==null&&K!==void 0?K:"log",strictTuples:(U=(q=Q.strictTuples)!==null&&q!==void 0?q:U1)!==null&&U!==void 0?U:"log",strictRequired:(L=(V=Q.strictRequired)!==null&&V!==void 0?V:U1)!==null&&L!==void 0?L:!1,code:Q.code?{...Q.code,optimize:Z1,regExp:s1}:{optimize:Z1,regExp:s1},loopRequired:(F=Q.loopRequired)!==null&&F!==void 0?F:hH,loopEnum:(w=Q.loopEnum)!==null&&w!==void 0?w:hH,meta:(D=Q.meta)!==null&&D!==void 0?D:!0,messages:(j=Q.messages)!==null&&j!==void 0?j:!0,inlineRefs:(I=Q.inlineRefs)!==null&&I!==void 0?I:!0,schemaId:(T=Q.schemaId)!==null&&T!==void 0?T:"$id",addUsedSchema:(v=Q.addUsedSchema)!==null&&v!==void 0?v:!0,validateSchema:(N0=Q.validateSchema)!==null&&N0!==void 0?N0:!0,validateFormats:(O0=Q.validateFormats)!==null&&O0!==void 0?O0:!0,unicodeRegExp:(c0=Q.unicodeRegExp)!==null&&c0!==void 0?c0:!0,int32range:(t1=Q.int32range)!==null&&t1!==void 0?t1:!0,uriResolver:u}}class $Q{constructor(Q={}){this.schemas={},this.refs={},this.formats={},this._compilations=new Set,this._loading={},this._cache=new Map,Q=this.opts={...Q,...kA(Q)};let{es5:X,lines:Y}=this.opts.code;this.scope=new EA.ValueScope({scope:{},prefixes:SA,es5:X,lines:Y}),this.logger=hA(Q.logger);let $=Q.validateFormats;if(Q.validateFormats=!1,this.RULES=(0,bA.getRules)(),fH.call(this,CA,Q,"NOT SUPPORTED"),fH.call(this,_A,Q,"DEPRECATED","warn"),this._metaOpts=yA.call(this),Q.formats)TA.call(this);if(this._addVocabularies(),this._addDefaultMetaSchema(),Q.keywords)xA.call(this,Q.keywords);if(typeof Q.meta=="object")this.addMetaSchema(Q.meta);vA.call(this),Q.validateFormats=$}_addVocabularies(){this.addKeyword("$async")}_addDefaultMetaSchema(){let{$data:Q,meta:X,schemaId:Y}=this.opts,$=gH;if(Y==="id")$={...gH},$.id=$.$id,delete $.$id;if(X&&Q)this.addMetaSchema($,$[Y],!1)}defaultMeta(){let{meta:Q,schemaId:X}=this.opts;return this.opts.defaultMeta=typeof Q=="object"?Q[X]||Q:void 0}validate(Q,X){let Y;if(typeof Q=="string"){if(Y=this.getSchema(Q),!Y)throw Error(`no schema with key or ref "${Q}"`)}else Y=this.compile(Q);let $=Y(X);if(!("$async"in Y))this.errors=Y.errors;return $}compile(Q,X){let Y=this._addSchema(Q,X);return Y.validate||this._compileSchemaEnv(Y)}compileAsync(Q,X){if(typeof this.opts.loadSchema!="function")throw Error("options.loadSchema should be a function");let{loadSchema:Y}=this.opts;return $.call(this,Q,X);async function $(z,K){await W.call(this,z.$schema);let q=this._addSchema(z,K);return q.validate||J.call(this,q)}async function W(z){if(z&&!this.getSchema(z))await $.call(this,{$ref:z},!0)}async function J(z){try{return this._compileSchemaEnv(z)}catch(K){if(!(K instanceof lH.default))throw K;return G.call(this,K),await H.call(this,K.missingSchema),J.call(this,z)}}function G({missingSchema:z,missingRef:K}){if(this.refs[z])throw Error(`AnySchema ${z} is loaded but ${K} cannot be resolved`)}async function H(z){let K=await B.call(this,z);if(!this.refs[z])await W.call(this,K.$schema);if(!this.refs[z])this.addSchema(K,z,X)}async function B(z){let K=this._loading[z];if(K)return K;try{return await(this._loading[z]=Y(z))}finally{delete this._loading[z]}}}addSchema(Q,X,Y,$=this.opts.validateSchema){if(Array.isArray(Q)){for(let J of Q)this.addSchema(J,void 0,Y,$);return this}let W;if(typeof Q==="object"){let{schemaId:J}=this.opts;if(W=Q[J],W!==void 0&&typeof W!="string")throw Error(`schema ${J} must be string`)}return X=(0,K9.normalizeId)(X||W),this._checkUnique(X),this.schemas[X]=this._addSchema(Q,Y,X,$,!0),this}addMetaSchema(Q,X,Y=this.opts.validateSchema){return this.addSchema(Q,X,!0,Y),this}validateSchema(Q,X){if(typeof Q=="boolean")return!0;let Y;if(Y=Q.$schema,Y!==void 0&&typeof Y!="string")throw Error("$schema must be a string");if(Y=Y||this.opts.defaultMeta||this.defaultMeta(),!Y)return this.logger.warn("meta-schema not available"),this.errors=null,!0;let $=this.validate(Y,Q);if(!$&&X){let W="schema is invalid: "+this.errorsText();if(this.opts.validateSchema==="log")this.logger.error(W);else throw Error(W)}return $}getSchema(Q){let X;while(typeof(X=uH.call(this,Q))=="string")Q=X;if(X===void 0){let{schemaId:Y}=this.opts,$=new z9.SchemaEnv({schema:{},schemaId:Y});if(X=z9.resolveSchema.call(this,$,Q),!X)return;this.refs[Q]=X}return X.validate||this._compileSchemaEnv(X)}removeSchema(Q){if(Q instanceof RegExp)return this._removeAllSchemas(this.schemas,Q),this._removeAllSchemas(this.refs,Q),this;switch(typeof Q){case"undefined":return this._removeAllSchemas(this.schemas),this._removeAllSchemas(this.refs),this._cache.clear(),this;case"string":{let X=uH.call(this,Q);if(typeof X=="object")this._cache.delete(X.schema);return delete this.schemas[Q],delete this.refs[Q],this}case"object":{let X=Q;this._cache.delete(X);let Y=Q[this.opts.schemaId];if(Y)Y=(0,K9.normalizeId)(Y),delete this.schemas[Y],delete this.refs[Y];return this}default:throw Error("ajv.removeSchema: invalid parameter")}}addVocabulary(Q){for(let X of Q)this.addKeyword(X);return this}addKeyword(Q,X){let Y;if(typeof Q=="string"){if(Y=Q,typeof X=="object")this.logger.warn("these parameters are deprecated, see docs for addKeyword"),X.keyword=Y}else if(typeof Q=="object"&&X===void 0){if(X=Q,Y=X.keyword,Array.isArray(Y)&&!Y.length)throw Error("addKeywords: keyword must be string or non-empty array")}else throw Error("invalid addKeywords parameters");if(uA.call(this,Y,X),!X)return(0,r$.eachItem)(Y,(W)=>o$.call(this,W)),this;mA.call(this,X);let $={...X,type:(0,YQ.getJSONTypes)(X.type),schemaType:(0,YQ.getJSONTypes)(X.schemaType)};return(0,r$.eachItem)(Y,$.type.length===0?(W)=>o$.call(this,W,$):(W)=>$.type.forEach((J)=>o$.call(this,W,$,J))),this}getKeyword(Q){let X=this.RULES.all[Q];return typeof X=="object"?X.definition:!!X}removeKeyword(Q){let{RULES:X}=this;delete X.keywords[Q],delete X.all[Q];for(let Y of X.rules){let $=Y.rules.findIndex((W)=>W.keyword===Q);if($>=0)Y.rules.splice($,1)}return this}addFormat(Q,X){if(typeof X=="string")X=new RegExp(X);return this.formats[Q]=X,this}errorsText(Q=this.errors,{separator:X=", ",dataVar:Y="data"}={}){if(!Q||Q.length===0)return"No errors";return Q.map(($)=>`${Y}${$.instancePath} ${$.message}`).reduce(($,W)=>$+X+W)}$dataMetaSchema(Q,X){let Y=this.RULES.all;Q=JSON.parse(JSON.stringify(Q));for(let $ of X){let W=$.split("/").slice(1),J=Q;for(let G of W)J=J[G];for(let G in Y){let H=Y[G];if(typeof H!="object")continue;let{$data:B}=H.definition,z=J[G];if(B&&z)J[G]=cH(z)}}return Q}_removeAllSchemas(Q,X){for(let Y in Q){let $=Q[Y];if(!X||X.test(Y)){if(typeof $=="string")delete Q[Y];else if($&&!$.meta)this._cache.delete($.schema),delete Q[Y]}}}_addSchema(Q,X,Y,$=this.opts.validateSchema,W=this.opts.addUsedSchema){let J,{schemaId:G}=this.opts;if(typeof Q=="object")J=Q[G];else if(this.opts.jtd)throw Error("schema must be object");else if(typeof Q!="boolean")throw Error("schema must be object or boolean");let H=this._cache.get(Q);if(H!==void 0)return H;Y=(0,K9.normalizeId)(J||Y);let B=K9.getSchemaRefs.call(this,Q,Y);if(H=new z9.SchemaEnv({schema:Q,schemaId:G,meta:X,baseId:Y,localRefs:B}),this._cache.set(H.schema,H),W&&!Y.startsWith("#")){if(Y)this._checkUnique(Y);this.refs[Y]=H}if($)this.validateSchema(Q,!0);return H}_checkUnique(Q){if(this.schemas[Q]||this.refs[Q])throw Error(`schema with key or id "${Q}" already exists`)}_compileSchemaEnv(Q){if(Q.meta)this._compileMetaSchema(Q);else z9.compileSchema.call(this,Q);if(!Q.validate)throw Error("ajv implementation error");return Q.validate}_compileMetaSchema(Q){let X=this.opts;this.opts=this._metaOpts;try{z9.compileSchema.call(this,Q)}finally{this.opts=X}}}$Q.ValidationError=IA.default;$Q.MissingRefError=lH.default;P1.default=$Q;function fH(Q,X,Y,$="error"){for(let W in Q){let J=W;if(J in X)this.logger[$](`${Y}: option ${W}. ${Q[J]}`)}}function uH(Q){return Q=(0,K9.normalizeId)(Q),this.schemas[Q]||this.refs[Q]}function vA(){let Q=this.opts.schemas;if(!Q)return;if(Array.isArray(Q))this.addSchema(Q);else for(let X in Q)this.addSchema(Q[X],X)}function TA(){for(let Q in this.opts.formats){let X=this.opts.formats[Q];if(X)this.addFormat(Q,X)}}function xA(Q){if(Array.isArray(Q)){this.addVocabulary(Q);return}this.logger.warn("keywords option as map is deprecated, pass array");for(let X in Q){let Y=Q[X];if(!Y.keyword)Y.keyword=X;this.addKeyword(Y)}}function yA(){let Q={...this.opts};for(let X of ZA)delete Q[X];return Q}var gA={log(){},warn(){},error(){}};function hA(Q){if(Q===!1)return gA;if(Q===void 0)return console;if(Q.log&&Q.warn&&Q.error)return Q;throw Error("logger must implement log, warn and error methods")}var fA=/^[a-z_$][a-z0-9_$:-]*$/i;function uA(Q,X){let{RULES:Y}=this;if((0,r$.eachItem)(Q,($)=>{if(Y.keywords[$])throw Error(`Keyword ${$} is already defined`);if(!fA.test($))throw Error(`Keyword ${$} has invalid name`)}),!X)return;if(X.$data&&!(("code"in X)||("validate"in X)))throw Error('$data keyword must have "code" or "validate" function')}function o$(Q,X,Y){var $;let W=X===null||X===void 0?void 0:X.post;if(Y&&W)throw Error('keyword with "post" flag cannot have "type"');let{RULES:J}=this,G=W?J.post:J.rules.find(({type:B})=>B===Y);if(!G)G={type:Y,rules:[]},J.rules.push(G);if(J.keywords[Q]=!0,!X)return;let H={keyword:Q,definition:{...X,type:(0,YQ.getJSONTypes)(X.type),schemaType:(0,YQ.getJSONTypes)(X.schemaType)}};if(X.before)lA.call(this,G,H,X.before);else G.rules.push(H);J.all[Q]=H,($=X.implements)===null||$===void 0||$.forEach((B)=>this.addKeyword(B))}function lA(Q,X,Y){let $=Q.rules.findIndex((W)=>W.keyword===Y);if($>=0)Q.rules.splice($,0,X);else Q.rules.push(X),this.logger.warn(`rule ${Y} is not defined`)}function mA(Q){let{metaSchema:X}=Q;if(X===void 0)return;if(Q.$data&&this.opts.$data)X=cH(X);Q.validateSchema=this.compile(X,!0)}var cA={$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"};function cH(Q){return{anyOf:[Q,cA]}}});var iH=E((dH)=>{Object.defineProperty(dH,"__esModule",{value:!0});var iA={keyword:"id",code(){throw Error('NOT SUPPORTED: keyword "id", use "$id" for schema ID')}};dH.default=iA});var sH=E((tH)=>{Object.defineProperty(tH,"__esModule",{value:!0});tH.callRef=tH.getValidate=void 0;var oA=G9(),nH=o0(),g0=c(),e6=I1(),oH=s8(),WQ=a(),rA={keyword:"$ref",schemaType:"string",code(Q){let{gen:X,schema:Y,it:$}=Q,{baseId:W,schemaEnv:J,validateName:G,opts:H,self:B}=$,{root:z}=J;if((Y==="#"||Y==="#/")&&W===z.baseId)return q();let K=oH.resolveRef.call(B,z,W,Y);if(K===void 0)throw new oA.default($.opts.uriResolver,W,Y);if(K instanceof oH.SchemaEnv)return U(K);return V(K);function q(){if(J===z)return JQ(Q,G,J,J.$async);let L=X.scopeValue("root",{ref:z});return JQ(Q,g0._`${L}.validate`,z,z.$async)}function U(L){let F=rH(Q,L);JQ(Q,F,L,L.$async)}function V(L){let F=X.scopeValue("schema",H.code.source===!0?{ref:L,code:(0,g0.stringify)(L)}:{ref:L}),w=X.name("valid"),D=Q.subschema({schema:L,dataTypes:[],schemaPath:g0.nil,topSchemaRef:F,errSchemaPath:Y},w);Q.mergeEvaluated(D),Q.ok(w)}}};function rH(Q,X){let{gen:Y}=Q;return X.validate?Y.scopeValue("validate",{ref:X.validate}):g0._`${Y.scopeValue("wrapper",{ref:X})}.validate`}tH.getValidate=rH;function JQ(Q,X,Y,$){let{gen:W,it:J}=Q,{allErrors:G,schemaEnv:H,opts:B}=J,z=B.passContext?e6.default.this:g0.nil;if($)K();else q();function K(){if(!H.$async)throw Error("async schema referenced by sync schema");let L=W.let("valid");W.try(()=>{if(W.code(g0._`await ${(0,nH.callValidateCode)(Q,X,z)}`),V(X),!G)W.assign(L,!0)},(F)=>{if(W.if(g0._`!(${F} instanceof ${J.ValidationError})`,()=>W.throw(F)),U(F),!G)W.assign(L,!1)}),Q.ok(L)}function q(){Q.result((0,nH.callValidateCode)(Q,X,z),()=>V(X),()=>U(X))}function U(L){let F=g0._`${L}.errors`;W.assign(e6.default.vErrors,g0._`${e6.default.vErrors} === null ? ${F} : ${e6.default.vErrors}.concat(${F})`),W.assign(e6.default.errors,g0._`${e6.default.vErrors}.length`)}function V(L){var F;if(!J.opts.unevaluated)return;let w=(F=Y===null||Y===void 0?void 0:Y.validate)===null||F===void 0?void 0:F.evaluated;if(J.props!==!0)if(w&&!w.dynamicProps){if(w.props!==void 0)J.props=WQ.mergeEvaluated.props(W,w.props,J.props)}else{let D=W.var("props",g0._`${L}.evaluated.props`);J.props=WQ.mergeEvaluated.props(W,D,J.props,g0.Name)}if(J.items!==!0)if(w&&!w.dynamicItems){if(w.items!==void 0)J.items=WQ.mergeEvaluated.items(W,w.items,J.items)}else{let D=W.var("items",g0._`${L}.evaluated.items`);J.items=WQ.mergeEvaluated.items(W,D,J.items,g0.Name)}}}tH.callRef=JQ;tH.default=rA});var QB=E((eH)=>{Object.defineProperty(eH,"__esModule",{value:!0});var sA=iH(),eA=sH(),Qj=["$schema","$id","$defs","$vocabulary",{keyword:"$comment"},"definitions",sA.default,eA.default];eH.default=Qj});var YB=E((XB)=>{Object.defineProperty(XB,"__esModule",{value:!0});var GQ=c(),n1=GQ.operators,HQ={maximum:{okStr:"<=",ok:n1.LTE,fail:n1.GT},minimum:{okStr:">=",ok:n1.GTE,fail:n1.LT},exclusiveMaximum:{okStr:"<",ok:n1.LT,fail:n1.GTE},exclusiveMinimum:{okStr:">",ok:n1.GT,fail:n1.LTE}},Yj={message:({keyword:Q,schemaCode:X})=>GQ.str`must be ${HQ[Q].okStr} ${X}`,params:({keyword:Q,schemaCode:X})=>GQ._`{comparison: ${HQ[Q].okStr}, limit: ${X}}`},$j={keyword:Object.keys(HQ),type:"number",schemaType:"number",$data:!0,error:Yj,code(Q){let{keyword:X,data:Y,schemaCode:$}=Q;Q.fail$data(GQ._`${Y} ${HQ[X].fail} ${$} || isNaN(${Y})`)}};XB.default=$j});var WB=E(($B)=>{Object.defineProperty($B,"__esModule",{value:!0});var V9=c(),Jj={message:({schemaCode:Q})=>V9.str`must be multiple of ${Q}`,params:({schemaCode:Q})=>V9._`{multipleOf: ${Q}}`},Gj={keyword:"multipleOf",type:"number",schemaType:"number",$data:!0,error:Jj,code(Q){let{gen:X,data:Y,schemaCode:$,it:W}=Q,J=W.opts.multipleOfPrecision,G=X.let("res"),H=J?V9._`Math.abs(Math.round(${G}) - ${G}) > 1e-${J}`:V9._`${G} !== parseInt(${G})`;Q.fail$data(V9._`(${$} === 0 || (${G} = ${Y}/${$}, ${H}))`)}};$B.default=Gj});var HB=E((GB)=>{Object.defineProperty(GB,"__esModule",{value:!0});function JB(Q){let X=Q.length,Y=0,$=0,W;while($<X)if(Y++,W=Q.charCodeAt($++),W>=55296&&W<=56319&&$<X){if(W=Q.charCodeAt($),(W&64512)===56320)$++}return Y}GB.default=JB;JB.code='require("ajv/dist/runtime/ucs2length").default'});var zB=E((BB)=>{Object.defineProperty(BB,"__esModule",{value:!0});var F6=c(),zj=a(),Kj=HB(),Vj={message({keyword:Q,schemaCode:X}){let Y=Q==="maxLength"?"more":"fewer";return F6.str`must NOT have ${Y} than ${X} characters`},params:({schemaCode:Q})=>F6._`{limit: ${Q}}`},qj={keyword:["maxLength","minLength"],type:"string",schemaType:"number",$data:!0,error:Vj,code(Q){let{keyword:X,data:Y,schemaCode:$,it:W}=Q,J=X==="maxLength"?F6.operators.GT:F6.operators.LT,G=W.opts.unicode===!1?F6._`${Y}.length`:F6._`${(0,zj.useFunc)(Q.gen,Kj.default)}(${Y})`;Q.fail$data(F6._`${G} ${J} ${$}`)}};BB.default=qj});var VB=E((KB)=>{Object.defineProperty(KB,"__esModule",{value:!0});var Lj=o0(),BQ=c(),Fj={message:({schemaCode:Q})=>BQ.str`must match pattern "${Q}"`,params:({schemaCode:Q})=>BQ._`{pattern: ${Q}}`},Nj={keyword:"pattern",type:"string",schemaType:"string",$data:!0,error:Fj,code(Q){let{data:X,$data:Y,schema:$,schemaCode:W,it:J}=Q,G=J.opts.unicodeRegExp?"u":"",H=Y?BQ._`(new RegExp(${W}, ${G}))`:(0,Lj.usePattern)(Q,$);Q.fail$data(BQ._`!${H}.test(${X})`)}};KB.default=Nj});var UB=E((qB)=>{Object.defineProperty(qB,"__esModule",{value:!0});var q9=c(),Dj={message({keyword:Q,schemaCode:X}){let Y=Q==="maxProperties"?"more":"fewer";return q9.str`must NOT have ${Y} than ${X} properties`},params:({schemaCode:Q})=>q9._`{limit: ${Q}}`},wj={keyword:["maxProperties","minProperties"],type:"object",schemaType:"number",$data:!0,error:Dj,code(Q){let{keyword:X,data:Y,schemaCode:$}=Q,W=X==="maxProperties"?q9.operators.GT:q9.operators.LT;Q.fail$data(q9._`Object.keys(${Y}).length ${W} ${$}`)}};qB.default=wj});var FB=E((LB)=>{Object.defineProperty(LB,"__esModule",{value:!0});var U9=o0(),L9=c(),Aj=a(),jj={message:({params:{missingProperty:Q}})=>L9.str`must have required property '${Q}'`,params:({params:{missingProperty:Q}})=>L9._`{missingProperty: ${Q}}`},Rj={keyword:"required",type:"object",schemaType:"array",$data:!0,error:jj,code(Q){let{gen:X,schema:Y,schemaCode:$,data:W,$data:J,it:G}=Q,{opts:H}=G;if(!J&&Y.length===0)return;let B=Y.length>=H.loopRequired;if(G.allErrors)z();else K();if(H.strictRequired){let V=Q.parentSchema.properties,{definedProperties:L}=Q.it;for(let F of Y)if((V===null||V===void 0?void 0:V[F])===void 0&&!L.has(F)){let w=G.schemaEnv.baseId+G.errSchemaPath,D=`required property "${F}" is not defined at "${w}" (strictRequired)`;(0,Aj.checkStrictMode)(G,D,G.opts.strictRequired)}}function z(){if(B||J)Q.block$data(L9.nil,q);else for(let V of Y)(0,U9.checkReportMissingProp)(Q,V)}function K(){let V=X.let("missing");if(B||J){let L=X.let("valid",!0);Q.block$data(L,()=>U(V,L)),Q.ok(L)}else X.if((0,U9.checkMissingProp)(Q,Y,V)),(0,U9.reportMissingProp)(Q,V),X.else()}function q(){X.forOf("prop",$,(V)=>{Q.setParams({missingProperty:V}),X.if((0,U9.noPropertyInData)(X,W,V,H.ownProperties),()=>Q.error())})}function U(V,L){Q.setParams({missingProperty:V}),X.forOf(V,$,()=>{X.assign(L,(0,U9.propertyInData)(X,W,V,H.ownProperties)),X.if((0,L9.not)(L),()=>{Q.error(),X.break()})},L9.nil)}}};LB.default=Rj});var OB=E((NB)=>{Object.defineProperty(NB,"__esModule",{value:!0});var F9=c(),bj={message({keyword:Q,schemaCode:X}){let Y=Q==="maxItems"?"more":"fewer";return F9.str`must NOT have ${Y} than ${X} items`},params:({schemaCode:Q})=>F9._`{limit: ${Q}}`},Ej={keyword:["maxItems","minItems"],type:"array",schemaType:"number",$data:!0,error:bj,code(Q){let{keyword:X,data:Y,schemaCode:$}=Q,W=X==="maxItems"?F9.operators.GT:F9.operators.LT;Q.fail$data(F9._`${Y}.length ${W} ${$}`)}};NB.default=Ej});var zQ=E((wB)=>{Object.defineProperty(wB,"__esModule",{value:!0});var DB=x$();DB.code='require("ajv/dist/runtime/equal").default';wB.default=DB});var AB=E((MB)=>{Object.defineProperty(MB,"__esModule",{value:!0});var t$=X9(),I0=c(),Sj=a(),Cj=zQ(),_j={message:({params:{i:Q,j:X}})=>I0.str`must NOT have duplicate items (items ## ${X} and ${Q} are identical)`,params:({params:{i:Q,j:X}})=>I0._`{i: ${Q}, j: ${X}}`},kj={keyword:"uniqueItems",type:"array",schemaType:"boolean",$data:!0,error:_j,code(Q){let{gen:X,data:Y,$data:$,schema:W,parentSchema:J,schemaCode:G,it:H}=Q;if(!$&&!W)return;let B=X.let("valid"),z=J.items?(0,t$.getSchemaTypes)(J.items):[];Q.block$data(B,K,I0._`${G} === false`),Q.ok(B);function K(){let L=X.let("i",I0._`${Y}.length`),F=X.let("j");Q.setParams({i:L,j:F}),X.assign(B,!0),X.if(I0._`${L} > 1`,()=>(q()?U:V)(L,F))}function q(){return z.length>0&&!z.some((L)=>L==="object"||L==="array")}function U(L,F){let w=X.name("item"),D=(0,t$.checkDataTypes)(z,w,H.opts.strictNumbers,t$.DataType.Wrong),j=X.const("indices",I0._`{}`);X.for(I0._`;${L}--;`,()=>{if(X.let(w,I0._`${Y}[${L}]`),X.if(D,I0._`continue`),z.length>1)X.if(I0._`typeof ${w} == "string"`,I0._`${w} += "_"`);X.if(I0._`typeof ${j}[${w}] == "number"`,()=>{X.assign(F,I0._`${j}[${w}]`),Q.error(),X.assign(B,!1).break()}).code(I0._`${j}[${w}] = ${L}`)})}function V(L,F){let w=(0,Sj.useFunc)(X,Cj.default),D=X.name("outer");X.label(D).for(I0._`;${L}--;`,()=>X.for(I0._`${F} = ${L}; ${F}--;`,()=>X.if(I0._`${w}(${Y}[${L}], ${Y}[${F}])`,()=>{Q.error(),X.assign(B,!1).break(D)})))}}};MB.default=kj});var RB=E((jB)=>{Object.defineProperty(jB,"__esModule",{value:!0});var a$=c(),Tj=a(),xj=zQ(),yj={message:"must be equal to constant",params:({schemaCode:Q})=>a$._`{allowedValue: ${Q}}`},gj={keyword:"const",$data:!0,error:yj,code(Q){let{gen:X,data:Y,$data:$,schemaCode:W,schema:J}=Q;if($||J&&typeof J=="object")Q.fail$data(a$._`!${(0,Tj.useFunc)(X,xj.default)}(${Y}, ${W})`);else Q.fail(a$._`${J} !== ${Y}`)}};jB.default=gj});var bB=E((IB)=>{Object.defineProperty(IB,"__esModule",{value:!0});var N9=c(),fj=a(),uj=zQ(),lj={message:"must be equal to one of the allowed values",params:({schemaCode:Q})=>N9._`{allowedValues: ${Q}}`},mj={keyword:"enum",schemaType:"array",$data:!0,error:lj,code(Q){let{gen:X,data:Y,$data:$,schema:W,schemaCode:J,it:G}=Q;if(!$&&W.length===0)throw Error("enum must have non-empty array");let H=W.length>=G.opts.loopEnum,B,z=()=>B!==null&&B!==void 0?B:B=(0,fj.useFunc)(X,uj.default),K;if(H||$)K=X.let("valid"),Q.block$data(K,q);else{if(!Array.isArray(W))throw Error("ajv implementation error");let V=X.const("vSchema",J);K=(0,N9.or)(...W.map((L,F)=>U(V,F)))}Q.pass(K);function q(){X.assign(K,!1),X.forOf("v",J,(V)=>X.if(N9._`${z()}(${Y}, ${V})`,()=>X.assign(K,!0).break()))}function U(V,L){let F=W[L];return typeof F==="object"&&F!==null?N9._`${z()}(${Y}, ${V}[${L}])`:N9._`${Y} === ${F}`}}};IB.default=mj});var PB=E((EB)=>{Object.defineProperty(EB,"__esModule",{value:!0});var pj=YB(),dj=WB(),ij=zB(),nj=VB(),oj=UB(),rj=FB(),tj=OB(),aj=AB(),sj=RB(),ej=bB(),QR=[pj.default,dj.default,ij.default,nj.default,oj.default,rj.default,tj.default,aj.default,{keyword:"type",schemaType:["string","array"]},{keyword:"nullable",schemaType:"boolean"},sj.default,ej.default];EB.default=QR});var e$=E((SB)=>{Object.defineProperty(SB,"__esModule",{value:!0});SB.validateAdditionalItems=void 0;var N6=c(),s$=a(),YR={message:({params:{len:Q}})=>N6.str`must NOT have more than ${Q} items`,params:({params:{len:Q}})=>N6._`{limit: ${Q}}`},$R={keyword:"additionalItems",type:"array",schemaType:["boolean","object"],before:"uniqueItems",error:YR,code(Q){let{parentSchema:X,it:Y}=Q,{items:$}=X;if(!Array.isArray($)){(0,s$.checkStrictMode)(Y,'"additionalItems" is ignored when "items" is not an array of schemas');return}ZB(Q,$)}};function ZB(Q,X){let{gen:Y,schema:$,data:W,keyword:J,it:G}=Q;G.items=!0;let H=Y.const("len",N6._`${W}.length`);if($===!1)Q.setParams({len:X.length}),Q.pass(N6._`${H} <= ${X.length}`);else if(typeof $=="object"&&!(0,s$.alwaysValidSchema)(G,$)){let z=Y.var("valid",N6._`${H} <= ${X.length}`);Y.if((0,N6.not)(z),()=>B(z)),Q.ok(z)}function B(z){Y.forRange("i",X.length,H,(K)=>{if(Q.subschema({keyword:J,dataProp:K,dataPropType:s$.Type.Num},z),!G.allErrors)Y.if((0,N6.not)(z),()=>Y.break())})}}SB.validateAdditionalItems=ZB;SB.default=$R});var Q7=E((vB)=>{Object.defineProperty(vB,"__esModule",{value:!0});vB.validateTuple=void 0;var _B=c(),KQ=a(),JR=o0(),GR={keyword:"items",type:"array",schemaType:["object","array","boolean"],before:"uniqueItems",code(Q){let{schema:X,it:Y}=Q;if(Array.isArray(X))return kB(Q,"additionalItems",X);if(Y.items=!0,(0,KQ.alwaysValidSchema)(Y,X))return;Q.ok((0,JR.validateArray)(Q))}};function kB(Q,X,Y=Q.schema){let{gen:$,parentSchema:W,data:J,keyword:G,it:H}=Q;if(K(W),H.opts.unevaluated&&Y.length&&H.items!==!0)H.items=KQ.mergeEvaluated.items($,Y.length,H.items);let B=$.name("valid"),z=$.const("len",_B._`${J}.length`);Y.forEach((q,U)=>{if((0,KQ.alwaysValidSchema)(H,q))return;$.if(_B._`${z} > ${U}`,()=>Q.subschema({keyword:G,schemaProp:U,dataProp:U},B)),Q.ok(B)});function K(q){let{opts:U,errSchemaPath:V}=H,L=Y.length,F=L===q.minItems&&(L===q.maxItems||q[X]===!1);if(U.strictTuples&&!F){let w=`"${G}" is ${L}-tuple, but minItems or maxItems/${X} are not specified or different at path "${V}"`;(0,KQ.checkStrictMode)(H,w,U.strictTuples)}}}vB.validateTuple=kB;vB.default=GR});var yB=E((xB)=>{Object.defineProperty(xB,"__esModule",{value:!0});var BR=Q7(),zR={keyword:"prefixItems",type:"array",schemaType:["array"],before:"uniqueItems",code:(Q)=>(0,BR.validateTuple)(Q,"items")};xB.default=zR});var fB=E((hB)=>{Object.defineProperty(hB,"__esModule",{value:!0});var gB=c(),VR=a(),qR=o0(),UR=e$(),LR={message:({params:{len:Q}})=>gB.str`must NOT have more than ${Q} items`,params:({params:{len:Q}})=>gB._`{limit: ${Q}}`},FR={keyword:"items",type:"array",schemaType:["object","boolean"],before:"uniqueItems",error:LR,code(Q){let{schema:X,parentSchema:Y,it:$}=Q,{prefixItems:W}=Y;if($.items=!0,(0,VR.alwaysValidSchema)($,X))return;if(W)(0,UR.validateAdditionalItems)(Q,W);else Q.ok((0,qR.validateArray)(Q))}};hB.default=FR});var lB=E((uB)=>{Object.defineProperty(uB,"__esModule",{value:!0});var r0=c(),VQ=a(),OR={message:({params:{min:Q,max:X}})=>X===void 0?r0.str`must contain at least ${Q} valid item(s)`:r0.str`must contain at least ${Q} and no more than ${X} valid item(s)`,params:({params:{min:Q,max:X}})=>X===void 0?r0._`{minContains: ${Q}}`:r0._`{minContains: ${Q}, maxContains: ${X}}`},DR={keyword:"contains",type:"array",schemaType:["object","boolean"],before:"uniqueItems",trackErrors:!0,error:OR,code(Q){let{gen:X,schema:Y,parentSchema:$,data:W,it:J}=Q,G,H,{minContains:B,maxContains:z}=$;if(J.opts.next)G=B===void 0?1:B,H=z;else G=1;let K=X.const("len",r0._`${W}.length`);if(Q.setParams({min:G,max:H}),H===void 0&&G===0){(0,VQ.checkStrictMode)(J,'"minContains" == 0 without "maxContains": "contains" keyword ignored');return}if(H!==void 0&&G>H){(0,VQ.checkStrictMode)(J,'"minContains" > "maxContains" is always invalid'),Q.fail();return}if((0,VQ.alwaysValidSchema)(J,Y)){let F=r0._`${K} >= ${G}`;if(H!==void 0)F=r0._`${F} && ${K} <= ${H}`;Q.pass(F);return}J.items=!0;let q=X.name("valid");if(H===void 0&&G===1)V(q,()=>X.if(q,()=>X.break()));else if(G===0){if(X.let(q,!0),H!==void 0)X.if(r0._`${W}.length > 0`,U)}else X.let(q,!1),U();Q.result(q,()=>Q.reset());function U(){let F=X.name("_valid"),w=X.let("count",0);V(F,()=>X.if(F,()=>L(w)))}function V(F,w){X.forRange("i",0,K,(D)=>{Q.subschema({keyword:"contains",dataProp:D,dataPropType:VQ.Type.Num,compositeRule:!0},F),w()})}function L(F){if(X.code(r0._`${F}++`),H===void 0)X.if(r0._`${F} >= ${G}`,()=>X.assign(q,!0).break());else if(X.if(r0._`${F} > ${H}`,()=>X.assign(q,!1).break()),G===1)X.assign(q,!0);else X.if(r0._`${F} >= ${G}`,()=>X.assign(q,!0))}}};uB.default=DR});var nB=E((pB)=>{Object.defineProperty(pB,"__esModule",{value:!0});pB.validateSchemaDeps=pB.validatePropertyDeps=pB.error=void 0;var X7=c(),MR=a(),O9=o0();pB.error={message:({params:{property:Q,depsCount:X,deps:Y}})=>{let $=X===1?"property":"properties";return X7.str`must have ${$} ${Y} when property ${Q} is present`},params:({params:{property:Q,depsCount:X,deps:Y,missingProperty:$}})=>X7._`{property: ${Q},
     missingProperty: ${$},
     depsCount: ${X},
-    deps: ${Y}}`};var AR={keyword:"dependencies",type:"object",schemaType:"object",error:pB.error,code(Q){let[X,Y]=jR(Q);mB(Q,X),cB(Q,Y)}};function jR({schema:Q}){let X={},Y={};for(let $ in Q){if($==="__proto__")continue;let W=Array.isArray(Q[$])?X:Y;W[$]=Q[$]}return[X,Y]}function mB(Q,X=Q.schema){let{gen:Y,data:$,it:W}=Q;if(Object.keys(X).length===0)return;let J=Y.let("missing");for(let G in X){let H=X[G];if(H.length===0)continue;let B=(0,O9.propertyInData)(Y,$,G,W.opts.ownProperties);if(Q.setParams({property:G,depsCount:H.length,deps:H.join(", ")}),W.allErrors)Y.if(B,()=>{for(let z of H)(0,O9.checkReportMissingProp)(Q,z)});else Y.if(X7._`${B} && (${(0,O9.checkMissingProp)(Q,H,J)})`),(0,O9.reportMissingProp)(Q,J),Y.else()}}pB.validatePropertyDeps=mB;function cB(Q,X=Q.schema){let{gen:Y,data:$,keyword:W,it:J}=Q,G=Y.name("valid");for(let H in X){if((0,MR.alwaysValidSchema)(J,X[H]))continue;Y.if((0,O9.propertyInData)(Y,$,H,J.opts.ownProperties),()=>{let B=Q.subschema({keyword:W,schemaProp:H},G);Q.mergeValidEvaluated(B,G)},()=>Y.var(G,!0)),Q.ok(G)}}pB.validateSchemaDeps=cB;pB.default=AR});var tB=E((rB)=>{Object.defineProperty(rB,"__esModule",{value:!0});var oB=c(),bR=a(),ER={message:"property name must be valid",params:({params:Q})=>oB._`{propertyName: ${Q.propertyName}}`},PR={keyword:"propertyNames",type:"object",schemaType:["object","boolean"],error:ER,code(Q){let{gen:X,schema:Y,data:$,it:W}=Q;if((0,bR.alwaysValidSchema)(W,Y))return;let J=X.name("valid");X.forIn("key",$,(G)=>{Q.setParams({propertyName:G}),Q.subschema({keyword:"propertyNames",data:G,dataTypes:["string"],propertyName:G,compositeRule:!0},J),X.if((0,oB.not)(J),()=>{if(Q.error(!0),!W.allErrors)X.break()})}),Q.ok(J)}};rB.default=PR});var Y7=E((aB)=>{Object.defineProperty(aB,"__esModule",{value:!0});var qQ=o0(),W1=c(),SR=I1(),UQ=a(),CR={message:"must NOT have additional properties",params:({params:Q})=>W1._`{additionalProperty: ${Q.additionalProperty}}`},_R={keyword:"additionalProperties",type:["object"],schemaType:["boolean","object"],allowUndefined:!0,trackErrors:!0,error:CR,code(Q){let{gen:X,schema:Y,parentSchema:$,data:W,errsCount:J,it:G}=Q;if(!J)throw Error("ajv implementation error");let{allErrors:H,opts:B}=G;if(G.props=!0,B.removeAdditional!=="all"&&(0,UQ.alwaysValidSchema)(G,Y))return;let z=(0,qQ.allSchemaProperties)($.properties),K=(0,qQ.allSchemaProperties)($.patternProperties);q(),Q.ok(W1._`${J} === ${SR.default.errors}`);function q(){X.forIn("key",W,(w)=>{if(!z.length&&!K.length)L(w);else X.if(U(w),()=>L(w))})}function U(w){let D;if(z.length>8){let j=(0,UQ.schemaRefOrVal)(G,$.properties,"properties");D=(0,qQ.isOwnProperty)(X,j,w)}else if(z.length)D=(0,W1.or)(...z.map((j)=>W1._`${w} === ${j}`));else D=W1.nil;if(K.length)D=(0,W1.or)(D,...K.map((j)=>W1._`${(0,qQ.usePattern)(Q,j)}.test(${w})`));return(0,W1.not)(D)}function V(w){X.code(W1._`delete ${W}[${w}]`)}function L(w){if(B.removeAdditional==="all"||B.removeAdditional&&Y===!1){V(w);return}if(Y===!1){if(Q.setParams({additionalProperty:w}),Q.error(),!H)X.break();return}if(typeof Y=="object"&&!(0,UQ.alwaysValidSchema)(G,Y)){let D=X.name("valid");if(B.removeAdditional==="failing")F(w,D,!1),X.if((0,W1.not)(D),()=>{Q.reset(),V(w)});else if(F(w,D),!H)X.if((0,W1.not)(D),()=>X.break())}}function F(w,D,j){let I={keyword:"additionalProperties",dataProp:w,dataPropType:UQ.Type.Str};if(j===!1)Object.assign(I,{compositeRule:!0,createErrors:!1,allErrors:!1});Q.subschema(I,D)}}};aB.default=_R});var Xz=E((Qz)=>{Object.defineProperty(Qz,"__esModule",{value:!0});var vR=J9(),sB=o0(),$7=a(),eB=Y7(),TR={keyword:"properties",type:"object",schemaType:"object",code(Q){let{gen:X,schema:Y,parentSchema:$,data:W,it:J}=Q;if(J.opts.removeAdditional==="all"&&$.additionalProperties===void 0)eB.default.code(new vR.KeywordCxt(J,eB.default,"additionalProperties"));let G=(0,sB.allSchemaProperties)(Y);for(let q of G)J.definedProperties.add(q);if(J.opts.unevaluated&&G.length&&J.props!==!0)J.props=$7.mergeEvaluated.props(X,(0,$7.toHash)(G),J.props);let H=G.filter((q)=>!(0,$7.alwaysValidSchema)(J,Y[q]));if(H.length===0)return;let B=X.name("valid");for(let q of H){if(z(q))K(q);else{if(X.if((0,sB.propertyInData)(X,W,q,J.opts.ownProperties)),K(q),!J.allErrors)X.else().var(B,!0);X.endIf()}Q.it.definedProperties.add(q),Q.ok(B)}function z(q){return J.opts.useDefaults&&!J.compositeRule&&Y[q].default!==void 0}function K(q){Q.subschema({keyword:"properties",schemaProp:q,dataProp:q},B)}}};Qz.default=TR});var Gz=E((Jz)=>{Object.defineProperty(Jz,"__esModule",{value:!0});var Yz=o0(),LQ=c(),$z=a(),Wz=a(),yR={keyword:"patternProperties",type:"object",schemaType:"object",code(Q){let{gen:X,schema:Y,data:$,parentSchema:W,it:J}=Q,{opts:G}=J,H=(0,Yz.allSchemaProperties)(Y),B=H.filter((F)=>(0,$z.alwaysValidSchema)(J,Y[F]));if(H.length===0||B.length===H.length&&(!J.opts.unevaluated||J.props===!0))return;let z=G.strictSchema&&!G.allowMatchingProperties&&W.properties,K=X.name("valid");if(J.props!==!0&&!(J.props instanceof LQ.Name))J.props=(0,Wz.evaluatedPropsToName)(X,J.props);let{props:q}=J;U();function U(){for(let F of H){if(z)V(F);if(J.allErrors)L(F);else X.var(K,!0),L(F),X.if(K)}}function V(F){for(let w in z)if(new RegExp(F).test(w))(0,$z.checkStrictMode)(J,`property ${w} matches pattern ${F} (use allowMatchingProperties)`)}function L(F){X.forIn("key",$,(w)=>{X.if(LQ._`${(0,Yz.usePattern)(Q,F)}.test(${w})`,()=>{let D=B.includes(F);if(!D)Q.subschema({keyword:"patternProperties",schemaProp:F,dataProp:w,dataPropType:Wz.Type.Str},K);if(J.opts.unevaluated&&q!==!0)X.assign(LQ._`${q}[${w}]`,!0);else if(!D&&!J.allErrors)X.if((0,LQ.not)(K),()=>X.break())})})}}};Jz.default=yR});var Bz=E((Hz)=>{Object.defineProperty(Hz,"__esModule",{value:!0});var hR=a(),fR={keyword:"not",schemaType:["object","boolean"],trackErrors:!0,code(Q){let{gen:X,schema:Y,it:$}=Q;if((0,hR.alwaysValidSchema)($,Y)){Q.fail();return}let W=X.name("valid");Q.subschema({keyword:"not",compositeRule:!0,createErrors:!1,allErrors:!1},W),Q.failResult(W,()=>Q.reset(),()=>Q.error())},error:{message:"must NOT be valid"}};Hz.default=fR});var Kz=E((zz)=>{Object.defineProperty(zz,"__esModule",{value:!0});var lR=o0(),mR={keyword:"anyOf",schemaType:"array",trackErrors:!0,code:lR.validateUnion,error:{message:"must match a schema in anyOf"}};zz.default=mR});var qz=E((Vz)=>{Object.defineProperty(Vz,"__esModule",{value:!0});var FQ=c(),pR=a(),dR={message:"must match exactly one schema in oneOf",params:({params:Q})=>FQ._`{passingSchemas: ${Q.passing}}`},iR={keyword:"oneOf",schemaType:"array",trackErrors:!0,error:dR,code(Q){let{gen:X,schema:Y,parentSchema:$,it:W}=Q;if(!Array.isArray(Y))throw Error("ajv implementation error");if(W.opts.discriminator&&$.discriminator)return;let J=Y,G=X.let("valid",!1),H=X.let("passing",null),B=X.name("_valid");Q.setParams({passing:H}),X.block(z),Q.result(G,()=>Q.reset(),()=>Q.error(!0));function z(){J.forEach((K,q)=>{let U;if((0,pR.alwaysValidSchema)(W,K))X.var(B,!0);else U=Q.subschema({keyword:"oneOf",schemaProp:q,compositeRule:!0},B);if(q>0)X.if(FQ._`${B} && ${G}`).assign(G,!1).assign(H,FQ._`[${H}, ${q}]`).else();X.if(B,()=>{if(X.assign(G,!0),X.assign(H,q),U)Q.mergeEvaluated(U,FQ.Name)})})}}};Vz.default=iR});var Lz=E((Uz)=>{Object.defineProperty(Uz,"__esModule",{value:!0});var oR=a(),rR={keyword:"allOf",schemaType:"array",code(Q){let{gen:X,schema:Y,it:$}=Q;if(!Array.isArray(Y))throw Error("ajv implementation error");let W=X.name("valid");Y.forEach((J,G)=>{if((0,oR.alwaysValidSchema)($,J))return;let H=Q.subschema({keyword:"allOf",schemaProp:G},W);Q.ok(W),Q.mergeEvaluated(H)})}};Uz.default=rR});var Dz=E((Oz)=>{Object.defineProperty(Oz,"__esModule",{value:!0});var NQ=c(),Nz=a(),aR={message:({params:Q})=>NQ.str`must match "${Q.ifClause}" schema`,params:({params:Q})=>NQ._`{failingKeyword: ${Q.ifClause}}`},sR={keyword:"if",schemaType:["object","boolean"],trackErrors:!0,error:aR,code(Q){let{gen:X,parentSchema:Y,it:$}=Q;if(Y.then===void 0&&Y.else===void 0)(0,Nz.checkStrictMode)($,'"if" without "then" and "else" is ignored');let W=Fz($,"then"),J=Fz($,"else");if(!W&&!J)return;let G=X.let("valid",!0),H=X.name("_valid");if(B(),Q.reset(),W&&J){let K=X.let("ifClause");Q.setParams({ifClause:K}),X.if(H,z("then",K),z("else",K))}else if(W)X.if(H,z("then"));else X.if((0,NQ.not)(H),z("else"));Q.pass(G,()=>Q.error(!0));function B(){let K=Q.subschema({keyword:"if",compositeRule:!0,createErrors:!1,allErrors:!1},H);Q.mergeEvaluated(K)}function z(K,q){return()=>{let U=Q.subschema({keyword:K},H);if(X.assign(G,H),Q.mergeValidEvaluated(U,G),q)X.assign(q,NQ._`${K}`);else Q.setParams({ifClause:K})}}}};function Fz(Q,X){let Y=Q.schema[X];return Y!==void 0&&!(0,Nz.alwaysValidSchema)(Q,Y)}Oz.default=sR});var Mz=E((wz)=>{Object.defineProperty(wz,"__esModule",{value:!0});var QI=a(),XI={keyword:["then","else"],schemaType:["object","boolean"],code({keyword:Q,parentSchema:X,it:Y}){if(X.if===void 0)(0,QI.checkStrictMode)(Y,`"${Q}" without "if" is ignored`)}};wz.default=XI});var jz=E((Az)=>{Object.defineProperty(Az,"__esModule",{value:!0});var $I=e$(),WI=yB(),JI=Q7(),GI=fB(),HI=lB(),BI=nB(),zI=tB(),KI=Y7(),VI=Xz(),qI=Gz(),UI=Bz(),LI=Kz(),FI=qz(),NI=Lz(),OI=Dz(),DI=Mz();function wI(Q=!1){let X=[UI.default,LI.default,FI.default,NI.default,OI.default,DI.default,zI.default,KI.default,BI.default,VI.default,qI.default];if(Q)X.push(WI.default,GI.default);else X.push($I.default,JI.default);return X.push(HI.default),X}Az.default=wI});var Iz=E((Rz)=>{Object.defineProperty(Rz,"__esModule",{value:!0});var F0=c(),AI={message:({schemaCode:Q})=>F0.str`must match format "${Q}"`,params:({schemaCode:Q})=>F0._`{format: ${Q}}`},jI={keyword:"format",type:["number","string"],schemaType:"string",$data:!0,error:AI,code(Q,X){let{gen:Y,data:$,$data:W,schema:J,schemaCode:G,it:H}=Q,{opts:B,errSchemaPath:z,schemaEnv:K,self:q}=H;if(!B.validateFormats)return;if(W)U();else V();function U(){let L=Y.scopeValue("formats",{ref:q.formats,code:B.code.formats}),F=Y.const("fDef",F0._`${L}[${G}]`),w=Y.let("fType"),D=Y.let("format");Y.if(F0._`typeof ${F} == "object" && !(${F} instanceof RegExp)`,()=>Y.assign(w,F0._`${F}.type || "string"`).assign(D,F0._`${F}.validate`),()=>Y.assign(w,F0._`"string"`).assign(D,F)),Q.fail$data((0,F0.or)(j(),I()));function j(){if(B.strictSchema===!1)return F0.nil;return F0._`${G} && !${D}`}function I(){let T=K.$async?F0._`(${F}.async ? await ${D}(${$}) : ${D}(${$}))`:F0._`${D}(${$})`,v=F0._`(typeof ${D} == "function" ? ${T} : ${D}.test(${$}))`;return F0._`${D} && ${D} !== true && ${w} === ${X} && !${v}`}}function V(){let L=q.formats[J];if(!L){j();return}if(L===!0)return;let[F,w,D]=I(L);if(F===X)Q.pass(T());function j(){if(B.strictSchema===!1){q.logger.warn(v());return}throw Error(v());function v(){return`unknown format "${J}" ignored in schema at path "${z}"`}}function I(v){let N0=v instanceof RegExp?(0,F0.regexpCode)(v):B.code.formats?F0._`${B.code.formats}${(0,F0.getProperty)(J)}`:void 0,O0=Y.scopeValue("formats",{key:J,ref:v,code:N0});if(typeof v=="object"&&!(v instanceof RegExp))return[v.type||"string",v.validate,F0._`${O0}.validate`];return["string",v,O0]}function T(){if(typeof L=="object"&&!(L instanceof RegExp)&&L.async){if(!K.$async)throw Error("async format in sync schema");return F0._`await ${D}(${$})`}return typeof w=="function"?F0._`${D}(${$})`:F0._`${D}.test(${$})`}}}};Rz.default=jI});var Ez=E((bz)=>{Object.defineProperty(bz,"__esModule",{value:!0});var II=Iz(),bI=[II.default];bz.default=bI});var Sz=E((Pz)=>{Object.defineProperty(Pz,"__esModule",{value:!0});Pz.contentVocabulary=Pz.metadataVocabulary=void 0;Pz.metadataVocabulary=["title","description","default","deprecated","readOnly","writeOnly","examples"];Pz.contentVocabulary=["contentMediaType","contentEncoding","contentSchema"]});var kz=E((_z)=>{Object.defineProperty(_z,"__esModule",{value:!0});var ZI=QB(),SI=PB(),CI=jz(),_I=Ez(),Cz=Sz(),kI=[ZI.default,SI.default,(0,CI.default)(),_I.default,Cz.metadataVocabulary,Cz.contentVocabulary];_z.default=kI});var yz=E((Tz)=>{Object.defineProperty(Tz,"__esModule",{value:!0});Tz.DiscrError=void 0;var vz;(function(Q){Q.Tag="tag",Q.Mapping="mapping"})(vz||(Tz.DiscrError=vz={}))});var fz=E((hz)=>{Object.defineProperty(hz,"__esModule",{value:!0});var Q4=c(),W7=yz(),gz=s8(),TI=G9(),xI=a(),yI={message:({params:{discrError:Q,tagName:X}})=>Q===W7.DiscrError.Tag?`tag "${X}" must be string`:`value of tag "${X}" must be in oneOf`,params:({params:{discrError:Q,tag:X,tagName:Y}})=>Q4._`{error: ${Q}, tag: ${Y}, tagValue: ${X}}`},gI={keyword:"discriminator",type:"object",schemaType:"object",error:yI,code(Q){let{gen:X,data:Y,schema:$,parentSchema:W,it:J}=Q,{oneOf:G}=W;if(!J.opts.discriminator)throw Error("discriminator: requires discriminator option");let H=$.propertyName;if(typeof H!="string")throw Error("discriminator: requires propertyName");if($.mapping)throw Error("discriminator: mapping is not supported");if(!G)throw Error("discriminator: requires oneOf keyword");let B=X.let("valid",!1),z=X.const("tag",Q4._`${Y}${(0,Q4.getProperty)(H)}`);X.if(Q4._`typeof ${z} == "string"`,()=>K(),()=>Q.error(!1,{discrError:W7.DiscrError.Tag,tag:z,tagName:H})),Q.ok(B);function K(){let V=U();X.if(!1);for(let L in V)X.elseIf(Q4._`${z} === ${L}`),X.assign(B,q(V[L]));X.else(),Q.error(!1,{discrError:W7.DiscrError.Mapping,tag:z,tagName:H}),X.endIf()}function q(V){let L=X.name("valid"),F=Q.subschema({keyword:"oneOf",schemaProp:V},L);return Q.mergeEvaluated(F,Q4.Name),L}function U(){var V;let L={},F=D(W),w=!0;for(let T=0;T<G.length;T++){let v=G[T];if((v===null||v===void 0?void 0:v.$ref)&&!(0,xI.schemaHasRulesButRef)(v,J.self.RULES)){let O0=v.$ref;if(v=gz.resolveRef.call(J.self,J.schemaEnv.root,J.baseId,O0),v instanceof gz.SchemaEnv)v=v.schema;if(v===void 0)throw new TI.default(J.opts.uriResolver,J.baseId,O0)}let N0=(V=v===null||v===void 0?void 0:v.properties)===null||V===void 0?void 0:V[H];if(typeof N0!="object")throw Error(`discriminator: oneOf subschemas (or referenced schemas) must have "properties/${H}"`);w=w&&(F||D(v)),j(N0,T)}if(!w)throw Error(`discriminator: "${H}" must be required`);return L;function D({required:T}){return Array.isArray(T)&&T.includes(H)}function j(T,v){if(T.const)I(T.const,v);else if(T.enum)for(let N0 of T.enum)I(N0,v);else throw Error(`discriminator: "properties/${H}" must have "const" or "enum"`)}function I(T,v){if(typeof T!="string"||T in L)throw Error(`discriminator: "${H}" values must be unique strings`);L[T]=v}}}};hz.default=gI});var uz=E((zx,fI)=>{fI.exports={$schema:"http://json-schema.org/draft-07/schema#",$id:"http://json-schema.org/draft-07/schema#",title:"Core schema meta-schema",definitions:{schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},type:["object","boolean"],properties:{$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},default:!0}});var G7=E((h0,J7)=>{Object.defineProperty(h0,"__esModule",{value:!0});h0.MissingRefError=h0.ValidationError=h0.CodeGen=h0.Name=h0.nil=h0.stringify=h0.str=h0._=h0.KeywordCxt=h0.Ajv=void 0;var uI=pH(),lI=kz(),mI=fz(),lz=uz(),cI=["/properties"],OQ="http://json-schema.org/draft-07/schema";class D9 extends uI.default{_addVocabularies(){if(super._addVocabularies(),lI.default.forEach((Q)=>this.addVocabulary(Q)),this.opts.discriminator)this.addKeyword(mI.default)}_addDefaultMetaSchema(){if(super._addDefaultMetaSchema(),!this.opts.meta)return;let Q=this.opts.$data?this.$dataMetaSchema(lz,cI):lz;this.addMetaSchema(Q,OQ,!1),this.refs["http://json-schema.org/schema"]=OQ}defaultMeta(){return this.opts.defaultMeta=super.defaultMeta()||(this.getSchema(OQ)?OQ:void 0)}}h0.Ajv=D9;J7.exports=h0=D9;J7.exports.Ajv=D9;Object.defineProperty(h0,"__esModule",{value:!0});h0.default=D9;var pI=J9();Object.defineProperty(h0,"KeywordCxt",{enumerable:!0,get:function(){return pI.KeywordCxt}});var X4=c();Object.defineProperty(h0,"_",{enumerable:!0,get:function(){return X4._}});Object.defineProperty(h0,"str",{enumerable:!0,get:function(){return X4.str}});Object.defineProperty(h0,"stringify",{enumerable:!0,get:function(){return X4.stringify}});Object.defineProperty(h0,"nil",{enumerable:!0,get:function(){return X4.nil}});Object.defineProperty(h0,"Name",{enumerable:!0,get:function(){return X4.Name}});Object.defineProperty(h0,"CodeGen",{enumerable:!0,get:function(){return X4.CodeGen}});var dI=t8();Object.defineProperty(h0,"ValidationError",{enumerable:!0,get:function(){return dI.default}});var iI=G9();Object.defineProperty(h0,"MissingRefError",{enumerable:!0,get:function(){return iI.default}})});var az=E((rz)=>{Object.defineProperty(rz,"__esModule",{value:!0});rz.formatNames=rz.fastFormats=rz.fullFormats=void 0;function q1(Q,X){return{validate:Q,compare:X}}rz.fullFormats={date:q1(dz,K7),time:q1(B7(!0),V7),"date-time":q1(mz(!0),nz),"iso-time":q1(B7(),iz),"iso-date-time":q1(mz(),oz),duration:/^P(?!$)((\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+S)?)?|(\d+W)?)$/,uri:Qb,"uri-reference":/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,"uri-template":/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,url:/^(?:https?|ftp):\/\/(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)(?:\.(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)*(?:\.(?:[a-z\u{00a1}-\u{ffff}]{2,})))(?::\d{2,5})?(?:\/[^\s]*)?$/iu,email:/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,hostname:/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)\.){3}(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)$/,ipv6:/^((([0-9a-f]{1,4}:){7}([0-9a-f]{1,4}|:))|(([0-9a-f]{1,4}:){6}(:[0-9a-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){5}(((:[0-9a-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){4}(((:[0-9a-f]{1,4}){1,3})|((:[0-9a-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){3}(((:[0-9a-f]{1,4}){1,4})|((:[0-9a-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){2}(((:[0-9a-f]{1,4}){1,5})|((:[0-9a-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){1}(((:[0-9a-f]{1,4}){1,6})|((:[0-9a-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9a-f]{1,4}){1,7})|((:[0-9a-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))$/i,regex:Hb,uuid:/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,"json-pointer":/^(?:\/(?:[^~/]|~0|~1)*)*$/,"json-pointer-uri-fragment":/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,"relative-json-pointer":/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/,byte:Xb,int32:{type:"number",validate:Wb},int64:{type:"number",validate:Jb},float:{type:"number",validate:pz},double:{type:"number",validate:pz},password:!0,binary:!0};rz.fastFormats={...rz.fullFormats,date:q1(/^\d\d\d\d-[0-1]\d-[0-3]\d$/,K7),time:q1(/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,V7),"date-time":q1(/^\d\d\d\d-[0-1]\d-[0-3]\dt(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,nz),"iso-time":q1(/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,iz),"iso-date-time":q1(/^\d\d\d\d-[0-1]\d-[0-3]\d[t\s](?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,oz),uri:/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/)?[^\s]*$/i,"uri-reference":/^(?:(?:[a-z][a-z0-9+\-.]*:)?\/?\/)?(?:[^\\\s#][^\s#]*)?(?:#[^\\\s]*)?$/i,email:/^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)*$/i};rz.formatNames=Object.keys(rz.fullFormats);function rI(Q){return Q%4===0&&(Q%100!==0||Q%400===0)}var tI=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,aI=[0,31,28,31,30,31,30,31,31,30,31,30,31];function dz(Q){let X=tI.exec(Q);if(!X)return!1;let Y=+X[1],$=+X[2],W=+X[3];return $>=1&&$<=12&&W>=1&&W<=($===2&&rI(Y)?29:aI[$])}function K7(Q,X){if(!(Q&&X))return;if(Q>X)return 1;if(Q<X)return-1;return 0}var H7=/^(\d\d):(\d\d):(\d\d(?:\.\d+)?)(z|([+-])(\d\d)(?::?(\d\d))?)?$/i;function B7(Q){return function(Y){let $=H7.exec(Y);if(!$)return!1;let W=+$[1],J=+$[2],G=+$[3],H=$[4],B=$[5]==="-"?-1:1,z=+($[6]||0),K=+($[7]||0);if(z>23||K>59||Q&&!H)return!1;if(W<=23&&J<=59&&G<60)return!0;let q=J-K*B,U=W-z*B-(q<0?1:0);return(U===23||U===-1)&&(q===59||q===-1)&&G<61}}function V7(Q,X){if(!(Q&&X))return;let Y=new Date("2020-01-01T"+Q).valueOf(),$=new Date("2020-01-01T"+X).valueOf();if(!(Y&&$))return;return Y-$}function iz(Q,X){if(!(Q&&X))return;let Y=H7.exec(Q),$=H7.exec(X);if(!(Y&&$))return;if(Q=Y[1]+Y[2]+Y[3],X=$[1]+$[2]+$[3],Q>X)return 1;if(Q<X)return-1;return 0}var z7=/t|\s/i;function mz(Q){let X=B7(Q);return function($){let W=$.split(z7);return W.length===2&&dz(W[0])&&X(W[1])}}function nz(Q,X){if(!(Q&&X))return;let Y=new Date(Q).valueOf(),$=new Date(X).valueOf();if(!(Y&&$))return;return Y-$}function oz(Q,X){if(!(Q&&X))return;let[Y,$]=Q.split(z7),[W,J]=X.split(z7),G=K7(Y,W);if(G===void 0)return;return G||V7($,J)}var sI=/\/|:/,eI=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i;function Qb(Q){return sI.test(Q)&&eI.test(Q)}var cz=/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/gm;function Xb(Q){return cz.lastIndex=0,cz.test(Q)}var Yb=-2147483648,$b=2147483647;function Wb(Q){return Number.isInteger(Q)&&Q<=$b&&Q>=Yb}function Jb(Q){return Number.isInteger(Q)}function pz(){return!0}var Gb=/[^\\]\\Z/;function Hb(Q){if(Gb.test(Q))return!1;try{return new RegExp(Q),!0}catch(X){return!1}}});var ez=E((sz)=>{Object.defineProperty(sz,"__esModule",{value:!0});sz.formatLimitDefinition=void 0;var zb=G7(),J1=c(),o1=J1.operators,DQ={formatMaximum:{okStr:"<=",ok:o1.LTE,fail:o1.GT},formatMinimum:{okStr:">=",ok:o1.GTE,fail:o1.LT},formatExclusiveMaximum:{okStr:"<",ok:o1.LT,fail:o1.GTE},formatExclusiveMinimum:{okStr:">",ok:o1.GT,fail:o1.LTE}},Kb={message:({keyword:Q,schemaCode:X})=>J1.str`should be ${DQ[Q].okStr} ${X}`,params:({keyword:Q,schemaCode:X})=>J1._`{comparison: ${DQ[Q].okStr}, limit: ${X}}`};sz.formatLimitDefinition={keyword:Object.keys(DQ),type:"string",schemaType:"string",$data:!0,error:Kb,code(Q){let{gen:X,data:Y,schemaCode:$,keyword:W,it:J}=Q,{opts:G,self:H}=J;if(!G.validateFormats)return;let B=new zb.KeywordCxt(J,H.RULES.all.format.definition,"format");if(B.$data)z();else K();function z(){let U=X.scopeValue("formats",{ref:H.formats,code:G.code.formats}),V=X.const("fmt",J1._`${U}[${B.schemaCode}]`);Q.fail$data((0,J1.or)(J1._`typeof ${V} != "object"`,J1._`${V} instanceof RegExp`,J1._`typeof ${V}.compare != "function"`,q(V)))}function K(){let U=B.schema,V=H.formats[U];if(!V||V===!0)return;if(typeof V!="object"||V instanceof RegExp||typeof V.compare!="function")throw Error(`"${W}": format "${U}" does not define "compare" function`);let L=X.scopeValue("formats",{key:U,ref:V,code:G.code.formats?J1._`${G.code.formats}${(0,J1.getProperty)(U)}`:void 0});Q.fail$data(q(L))}function q(U){return J1._`${U}.compare(${Y}, ${$}) ${DQ[W].fail} 0`}},dependencies:["format"]};var Vb=(Q)=>{return Q.addKeyword(sz.formatLimitDefinition),Q};sz.default=Vb});var $K=E((w9,YK)=>{Object.defineProperty(w9,"__esModule",{value:!0});var Y4=az(),Ub=ez(),L7=c(),QK=new L7.Name("fullFormats"),Lb=new L7.Name("fastFormats"),F7=(Q,X={keywords:!0})=>{if(Array.isArray(X))return XK(Q,X,Y4.fullFormats,QK),Q;let[Y,$]=X.mode==="fast"?[Y4.fastFormats,Lb]:[Y4.fullFormats,QK],W=X.formats||Y4.formatNames;if(XK(Q,W,Y,$),X.keywords)(0,Ub.default)(Q);return Q};F7.get=(Q,X="full")=>{let $=(X==="fast"?Y4.fastFormats:Y4.fullFormats)[Q];if(!$)throw Error(`Unknown format "${Q}"`);return $};function XK(Q,X,Y,$){var W,J;(W=(J=Q.opts.code).formats)!==null&&W!==void 0||(J.formats=L7._`require("ajv-formats/dist/formats").${$}`);for(let G of X)Q.addFormat(G,Y[G])}YK.exports=w9=F7;Object.defineProperty(w9,"__esModule",{value:!0});w9.default=F7});import{join as LK}from"path";import{fileURLToPath as Ib}from"url";import{setMaxListeners as gK}from"events";var hK=50;function A6(Q=hK){let X=new AbortController;return gK(Q,X.signal),X}import{spawn as Sq}from"child_process";import{createInterface as Cq}from"readline";import*as h from"fs";import{stat as qq,readdir as Uq,readFile as M5,unlink as Lq,rmdir as Fq,rm as Nq,mkdir as Oq,rename as Dq,open as wq}from"fs/promises";var fK=typeof global=="object"&&global&&global.Object===Object&&global,C7=fK;var uK=typeof self=="object"&&self&&self.Object===Object&&self,lK=C7||uK||Function("return this")(),j6=lK;var mK=j6.Symbol,R6=mK;var _7=Object.prototype,cK=_7.hasOwnProperty,pK=_7.toString,J4=R6?R6.toStringTag:void 0;function dK(Q){var X=cK.call(Q,J4),Y=Q[J4];try{Q[J4]=void 0;var $=!0}catch(J){}var W=pK.call(Q);if($)if(X)Q[J4]=Y;else delete Q[J4];return W}var k7=dK;var iK=Object.prototype,nK=iK.toString;function oK(Q){return nK.call(Q)}var v7=oK;var rK="[object Null]",tK="[object Undefined]",T7=R6?R6.toStringTag:void 0;function aK(Q){if(Q==null)return Q===void 0?tK:rK;return T7&&T7 in Object(Q)?k7(Q):v7(Q)}var x7=aK;function sK(Q){var X=typeof Q;return Q!=null&&(X=="object"||X=="function")}var R9=sK;var eK="[object AsyncFunction]",QV="[object Function]",XV="[object GeneratorFunction]",YV="[object Proxy]";function $V(Q){if(!R9(Q))return!1;var X=x7(Q);return X==QV||X==XV||X==eK||X==YV}var y7=$V;var WV=j6["__core-js_shared__"],I9=WV;var g7=function(){var Q=/[^.]+$/.exec(I9&&I9.keys&&I9.keys.IE_PROTO||"");return Q?"Symbol(src)_1."+Q:""}();function JV(Q){return!!g7&&g7 in Q}var h7=JV;var GV=Function.prototype,HV=GV.toString;function BV(Q){if(Q!=null){try{return HV.call(Q)}catch(X){}try{return Q+""}catch(X){}}return""}var f7=BV;var zV=/[\\^$.*+?()[\]{}|]/g,KV=/^\[object .+?Constructor\]$/,VV=Function.prototype,qV=Object.prototype,UV=VV.toString,LV=qV.hasOwnProperty,FV=RegExp("^"+UV.call(LV).replace(zV,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function NV(Q){if(!R9(Q)||h7(Q))return!1;var X=y7(Q)?FV:KV;return X.test(f7(Q))}var u7=NV;function OV(Q,X){return Q==null?void 0:Q[X]}var l7=OV;function DV(Q,X){var Y=l7(Q,X);return u7(Y)?Y:void 0}var b9=DV;var wV=b9(Object,"create"),L1=wV;function MV(){this.__data__=L1?L1(null):{},this.size=0}var m7=MV;function AV(Q){var X=this.has(Q)&&delete this.__data__[Q];return this.size-=X?1:0,X}var c7=AV;var jV="__lodash_hash_undefined__",RV=Object.prototype,IV=RV.hasOwnProperty;function bV(Q){var X=this.__data__;if(L1){var Y=X[Q];return Y===jV?void 0:Y}return IV.call(X,Q)?X[Q]:void 0}var p7=bV;var EV=Object.prototype,PV=EV.hasOwnProperty;function ZV(Q){var X=this.__data__;return L1?X[Q]!==void 0:PV.call(X,Q)}var d7=ZV;var SV="__lodash_hash_undefined__";function CV(Q,X){var Y=this.__data__;return this.size+=this.has(Q)?0:1,Y[Q]=L1&&X===void 0?SV:X,this}var i7=CV;function I6(Q){var X=-1,Y=Q==null?0:Q.length;this.clear();while(++X<Y){var $=Q[X];this.set($[0],$[1])}}I6.prototype.clear=m7;I6.prototype.delete=c7;I6.prototype.get=p7;I6.prototype.has=d7;I6.prototype.set=i7;var jQ=I6;function _V(){this.__data__=[],this.size=0}var n7=_V;function kV(Q,X){return Q===X||Q!==Q&&X!==X}var o7=kV;function vV(Q,X){var Y=Q.length;while(Y--)if(o7(Q[Y][0],X))return Y;return-1}var C1=vV;var TV=Array.prototype,xV=TV.splice;function yV(Q){var X=this.__data__,Y=C1(X,Q);if(Y<0)return!1;var $=X.length-1;if(Y==$)X.pop();else xV.call(X,Y,1);return--this.size,!0}var r7=yV;function gV(Q){var X=this.__data__,Y=C1(X,Q);return Y<0?void 0:X[Y][1]}var t7=gV;function hV(Q){return C1(this.__data__,Q)>-1}var a7=hV;function fV(Q,X){var Y=this.__data__,$=C1(Y,Q);if($<0)++this.size,Y.push([Q,X]);else Y[$][1]=X;return this}var s7=fV;function b6(Q){var X=-1,Y=Q==null?0:Q.length;this.clear();while(++X<Y){var $=Q[X];this.set($[0],$[1])}}b6.prototype.clear=n7;b6.prototype.delete=r7;b6.prototype.get=t7;b6.prototype.has=a7;b6.prototype.set=s7;var e7=b6;var uV=b9(j6,"Map"),Q5=uV;function lV(){this.size=0,this.__data__={hash:new jQ,map:new(Q5||e7),string:new jQ}}var X5=lV;function mV(Q){var X=typeof Q;return X=="string"||X=="number"||X=="symbol"||X=="boolean"?Q!=="__proto__":Q===null}var Y5=mV;function cV(Q,X){var Y=Q.__data__;return Y5(X)?Y[typeof X=="string"?"string":"hash"]:Y.map}var _1=cV;function pV(Q){var X=_1(this,Q).delete(Q);return this.size-=X?1:0,X}var $5=pV;function dV(Q){return _1(this,Q).get(Q)}var W5=dV;function iV(Q){return _1(this,Q).has(Q)}var J5=iV;function nV(Q,X){var Y=_1(this,Q),$=Y.size;return Y.set(Q,X),this.size+=Y.size==$?0:1,this}var G5=nV;function E6(Q){var X=-1,Y=Q==null?0:Q.length;this.clear();while(++X<Y){var $=Q[X];this.set($[0],$[1])}}E6.prototype.clear=X5;E6.prototype.delete=$5;E6.prototype.get=W5;E6.prototype.has=J5;E6.prototype.set=G5;var RQ=E6;var oV="Expected a function";function IQ(Q,X){if(typeof Q!="function"||X!=null&&typeof X!="function")throw TypeError(oV);var Y=function(){var $=arguments,W=X?X.apply(this,$):$[0],J=Y.cache;if(J.has(W))return J.get(W);var G=Q.apply(this,$);return Y.cache=J.set(W,G)||J,G};return Y.cache=new(IQ.Cache||RQ),Y}IQ.Cache=RQ;var k1=IQ;function rV(Q,X){if(Q.destroyed)return;Q.write(X)}function H5(Q){rV(process.stderr,Q)}var B5=k1((Q)=>{if(!Q||Q.trim()==="")return null;let X=Q.split(",").map((J)=>J.trim()).filter(Boolean);if(X.length===0)return null;let Y=X.some((J)=>J.startsWith("!")),$=X.some((J)=>!J.startsWith("!"));if(Y&&$)return null;let W=X.map((J)=>J.replace(/^!/,"").toLowerCase());return{include:Y?[]:W,exclude:Y?W:[],isExclusive:Y}});function tV(Q){let X=[],Y=Q.match(/^MCP server ["']([^"']+)["']/);if(Y&&Y[1])X.push("mcp"),X.push(Y[1].toLowerCase());else{let J=Q.match(/^([^:[]+):/);if(J&&J[1])X.push(J[1].trim().toLowerCase())}let $=Q.match(/^\[([^\]]+)]/);if($&&$[1])X.push($[1].trim().toLowerCase());if(Q.toLowerCase().includes("1p event:"))X.push("1p");let W=Q.match(/:\s*([^:]+?)(?:\s+(?:type|mode|status|event))?:/);if(W&&W[1]){let J=W[1].trim().toLowerCase();if(J.length<30&&!J.includes(" "))X.push(J)}return Array.from(new Set(X))}function aV(Q,X){if(!X)return!0;if(Q.length===0)return!1;if(X.isExclusive)return!Q.some((Y)=>X.exclude.includes(Y));else return Q.some((Y)=>X.include.includes(Y))}function z5(Q,X){if(!X)return!0;let Y=tV(Q);return aV(Y,X)}import{join as sV}from"path";import{homedir as eV}from"os";function P6(){return(process.env.CLAUDE_CONFIG_DIR??sV(eV(),".claude")).normalize("NFC")}function G4(Q){if(!Q)return!1;if(typeof Q==="boolean")return Q;let X=Q.toLowerCase().trim();return["1","true","yes","on"].includes(X)}import{dirname as F5,join as N5}from"path";import{cwd as Qq}from"process";import{realpathSync as K5}from"fs";import{randomUUID as Xq}from"crypto";function Yq(){let Q="";if(typeof process<"u"&&typeof process.cwd==="function"&&typeof K5==="function")Q=K5(Qq()).normalize("NFC");return{originalCwd:Q,projectRoot:Q,totalCostUSD:0,totalAPIDuration:0,totalAPIDurationWithoutRetries:0,totalToolDuration:0,turnHookDurationMs:0,turnToolDurationMs:0,turnClassifierDurationMs:0,startTime:Date.now(),lastInteractionTime:Date.now(),totalLinesAdded:0,totalLinesRemoved:0,hasUnknownModelCost:!1,cwd:Q,modelUsage:{},mainLoopModelOverride:void 0,initialMainLoopModel:null,modelStrings:null,isInteractive:!1,clientType:"cli",sessionSource:void 0,sessionIngressToken:void 0,oauthTokenFromFd:void 0,apiKeyFromFd:void 0,flagSettingsPath:void 0,flagSettingsInline:null,allowedSettingSources:["userSettings","projectSettings","localSettings","flagSettings","policySettings"],meter:null,sessionCounter:null,locCounter:null,prCounter:null,commitCounter:null,costCounter:null,tokenCounter:null,codeEditToolDecisionCounter:null,activeTimeCounter:null,statsStore:null,sessionId:Xq(),parentSessionId:void 0,loggerProvider:null,eventLogger:null,meterProvider:null,tracerProvider:null,agentColorMap:new Map,agentColorIndex:0,lastAPIRequest:null,inMemoryErrorLog:[],inlinePlugins:[],chromeFlagOverride:void 0,useCoworkPlugins:!1,sessionBypassPermissionsMode:!1,sessionTrustAccepted:!1,sessionPersistenceDisabled:!1,hasExitedPlanMode:!1,needsPlanModeExitAttachment:!1,lspRecommendationShownThisSession:!1,initJsonSchema:null,registeredHooks:null,planSlugCache:new Map,teleportedSessionInfo:null,invokedSkills:new Map,slowOperations:[],promptCacheBreaks:[],sdkBetas:void 0,mainThreadAgentType:void 0,isRemoteMode:!1,directConnectServerUrl:void 0,systemPromptSectionCache:new Map,lastEmittedDate:null,additionalDirectoriesForClaudeMd:[],resumedTranscriptPath:null,promptCache1hAllowlist:null,promptId:null}}var $q=Yq();function V5(){return $q.sessionId}function q5({writeFn:Q,flushIntervalMs:X=1000,maxBufferSize:Y=100,immediateMode:$=!1}){let W=[],J=null;function G(){if(J)clearTimeout(J),J=null}function H(){if(W.length===0)return;Q(W.join("")),W=[],G()}function B(){if(!J)J=setTimeout(H,X)}return{write(z){if($){Q(z);return}if(W.push(z),B(),W.length>=Y)H()},flush:H,dispose(){H()}}}var U5=new Set;function L5(Q){return U5.add(Q),()=>U5.delete(Q)}var Wq=k1(()=>{return G4(process.env.DEBUG)||G4(process.env.DEBUG_SDK)||process.argv.includes("--debug")||process.argv.includes("-d")||O5()||process.argv.some((Q)=>Q.startsWith("--debug="))||D5()!==null}),Jq=k1(()=>{let Q=process.argv.find((Y)=>Y.startsWith("--debug="));if(!Q)return null;let X=Q.substring(8);return B5(X)}),O5=k1(()=>{return process.argv.includes("--debug-to-stderr")||process.argv.includes("-d2e")}),D5=k1(()=>{for(let Q=0;Q<process.argv.length;Q++){let X=process.argv[Q];if(X.startsWith("--debug-file="))return X.substring(13);if(X==="--debug-file"&&Q+1<process.argv.length)return process.argv[Q+1]}return null});function Gq(Q){if(typeof process>"u"||typeof process.versions>"u"||typeof process.versions.node>"u")return!1;let X=Jq();return z5(Q,X)}var Hq=!1;var E9=null;function Bq(){if(!E9){let Q=null;E9=q5({writeFn:(X)=>{let Y=w5(),$=F5(Y);if(Q!==$){try{G1().mkdirSync($)}catch{}Q=$}G1().appendFileSync(Y,X),zq()},flushIntervalMs:1000,maxBufferSize:100,immediateMode:Wq()}),L5(async()=>E9?.dispose())}return E9}function F1(Q,{level:X}={level:"debug"}){if(!Gq(Q))return;if(Hq&&Q.includes(`
+    deps: ${Y}}`};var AR={keyword:"dependencies",type:"object",schemaType:"object",error:pB.error,code(Q){let[X,Y]=jR(Q);mB(Q,X),cB(Q,Y)}};function jR({schema:Q}){let X={},Y={};for(let $ in Q){if($==="__proto__")continue;let W=Array.isArray(Q[$])?X:Y;W[$]=Q[$]}return[X,Y]}function mB(Q,X=Q.schema){let{gen:Y,data:$,it:W}=Q;if(Object.keys(X).length===0)return;let J=Y.let("missing");for(let G in X){let H=X[G];if(H.length===0)continue;let B=(0,O9.propertyInData)(Y,$,G,W.opts.ownProperties);if(Q.setParams({property:G,depsCount:H.length,deps:H.join(", ")}),W.allErrors)Y.if(B,()=>{for(let z of H)(0,O9.checkReportMissingProp)(Q,z)});else Y.if(X7._`${B} && (${(0,O9.checkMissingProp)(Q,H,J)})`),(0,O9.reportMissingProp)(Q,J),Y.else()}}pB.validatePropertyDeps=mB;function cB(Q,X=Q.schema){let{gen:Y,data:$,keyword:W,it:J}=Q,G=Y.name("valid");for(let H in X){if((0,MR.alwaysValidSchema)(J,X[H]))continue;Y.if((0,O9.propertyInData)(Y,$,H,J.opts.ownProperties),()=>{let B=Q.subschema({keyword:W,schemaProp:H},G);Q.mergeValidEvaluated(B,G)},()=>Y.var(G,!0)),Q.ok(G)}}pB.validateSchemaDeps=cB;pB.default=AR});var tB=E((rB)=>{Object.defineProperty(rB,"__esModule",{value:!0});var oB=c(),bR=a(),ER={message:"property name must be valid",params:({params:Q})=>oB._`{propertyName: ${Q.propertyName}}`},PR={keyword:"propertyNames",type:"object",schemaType:["object","boolean"],error:ER,code(Q){let{gen:X,schema:Y,data:$,it:W}=Q;if((0,bR.alwaysValidSchema)(W,Y))return;let J=X.name("valid");X.forIn("key",$,(G)=>{Q.setParams({propertyName:G}),Q.subschema({keyword:"propertyNames",data:G,dataTypes:["string"],propertyName:G,compositeRule:!0},J),X.if((0,oB.not)(J),()=>{if(Q.error(!0),!W.allErrors)X.break()})}),Q.ok(J)}};rB.default=PR});var Y7=E((aB)=>{Object.defineProperty(aB,"__esModule",{value:!0});var qQ=o0(),W1=c(),SR=I1(),UQ=a(),CR={message:"must NOT have additional properties",params:({params:Q})=>W1._`{additionalProperty: ${Q.additionalProperty}}`},_R={keyword:"additionalProperties",type:["object"],schemaType:["boolean","object"],allowUndefined:!0,trackErrors:!0,error:CR,code(Q){let{gen:X,schema:Y,parentSchema:$,data:W,errsCount:J,it:G}=Q;if(!J)throw Error("ajv implementation error");let{allErrors:H,opts:B}=G;if(G.props=!0,B.removeAdditional!=="all"&&(0,UQ.alwaysValidSchema)(G,Y))return;let z=(0,qQ.allSchemaProperties)($.properties),K=(0,qQ.allSchemaProperties)($.patternProperties);q(),Q.ok(W1._`${J} === ${SR.default.errors}`);function q(){X.forIn("key",W,(w)=>{if(!z.length&&!K.length)L(w);else X.if(U(w),()=>L(w))})}function U(w){let D;if(z.length>8){let j=(0,UQ.schemaRefOrVal)(G,$.properties,"properties");D=(0,qQ.isOwnProperty)(X,j,w)}else if(z.length)D=(0,W1.or)(...z.map((j)=>W1._`${w} === ${j}`));else D=W1.nil;if(K.length)D=(0,W1.or)(D,...K.map((j)=>W1._`${(0,qQ.usePattern)(Q,j)}.test(${w})`));return(0,W1.not)(D)}function V(w){X.code(W1._`delete ${W}[${w}]`)}function L(w){if(B.removeAdditional==="all"||B.removeAdditional&&Y===!1){V(w);return}if(Y===!1){if(Q.setParams({additionalProperty:w}),Q.error(),!H)X.break();return}if(typeof Y=="object"&&!(0,UQ.alwaysValidSchema)(G,Y)){let D=X.name("valid");if(B.removeAdditional==="failing")F(w,D,!1),X.if((0,W1.not)(D),()=>{Q.reset(),V(w)});else if(F(w,D),!H)X.if((0,W1.not)(D),()=>X.break())}}function F(w,D,j){let I={keyword:"additionalProperties",dataProp:w,dataPropType:UQ.Type.Str};if(j===!1)Object.assign(I,{compositeRule:!0,createErrors:!1,allErrors:!1});Q.subschema(I,D)}}};aB.default=_R});var Xz=E((Qz)=>{Object.defineProperty(Qz,"__esModule",{value:!0});var vR=J9(),sB=o0(),$7=a(),eB=Y7(),TR={keyword:"properties",type:"object",schemaType:"object",code(Q){let{gen:X,schema:Y,parentSchema:$,data:W,it:J}=Q;if(J.opts.removeAdditional==="all"&&$.additionalProperties===void 0)eB.default.code(new vR.KeywordCxt(J,eB.default,"additionalProperties"));let G=(0,sB.allSchemaProperties)(Y);for(let q of G)J.definedProperties.add(q);if(J.opts.unevaluated&&G.length&&J.props!==!0)J.props=$7.mergeEvaluated.props(X,(0,$7.toHash)(G),J.props);let H=G.filter((q)=>!(0,$7.alwaysValidSchema)(J,Y[q]));if(H.length===0)return;let B=X.name("valid");for(let q of H){if(z(q))K(q);else{if(X.if((0,sB.propertyInData)(X,W,q,J.opts.ownProperties)),K(q),!J.allErrors)X.else().var(B,!0);X.endIf()}Q.it.definedProperties.add(q),Q.ok(B)}function z(q){return J.opts.useDefaults&&!J.compositeRule&&Y[q].default!==void 0}function K(q){Q.subschema({keyword:"properties",schemaProp:q,dataProp:q},B)}}};Qz.default=TR});var Gz=E((Jz)=>{Object.defineProperty(Jz,"__esModule",{value:!0});var Yz=o0(),LQ=c(),$z=a(),Wz=a(),yR={keyword:"patternProperties",type:"object",schemaType:"object",code(Q){let{gen:X,schema:Y,data:$,parentSchema:W,it:J}=Q,{opts:G}=J,H=(0,Yz.allSchemaProperties)(Y),B=H.filter((F)=>(0,$z.alwaysValidSchema)(J,Y[F]));if(H.length===0||B.length===H.length&&(!J.opts.unevaluated||J.props===!0))return;let z=G.strictSchema&&!G.allowMatchingProperties&&W.properties,K=X.name("valid");if(J.props!==!0&&!(J.props instanceof LQ.Name))J.props=(0,Wz.evaluatedPropsToName)(X,J.props);let{props:q}=J;U();function U(){for(let F of H){if(z)V(F);if(J.allErrors)L(F);else X.var(K,!0),L(F),X.if(K)}}function V(F){for(let w in z)if(new RegExp(F).test(w))(0,$z.checkStrictMode)(J,`property ${w} matches pattern ${F} (use allowMatchingProperties)`)}function L(F){X.forIn("key",$,(w)=>{X.if(LQ._`${(0,Yz.usePattern)(Q,F)}.test(${w})`,()=>{let D=B.includes(F);if(!D)Q.subschema({keyword:"patternProperties",schemaProp:F,dataProp:w,dataPropType:Wz.Type.Str},K);if(J.opts.unevaluated&&q!==!0)X.assign(LQ._`${q}[${w}]`,!0);else if(!D&&!J.allErrors)X.if((0,LQ.not)(K),()=>X.break())})})}}};Jz.default=yR});var Bz=E((Hz)=>{Object.defineProperty(Hz,"__esModule",{value:!0});var hR=a(),fR={keyword:"not",schemaType:["object","boolean"],trackErrors:!0,code(Q){let{gen:X,schema:Y,it:$}=Q;if((0,hR.alwaysValidSchema)($,Y)){Q.fail();return}let W=X.name("valid");Q.subschema({keyword:"not",compositeRule:!0,createErrors:!1,allErrors:!1},W),Q.failResult(W,()=>Q.reset(),()=>Q.error())},error:{message:"must NOT be valid"}};Hz.default=fR});var Kz=E((zz)=>{Object.defineProperty(zz,"__esModule",{value:!0});var lR=o0(),mR={keyword:"anyOf",schemaType:"array",trackErrors:!0,code:lR.validateUnion,error:{message:"must match a schema in anyOf"}};zz.default=mR});var qz=E((Vz)=>{Object.defineProperty(Vz,"__esModule",{value:!0});var FQ=c(),pR=a(),dR={message:"must match exactly one schema in oneOf",params:({params:Q})=>FQ._`{passingSchemas: ${Q.passing}}`},iR={keyword:"oneOf",schemaType:"array",trackErrors:!0,error:dR,code(Q){let{gen:X,schema:Y,parentSchema:$,it:W}=Q;if(!Array.isArray(Y))throw Error("ajv implementation error");if(W.opts.discriminator&&$.discriminator)return;let J=Y,G=X.let("valid",!1),H=X.let("passing",null),B=X.name("_valid");Q.setParams({passing:H}),X.block(z),Q.result(G,()=>Q.reset(),()=>Q.error(!0));function z(){J.forEach((K,q)=>{let U;if((0,pR.alwaysValidSchema)(W,K))X.var(B,!0);else U=Q.subschema({keyword:"oneOf",schemaProp:q,compositeRule:!0},B);if(q>0)X.if(FQ._`${B} && ${G}`).assign(G,!1).assign(H,FQ._`[${H}, ${q}]`).else();X.if(B,()=>{if(X.assign(G,!0),X.assign(H,q),U)Q.mergeEvaluated(U,FQ.Name)})})}}};Vz.default=iR});var Lz=E((Uz)=>{Object.defineProperty(Uz,"__esModule",{value:!0});var oR=a(),rR={keyword:"allOf",schemaType:"array",code(Q){let{gen:X,schema:Y,it:$}=Q;if(!Array.isArray(Y))throw Error("ajv implementation error");let W=X.name("valid");Y.forEach((J,G)=>{if((0,oR.alwaysValidSchema)($,J))return;let H=Q.subschema({keyword:"allOf",schemaProp:G},W);Q.ok(W),Q.mergeEvaluated(H)})}};Uz.default=rR});var Dz=E((Oz)=>{Object.defineProperty(Oz,"__esModule",{value:!0});var NQ=c(),Nz=a(),aR={message:({params:Q})=>NQ.str`must match "${Q.ifClause}" schema`,params:({params:Q})=>NQ._`{failingKeyword: ${Q.ifClause}}`},sR={keyword:"if",schemaType:["object","boolean"],trackErrors:!0,error:aR,code(Q){let{gen:X,parentSchema:Y,it:$}=Q;if(Y.then===void 0&&Y.else===void 0)(0,Nz.checkStrictMode)($,'"if" without "then" and "else" is ignored');let W=Fz($,"then"),J=Fz($,"else");if(!W&&!J)return;let G=X.let("valid",!0),H=X.name("_valid");if(B(),Q.reset(),W&&J){let K=X.let("ifClause");Q.setParams({ifClause:K}),X.if(H,z("then",K),z("else",K))}else if(W)X.if(H,z("then"));else X.if((0,NQ.not)(H),z("else"));Q.pass(G,()=>Q.error(!0));function B(){let K=Q.subschema({keyword:"if",compositeRule:!0,createErrors:!1,allErrors:!1},H);Q.mergeEvaluated(K)}function z(K,q){return()=>{let U=Q.subschema({keyword:K},H);if(X.assign(G,H),Q.mergeValidEvaluated(U,G),q)X.assign(q,NQ._`${K}`);else Q.setParams({ifClause:K})}}}};function Fz(Q,X){let Y=Q.schema[X];return Y!==void 0&&!(0,Nz.alwaysValidSchema)(Q,Y)}Oz.default=sR});var Mz=E((wz)=>{Object.defineProperty(wz,"__esModule",{value:!0});var QI=a(),XI={keyword:["then","else"],schemaType:["object","boolean"],code({keyword:Q,parentSchema:X,it:Y}){if(X.if===void 0)(0,QI.checkStrictMode)(Y,`"${Q}" without "if" is ignored`)}};wz.default=XI});var jz=E((Az)=>{Object.defineProperty(Az,"__esModule",{value:!0});var $I=e$(),WI=yB(),JI=Q7(),GI=fB(),HI=lB(),BI=nB(),zI=tB(),KI=Y7(),VI=Xz(),qI=Gz(),UI=Bz(),LI=Kz(),FI=qz(),NI=Lz(),OI=Dz(),DI=Mz();function wI(Q=!1){let X=[UI.default,LI.default,FI.default,NI.default,OI.default,DI.default,zI.default,KI.default,BI.default,VI.default,qI.default];if(Q)X.push(WI.default,GI.default);else X.push($I.default,JI.default);return X.push(HI.default),X}Az.default=wI});var Iz=E((Rz)=>{Object.defineProperty(Rz,"__esModule",{value:!0});var F0=c(),AI={message:({schemaCode:Q})=>F0.str`must match format "${Q}"`,params:({schemaCode:Q})=>F0._`{format: ${Q}}`},jI={keyword:"format",type:["number","string"],schemaType:"string",$data:!0,error:AI,code(Q,X){let{gen:Y,data:$,$data:W,schema:J,schemaCode:G,it:H}=Q,{opts:B,errSchemaPath:z,schemaEnv:K,self:q}=H;if(!B.validateFormats)return;if(W)U();else V();function U(){let L=Y.scopeValue("formats",{ref:q.formats,code:B.code.formats}),F=Y.const("fDef",F0._`${L}[${G}]`),w=Y.let("fType"),D=Y.let("format");Y.if(F0._`typeof ${F} == "object" && !(${F} instanceof RegExp)`,()=>Y.assign(w,F0._`${F}.type || "string"`).assign(D,F0._`${F}.validate`),()=>Y.assign(w,F0._`"string"`).assign(D,F)),Q.fail$data((0,F0.or)(j(),I()));function j(){if(B.strictSchema===!1)return F0.nil;return F0._`${G} && !${D}`}function I(){let T=K.$async?F0._`(${F}.async ? await ${D}(${$}) : ${D}(${$}))`:F0._`${D}(${$})`,v=F0._`(typeof ${D} == "function" ? ${T} : ${D}.test(${$}))`;return F0._`${D} && ${D} !== true && ${w} === ${X} && !${v}`}}function V(){let L=q.formats[J];if(!L){j();return}if(L===!0)return;let[F,w,D]=I(L);if(F===X)Q.pass(T());function j(){if(B.strictSchema===!1){q.logger.warn(v());return}throw Error(v());function v(){return`unknown format "${J}" ignored in schema at path "${z}"`}}function I(v){let N0=v instanceof RegExp?(0,F0.regexpCode)(v):B.code.formats?F0._`${B.code.formats}${(0,F0.getProperty)(J)}`:void 0,O0=Y.scopeValue("formats",{key:J,ref:v,code:N0});if(typeof v=="object"&&!(v instanceof RegExp))return[v.type||"string",v.validate,F0._`${O0}.validate`];return["string",v,O0]}function T(){if(typeof L=="object"&&!(L instanceof RegExp)&&L.async){if(!K.$async)throw Error("async format in sync schema");return F0._`await ${D}(${$})`}return typeof w=="function"?F0._`${D}(${$})`:F0._`${D}.test(${$})`}}}};Rz.default=jI});var Ez=E((bz)=>{Object.defineProperty(bz,"__esModule",{value:!0});var II=Iz(),bI=[II.default];bz.default=bI});var Sz=E((Pz)=>{Object.defineProperty(Pz,"__esModule",{value:!0});Pz.contentVocabulary=Pz.metadataVocabulary=void 0;Pz.metadataVocabulary=["title","description","default","deprecated","readOnly","writeOnly","examples"];Pz.contentVocabulary=["contentMediaType","contentEncoding","contentSchema"]});var kz=E((_z)=>{Object.defineProperty(_z,"__esModule",{value:!0});var ZI=QB(),SI=PB(),CI=jz(),_I=Ez(),Cz=Sz(),kI=[ZI.default,SI.default,(0,CI.default)(),_I.default,Cz.metadataVocabulary,Cz.contentVocabulary];_z.default=kI});var yz=E((Tz)=>{Object.defineProperty(Tz,"__esModule",{value:!0});Tz.DiscrError=void 0;var vz;(function(Q){Q.Tag="tag",Q.Mapping="mapping"})(vz||(Tz.DiscrError=vz={}))});var fz=E((hz)=>{Object.defineProperty(hz,"__esModule",{value:!0});var Q4=c(),W7=yz(),gz=s8(),TI=G9(),xI=a(),yI={message:({params:{discrError:Q,tagName:X}})=>Q===W7.DiscrError.Tag?`tag "${X}" must be string`:`value of tag "${X}" must be in oneOf`,params:({params:{discrError:Q,tag:X,tagName:Y}})=>Q4._`{error: ${Q}, tag: ${Y}, tagValue: ${X}}`},gI={keyword:"discriminator",type:"object",schemaType:"object",error:yI,code(Q){let{gen:X,data:Y,schema:$,parentSchema:W,it:J}=Q,{oneOf:G}=W;if(!J.opts.discriminator)throw Error("discriminator: requires discriminator option");let H=$.propertyName;if(typeof H!="string")throw Error("discriminator: requires propertyName");if($.mapping)throw Error("discriminator: mapping is not supported");if(!G)throw Error("discriminator: requires oneOf keyword");let B=X.let("valid",!1),z=X.const("tag",Q4._`${Y}${(0,Q4.getProperty)(H)}`);X.if(Q4._`typeof ${z} == "string"`,()=>K(),()=>Q.error(!1,{discrError:W7.DiscrError.Tag,tag:z,tagName:H})),Q.ok(B);function K(){let V=U();X.if(!1);for(let L in V)X.elseIf(Q4._`${z} === ${L}`),X.assign(B,q(V[L]));X.else(),Q.error(!1,{discrError:W7.DiscrError.Mapping,tag:z,tagName:H}),X.endIf()}function q(V){let L=X.name("valid"),F=Q.subschema({keyword:"oneOf",schemaProp:V},L);return Q.mergeEvaluated(F,Q4.Name),L}function U(){var V;let L={},F=D(W),w=!0;for(let T=0;T<G.length;T++){let v=G[T];if((v===null||v===void 0?void 0:v.$ref)&&!(0,xI.schemaHasRulesButRef)(v,J.self.RULES)){let O0=v.$ref;if(v=gz.resolveRef.call(J.self,J.schemaEnv.root,J.baseId,O0),v instanceof gz.SchemaEnv)v=v.schema;if(v===void 0)throw new TI.default(J.opts.uriResolver,J.baseId,O0)}let N0=(V=v===null||v===void 0?void 0:v.properties)===null||V===void 0?void 0:V[H];if(typeof N0!="object")throw Error(`discriminator: oneOf subschemas (or referenced schemas) must have "properties/${H}"`);w=w&&(F||D(v)),j(N0,T)}if(!w)throw Error(`discriminator: "${H}" must be required`);return L;function D({required:T}){return Array.isArray(T)&&T.includes(H)}function j(T,v){if(T.const)I(T.const,v);else if(T.enum)for(let N0 of T.enum)I(N0,v);else throw Error(`discriminator: "properties/${H}" must have "const" or "enum"`)}function I(T,v){if(typeof T!="string"||T in L)throw Error(`discriminator: "${H}" values must be unique strings`);L[T]=v}}}};hz.default=gI});var uz=E((zx,fI)=>{fI.exports={$schema:"http://json-schema.org/draft-07/schema#",$id:"http://json-schema.org/draft-07/schema#",title:"Core schema meta-schema",definitions:{schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},type:["object","boolean"],properties:{$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},default:!0}});var G7=E((h0,J7)=>{Object.defineProperty(h0,"__esModule",{value:!0});h0.MissingRefError=h0.ValidationError=h0.CodeGen=h0.Name=h0.nil=h0.stringify=h0.str=h0._=h0.KeywordCxt=h0.Ajv=void 0;var uI=pH(),lI=kz(),mI=fz(),lz=uz(),cI=["/properties"],OQ="http://json-schema.org/draft-07/schema";class D9 extends uI.default{_addVocabularies(){if(super._addVocabularies(),lI.default.forEach((Q)=>this.addVocabulary(Q)),this.opts.discriminator)this.addKeyword(mI.default)}_addDefaultMetaSchema(){if(super._addDefaultMetaSchema(),!this.opts.meta)return;let Q=this.opts.$data?this.$dataMetaSchema(lz,cI):lz;this.addMetaSchema(Q,OQ,!1),this.refs["http://json-schema.org/schema"]=OQ}defaultMeta(){return this.opts.defaultMeta=super.defaultMeta()||(this.getSchema(OQ)?OQ:void 0)}}h0.Ajv=D9;J7.exports=h0=D9;J7.exports.Ajv=D9;Object.defineProperty(h0,"__esModule",{value:!0});h0.default=D9;var pI=J9();Object.defineProperty(h0,"KeywordCxt",{enumerable:!0,get:function(){return pI.KeywordCxt}});var X4=c();Object.defineProperty(h0,"_",{enumerable:!0,get:function(){return X4._}});Object.defineProperty(h0,"str",{enumerable:!0,get:function(){return X4.str}});Object.defineProperty(h0,"stringify",{enumerable:!0,get:function(){return X4.stringify}});Object.defineProperty(h0,"nil",{enumerable:!0,get:function(){return X4.nil}});Object.defineProperty(h0,"Name",{enumerable:!0,get:function(){return X4.Name}});Object.defineProperty(h0,"CodeGen",{enumerable:!0,get:function(){return X4.CodeGen}});var dI=t8();Object.defineProperty(h0,"ValidationError",{enumerable:!0,get:function(){return dI.default}});var iI=G9();Object.defineProperty(h0,"MissingRefError",{enumerable:!0,get:function(){return iI.default}})});var az=E((rz)=>{Object.defineProperty(rz,"__esModule",{value:!0});rz.formatNames=rz.fastFormats=rz.fullFormats=void 0;function q1(Q,X){return{validate:Q,compare:X}}rz.fullFormats={date:q1(dz,K7),time:q1(B7(!0),V7),"date-time":q1(mz(!0),nz),"iso-time":q1(B7(),iz),"iso-date-time":q1(mz(),oz),duration:/^P(?!$)((\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+S)?)?|(\d+W)?)$/,uri:Qb,"uri-reference":/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,"uri-template":/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,url:/^(?:https?|ftp):\/\/(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)(?:\.(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)*(?:\.(?:[a-z\u{00a1}-\u{ffff}]{2,})))(?::\d{2,5})?(?:\/[^\s]*)?$/iu,email:/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,hostname:/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)\.){3}(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)$/,ipv6:/^((([0-9a-f]{1,4}:){7}([0-9a-f]{1,4}|:))|(([0-9a-f]{1,4}:){6}(:[0-9a-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){5}(((:[0-9a-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){4}(((:[0-9a-f]{1,4}){1,3})|((:[0-9a-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){3}(((:[0-9a-f]{1,4}){1,4})|((:[0-9a-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){2}(((:[0-9a-f]{1,4}){1,5})|((:[0-9a-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){1}(((:[0-9a-f]{1,4}){1,6})|((:[0-9a-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9a-f]{1,4}){1,7})|((:[0-9a-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))$/i,regex:Hb,uuid:/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,"json-pointer":/^(?:\/(?:[^~/]|~0|~1)*)*$/,"json-pointer-uri-fragment":/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,"relative-json-pointer":/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/,byte:Xb,int32:{type:"number",validate:Wb},int64:{type:"number",validate:Jb},float:{type:"number",validate:pz},double:{type:"number",validate:pz},password:!0,binary:!0};rz.fastFormats={...rz.fullFormats,date:q1(/^\d\d\d\d-[0-1]\d-[0-3]\d$/,K7),time:q1(/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,V7),"date-time":q1(/^\d\d\d\d-[0-1]\d-[0-3]\dt(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,nz),"iso-time":q1(/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,iz),"iso-date-time":q1(/^\d\d\d\d-[0-1]\d-[0-3]\d[t\s](?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,oz),uri:/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/)?[^\s]*$/i,"uri-reference":/^(?:(?:[a-z][a-z0-9+\-.]*:)?\/?\/)?(?:[^\\\s#][^\s#]*)?(?:#[^\\\s]*)?$/i,email:/^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)*$/i};rz.formatNames=Object.keys(rz.fullFormats);function rI(Q){return Q%4===0&&(Q%100!==0||Q%400===0)}var tI=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,aI=[0,31,28,31,30,31,30,31,31,30,31,30,31];function dz(Q){let X=tI.exec(Q);if(!X)return!1;let Y=+X[1],$=+X[2],W=+X[3];return $>=1&&$<=12&&W>=1&&W<=($===2&&rI(Y)?29:aI[$])}function K7(Q,X){if(!(Q&&X))return;if(Q>X)return 1;if(Q<X)return-1;return 0}var H7=/^(\d\d):(\d\d):(\d\d(?:\.\d+)?)(z|([+-])(\d\d)(?::?(\d\d))?)?$/i;function B7(Q){return function(Y){let $=H7.exec(Y);if(!$)return!1;let W=+$[1],J=+$[2],G=+$[3],H=$[4],B=$[5]==="-"?-1:1,z=+($[6]||0),K=+($[7]||0);if(z>23||K>59||Q&&!H)return!1;if(W<=23&&J<=59&&G<60)return!0;let q=J-K*B,U=W-z*B-(q<0?1:0);return(U===23||U===-1)&&(q===59||q===-1)&&G<61}}function V7(Q,X){if(!(Q&&X))return;let Y=new Date("2020-01-01T"+Q).valueOf(),$=new Date("2020-01-01T"+X).valueOf();if(!(Y&&$))return;return Y-$}function iz(Q,X){if(!(Q&&X))return;let Y=H7.exec(Q),$=H7.exec(X);if(!(Y&&$))return;if(Q=Y[1]+Y[2]+Y[3],X=$[1]+$[2]+$[3],Q>X)return 1;if(Q<X)return-1;return 0}var z7=/t|\s/i;function mz(Q){let X=B7(Q);return function($){let W=$.split(z7);return W.length===2&&dz(W[0])&&X(W[1])}}function nz(Q,X){if(!(Q&&X))return;let Y=new Date(Q).valueOf(),$=new Date(X).valueOf();if(!(Y&&$))return;return Y-$}function oz(Q,X){if(!(Q&&X))return;let[Y,$]=Q.split(z7),[W,J]=X.split(z7),G=K7(Y,W);if(G===void 0)return;return G||V7($,J)}var sI=/\/|:/,eI=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i;function Qb(Q){return sI.test(Q)&&eI.test(Q)}var cz=/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/gm;function Xb(Q){return cz.lastIndex=0,cz.test(Q)}var Yb=-2147483648,$b=2147483647;function Wb(Q){return Number.isInteger(Q)&&Q<=$b&&Q>=Yb}function Jb(Q){return Number.isInteger(Q)}function pz(){return!0}var Gb=/[^\\]\\Z/;function Hb(Q){if(Gb.test(Q))return!1;try{return new RegExp(Q),!0}catch(X){return!1}}});var ez=E((sz)=>{Object.defineProperty(sz,"__esModule",{value:!0});sz.formatLimitDefinition=void 0;var zb=G7(),J1=c(),o1=J1.operators,DQ={formatMaximum:{okStr:"<=",ok:o1.LTE,fail:o1.GT},formatMinimum:{okStr:">=",ok:o1.GTE,fail:o1.LT},formatExclusiveMaximum:{okStr:"<",ok:o1.LT,fail:o1.GTE},formatExclusiveMinimum:{okStr:">",ok:o1.GT,fail:o1.LTE}},Kb={message:({keyword:Q,schemaCode:X})=>J1.str`should be ${DQ[Q].okStr} ${X}`,params:({keyword:Q,schemaCode:X})=>J1._`{comparison: ${DQ[Q].okStr}, limit: ${X}}`};sz.formatLimitDefinition={keyword:Object.keys(DQ),type:"string",schemaType:"string",$data:!0,error:Kb,code(Q){let{gen:X,data:Y,schemaCode:$,keyword:W,it:J}=Q,{opts:G,self:H}=J;if(!G.validateFormats)return;let B=new zb.KeywordCxt(J,H.RULES.all.format.definition,"format");if(B.$data)z();else K();function z(){let U=X.scopeValue("formats",{ref:H.formats,code:G.code.formats}),V=X.const("fmt",J1._`${U}[${B.schemaCode}]`);Q.fail$data((0,J1.or)(J1._`typeof ${V} != "object"`,J1._`${V} instanceof RegExp`,J1._`typeof ${V}.compare != "function"`,q(V)))}function K(){let U=B.schema,V=H.formats[U];if(!V||V===!0)return;if(typeof V!="object"||V instanceof RegExp||typeof V.compare!="function")throw Error(`"${W}": format "${U}" does not define "compare" function`);let L=X.scopeValue("formats",{key:U,ref:V,code:G.code.formats?J1._`${G.code.formats}${(0,J1.getProperty)(U)}`:void 0});Q.fail$data(q(L))}function q(U){return J1._`${U}.compare(${Y}, ${$}) ${DQ[W].fail} 0`}},dependencies:["format"]};var Vb=(Q)=>{return Q.addKeyword(sz.formatLimitDefinition),Q};sz.default=Vb});var $K=E((w9,YK)=>{Object.defineProperty(w9,"__esModule",{value:!0});var Y4=az(),Ub=ez(),L7=c(),QK=new L7.Name("fullFormats"),Lb=new L7.Name("fastFormats"),F7=(Q,X={keywords:!0})=>{if(Array.isArray(X))return XK(Q,X,Y4.fullFormats,QK),Q;let[Y,$]=X.mode==="fast"?[Y4.fastFormats,Lb]:[Y4.fullFormats,QK],W=X.formats||Y4.formatNames;if(XK(Q,W,Y,$),X.keywords)(0,Ub.default)(Q);return Q};F7.get=(Q,X="full")=>{let $=(X==="fast"?Y4.fastFormats:Y4.fullFormats)[Q];if(!$)throw Error(`Unknown format "${Q}"`);return $};function XK(Q,X,Y,$){var W,J;(W=(J=Q.opts.code).formats)!==null&&W!==void 0||(J.formats=L7._`require("ajv-formats/dist/formats").${$}`);for(let G of X)Q.addFormat(G,Y[G])}YK.exports=w9=F7;Object.defineProperty(w9,"__esModule",{value:!0});w9.default=F7});import{join as LK}from"path";import{fileURLToPath as Ib}from"url";import{setMaxListeners as gK}from"events";var hK=50;function A6(Q=hK){let X=new AbortController;return gK(Q,X.signal),X}import{fork as Sq}from"child_process";import{createInterface as Cq}from"readline";import*as h from"fs";import{stat as qq,readdir as Uq,readFile as M5,unlink as Lq,rmdir as Fq,rm as Nq,mkdir as Oq,rename as Dq,open as wq}from"fs/promises";var fK=typeof global=="object"&&global&&global.Object===Object&&global,C7=fK;var uK=typeof self=="object"&&self&&self.Object===Object&&self,lK=C7||uK||Function("return this")(),j6=lK;var mK=j6.Symbol,R6=mK;var _7=Object.prototype,cK=_7.hasOwnProperty,pK=_7.toString,J4=R6?R6.toStringTag:void 0;function dK(Q){var X=cK.call(Q,J4),Y=Q[J4];try{Q[J4]=void 0;var $=!0}catch(J){}var W=pK.call(Q);if($)if(X)Q[J4]=Y;else delete Q[J4];return W}var k7=dK;var iK=Object.prototype,nK=iK.toString;function oK(Q){return nK.call(Q)}var v7=oK;var rK="[object Null]",tK="[object Undefined]",T7=R6?R6.toStringTag:void 0;function aK(Q){if(Q==null)return Q===void 0?tK:rK;return T7&&T7 in Object(Q)?k7(Q):v7(Q)}var x7=aK;function sK(Q){var X=typeof Q;return Q!=null&&(X=="object"||X=="function")}var R9=sK;var eK="[object AsyncFunction]",QV="[object Function]",XV="[object GeneratorFunction]",YV="[object Proxy]";function $V(Q){if(!R9(Q))return!1;var X=x7(Q);return X==QV||X==XV||X==eK||X==YV}var y7=$V;var WV=j6["__core-js_shared__"],I9=WV;var g7=function(){var Q=/[^.]+$/.exec(I9&&I9.keys&&I9.keys.IE_PROTO||"");return Q?"Symbol(src)_1."+Q:""}();function JV(Q){return!!g7&&g7 in Q}var h7=JV;var GV=Function.prototype,HV=GV.toString;function BV(Q){if(Q!=null){try{return HV.call(Q)}catch(X){}try{return Q+""}catch(X){}}return""}var f7=BV;var zV=/[\\^$.*+?()[\]{}|]/g,KV=/^\[object .+?Constructor\]$/,VV=Function.prototype,qV=Object.prototype,UV=VV.toString,LV=qV.hasOwnProperty,FV=RegExp("^"+UV.call(LV).replace(zV,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function NV(Q){if(!R9(Q)||h7(Q))return!1;var X=y7(Q)?FV:KV;return X.test(f7(Q))}var u7=NV;function OV(Q,X){return Q==null?void 0:Q[X]}var l7=OV;function DV(Q,X){var Y=l7(Q,X);return u7(Y)?Y:void 0}var b9=DV;var wV=b9(Object,"create"),L1=wV;function MV(){this.__data__=L1?L1(null):{},this.size=0}var m7=MV;function AV(Q){var X=this.has(Q)&&delete this.__data__[Q];return this.size-=X?1:0,X}var c7=AV;var jV="__lodash_hash_undefined__",RV=Object.prototype,IV=RV.hasOwnProperty;function bV(Q){var X=this.__data__;if(L1){var Y=X[Q];return Y===jV?void 0:Y}return IV.call(X,Q)?X[Q]:void 0}var p7=bV;var EV=Object.prototype,PV=EV.hasOwnProperty;function ZV(Q){var X=this.__data__;return L1?X[Q]!==void 0:PV.call(X,Q)}var d7=ZV;var SV="__lodash_hash_undefined__";function CV(Q,X){var Y=this.__data__;return this.size+=this.has(Q)?0:1,Y[Q]=L1&&X===void 0?SV:X,this}var i7=CV;function I6(Q){var X=-1,Y=Q==null?0:Q.length;this.clear();while(++X<Y){var $=Q[X];this.set($[0],$[1])}}I6.prototype.clear=m7;I6.prototype.delete=c7;I6.prototype.get=p7;I6.prototype.has=d7;I6.prototype.set=i7;var jQ=I6;function _V(){this.__data__=[],this.size=0}var n7=_V;function kV(Q,X){return Q===X||Q!==Q&&X!==X}var o7=kV;function vV(Q,X){var Y=Q.length;while(Y--)if(o7(Q[Y][0],X))return Y;return-1}var C1=vV;var TV=Array.prototype,xV=TV.splice;function yV(Q){var X=this.__data__,Y=C1(X,Q);if(Y<0)return!1;var $=X.length-1;if(Y==$)X.pop();else xV.call(X,Y,1);return--this.size,!0}var r7=yV;function gV(Q){var X=this.__data__,Y=C1(X,Q);return Y<0?void 0:X[Y][1]}var t7=gV;function hV(Q){return C1(this.__data__,Q)>-1}var a7=hV;function fV(Q,X){var Y=this.__data__,$=C1(Y,Q);if($<0)++this.size,Y.push([Q,X]);else Y[$][1]=X;return this}var s7=fV;function b6(Q){var X=-1,Y=Q==null?0:Q.length;this.clear();while(++X<Y){var $=Q[X];this.set($[0],$[1])}}b6.prototype.clear=n7;b6.prototype.delete=r7;b6.prototype.get=t7;b6.prototype.has=a7;b6.prototype.set=s7;var e7=b6;var uV=b9(j6,"Map"),Q5=uV;function lV(){this.size=0,this.__data__={hash:new jQ,map:new(Q5||e7),string:new jQ}}var X5=lV;function mV(Q){var X=typeof Q;return X=="string"||X=="number"||X=="symbol"||X=="boolean"?Q!=="__proto__":Q===null}var Y5=mV;function cV(Q,X){var Y=Q.__data__;return Y5(X)?Y[typeof X=="string"?"string":"hash"]:Y.map}var _1=cV;function pV(Q){var X=_1(this,Q).delete(Q);return this.size-=X?1:0,X}var $5=pV;function dV(Q){return _1(this,Q).get(Q)}var W5=dV;function iV(Q){return _1(this,Q).has(Q)}var J5=iV;function nV(Q,X){var Y=_1(this,Q),$=Y.size;return Y.set(Q,X),this.size+=Y.size==$?0:1,this}var G5=nV;function E6(Q){var X=-1,Y=Q==null?0:Q.length;this.clear();while(++X<Y){var $=Q[X];this.set($[0],$[1])}}E6.prototype.clear=X5;E6.prototype.delete=$5;E6.prototype.get=W5;E6.prototype.has=J5;E6.prototype.set=G5;var RQ=E6;var oV="Expected a function";function IQ(Q,X){if(typeof Q!="function"||X!=null&&typeof X!="function")throw TypeError(oV);var Y=function(){var $=arguments,W=X?X.apply(this,$):$[0],J=Y.cache;if(J.has(W))return J.get(W);var G=Q.apply(this,$);return Y.cache=J.set(W,G)||J,G};return Y.cache=new(IQ.Cache||RQ),Y}IQ.Cache=RQ;var k1=IQ;function rV(Q,X){if(Q.destroyed)return;Q.write(X)}function H5(Q){rV(process.stderr,Q)}var B5=k1((Q)=>{if(!Q||Q.trim()==="")return null;let X=Q.split(",").map((J)=>J.trim()).filter(Boolean);if(X.length===0)return null;let Y=X.some((J)=>J.startsWith("!")),$=X.some((J)=>!J.startsWith("!"));if(Y&&$)return null;let W=X.map((J)=>J.replace(/^!/,"").toLowerCase());return{include:Y?[]:W,exclude:Y?W:[],isExclusive:Y}});function tV(Q){let X=[],Y=Q.match(/^MCP server ["']([^"']+)["']/);if(Y&&Y[1])X.push("mcp"),X.push(Y[1].toLowerCase());else{let J=Q.match(/^([^:[]+):/);if(J&&J[1])X.push(J[1].trim().toLowerCase())}let $=Q.match(/^\[([^\]]+)]/);if($&&$[1])X.push($[1].trim().toLowerCase());if(Q.toLowerCase().includes("1p event:"))X.push("1p");let W=Q.match(/:\s*([^:]+?)(?:\s+(?:type|mode|status|event))?:/);if(W&&W[1]){let J=W[1].trim().toLowerCase();if(J.length<30&&!J.includes(" "))X.push(J)}return Array.from(new Set(X))}function aV(Q,X){if(!X)return!0;if(Q.length===0)return!1;if(X.isExclusive)return!Q.some((Y)=>X.exclude.includes(Y));else return Q.some((Y)=>X.include.includes(Y))}function z5(Q,X){if(!X)return!0;let Y=tV(Q);return aV(Y,X)}import{join as sV}from"path";import{homedir as eV}from"os";function P6(){return(process.env.CLAUDE_CONFIG_DIR??sV(eV(),".claude")).normalize("NFC")}function G4(Q){if(!Q)return!1;if(typeof Q==="boolean")return Q;let X=Q.toLowerCase().trim();return["1","true","yes","on"].includes(X)}import{dirname as F5,join as N5}from"path";import{cwd as Qq}from"process";import{realpathSync as K5}from"fs";import{randomUUID as Xq}from"crypto";function Yq(){let Q="";if(typeof process<"u"&&typeof process.cwd==="function"&&typeof K5==="function")Q=K5(Qq()).normalize("NFC");return{originalCwd:Q,projectRoot:Q,totalCostUSD:0,totalAPIDuration:0,totalAPIDurationWithoutRetries:0,totalToolDuration:0,turnHookDurationMs:0,turnToolDurationMs:0,turnClassifierDurationMs:0,startTime:Date.now(),lastInteractionTime:Date.now(),totalLinesAdded:0,totalLinesRemoved:0,hasUnknownModelCost:!1,cwd:Q,modelUsage:{},mainLoopModelOverride:void 0,initialMainLoopModel:null,modelStrings:null,isInteractive:!1,clientType:"cli",sessionSource:void 0,sessionIngressToken:void 0,oauthTokenFromFd:void 0,apiKeyFromFd:void 0,flagSettingsPath:void 0,flagSettingsInline:null,allowedSettingSources:["userSettings","projectSettings","localSettings","flagSettings","policySettings"],meter:null,sessionCounter:null,locCounter:null,prCounter:null,commitCounter:null,costCounter:null,tokenCounter:null,codeEditToolDecisionCounter:null,activeTimeCounter:null,statsStore:null,sessionId:Xq(),parentSessionId:void 0,loggerProvider:null,eventLogger:null,meterProvider:null,tracerProvider:null,agentColorMap:new Map,agentColorIndex:0,lastAPIRequest:null,inMemoryErrorLog:[],inlinePlugins:[],chromeFlagOverride:void 0,useCoworkPlugins:!1,sessionBypassPermissionsMode:!1,sessionTrustAccepted:!1,sessionPersistenceDisabled:!1,hasExitedPlanMode:!1,needsPlanModeExitAttachment:!1,lspRecommendationShownThisSession:!1,initJsonSchema:null,registeredHooks:null,planSlugCache:new Map,teleportedSessionInfo:null,invokedSkills:new Map,slowOperations:[],promptCacheBreaks:[],sdkBetas:void 0,mainThreadAgentType:void 0,isRemoteMode:!1,directConnectServerUrl:void 0,systemPromptSectionCache:new Map,lastEmittedDate:null,additionalDirectoriesForClaudeMd:[],resumedTranscriptPath:null,promptCache1hAllowlist:null,promptId:null}}var $q=Yq();function V5(){return $q.sessionId}function q5({writeFn:Q,flushIntervalMs:X=1000,maxBufferSize:Y=100,immediateMode:$=!1}){let W=[],J=null;function G(){if(J)clearTimeout(J),J=null}function H(){if(W.length===0)return;Q(W.join("")),W=[],G()}function B(){if(!J)J=setTimeout(H,X)}return{write(z){if($){Q(z);return}if(W.push(z),B(),W.length>=Y)H()},flush:H,dispose(){H()}}}var U5=new Set;function L5(Q){return U5.add(Q),()=>U5.delete(Q)}var Wq=k1(()=>{return G4(process.env.DEBUG)||G4(process.env.DEBUG_SDK)||process.argv.includes("--debug")||process.argv.includes("-d")||O5()||process.argv.some((Q)=>Q.startsWith("--debug="))||D5()!==null}),Jq=k1(()=>{let Q=process.argv.find((Y)=>Y.startsWith("--debug="));if(!Q)return null;let X=Q.substring(8);return B5(X)}),O5=k1(()=>{return process.argv.includes("--debug-to-stderr")||process.argv.includes("-d2e")}),D5=k1(()=>{for(let Q=0;Q<process.argv.length;Q++){let X=process.argv[Q];if(X.startsWith("--debug-file="))return X.substring(13);if(X==="--debug-file"&&Q+1<process.argv.length)return process.argv[Q+1]}return null});function Gq(Q){if(typeof process>"u"||typeof process.versions>"u"||typeof process.versions.node>"u")return!1;let X=Jq();return z5(Q,X)}var Hq=!1;var E9=null;function Bq(){if(!E9){let Q=null;E9=q5({writeFn:(X)=>{let Y=w5(),$=F5(Y);if(Q!==$){try{G1().mkdirSync($)}catch{}Q=$}G1().appendFileSync(Y,X),zq()},flushIntervalMs:1000,maxBufferSize:100,immediateMode:Wq()}),L5(async()=>E9?.dispose())}return E9}function F1(Q,{level:X}={level:"debug"}){if(!Gq(Q))return;if(Hq&&Q.includes(`
 `))Q=Z0(Q);let $=`${new Date().toISOString()} [${X.toUpperCase()}] ${Q.trim()}
 `;if(O5()){H5($);return}Bq().write($)}function w5(){return D5()??process.env.CLAUDE_CODE_DEBUG_LOGS_DIR??N5(P6(),"debug",`${V5()}.txt`)}var zq=k1(()=>{if(process.argv[2]==="--ripgrep")return;try{let Q=w5(),X=F5(Q),Y=N5(X,"latest");if(!G1().existsSync(X))G1().mkdirSync(X);if(G1().existsSync(Y))try{G1().unlinkSync(Y)}catch{}G1().symlinkSync(Q,Y)}catch{}});var tE=(()=>{let Q=process.env.CLAUDE_CODE_SLOW_OPERATION_THRESHOLD_MS;if(Q!==void 0){let X=Number(Q);if(!Number.isNaN(X)&&X>=0)return X}return 1/0})();var Kq={[Symbol.dispose](){}};function Vq(){return Kq}var V0=Vq;function Z0(Q,X,Y){let W=[];try{const $=X0(W,V0`JSON.stringify(${Q})`,0);return JSON.stringify(Q,X,Y)}catch(J){var G=J,H=1}finally{Y0(W,G,H)}}var P9=(Q,X)=>{let $=[];try{const Y=X0($,V0`JSON.parse(${Q})`,0);return typeof X>"u"?JSON.parse(Q):JSON.parse(Q,X)}catch(W){var J=W,G=1}finally{Y0($,J,G)}};var Mq={cwd(){return process.cwd()},existsSync(Q){let Y=[];try{const X=X0(Y,V0`fs.existsSync(${Q})`,0);return h.existsSync(Q)}catch($){var W=$,J=1}finally{Y0(Y,W,J)}},async stat(Q){return qq(Q)},async readdir(Q){return Uq(Q,{withFileTypes:!0})},async unlink(Q){return Lq(Q)},async rmdir(Q){return Fq(Q)},async rm(Q,X){return Nq(Q,X)},async mkdir(Q,X){await Oq(Q,{recursive:!0,...X})},async readFile(Q,X){return M5(Q,{encoding:X.encoding})},async rename(Q,X){return Dq(Q,X)},statSync(Q){let Y=[];try{const X=X0(Y,V0`fs.statSync(${Q})`,0);return h.statSync(Q)}catch($){var W=$,J=1}finally{Y0(Y,W,J)}},lstatSync(Q){let Y=[];try{const X=X0(Y,V0`fs.lstatSync(${Q})`,0);return h.lstatSync(Q)}catch($){var W=$,J=1}finally{Y0(Y,W,J)}},readFileSync(Q,X){let $=[];try{const Y=X0($,V0`fs.readFileSync(${Q})`,0);return h.readFileSync(Q,{encoding:X.encoding})}catch(W){var J=W,G=1}finally{Y0($,J,G)}},readFileBytesSync(Q){let Y=[];try{const X=X0(Y,V0`fs.readFileBytesSync(${Q})`,0);return h.readFileSync(Q)}catch($){var W=$,J=1}finally{Y0(Y,W,J)}},readSync(Q,X){let W=[];try{const Y=X0(W,V0`fs.readSync(${Q}, ${X.length} bytes)`,0);let $=void 0;try{$=h.openSync(Q,"r");let B=Buffer.alloc(X.length),z=h.readSync($,B,0,X.length,0);return{buffer:B,bytesRead:z}}finally{if($)h.closeSync($)}}catch(J){var G=J,H=1}finally{Y0(W,G,H)}},appendFileSync(Q,X,Y){let W=[];try{const $=X0(W,V0`fs.appendFileSync(${Q}, ${X.length} chars)`,0);if(!h.existsSync(Q)&&Y?.mode!==void 0){let B=h.openSync(Q,"a",Y.mode);try{h.appendFileSync(B,X)}finally{h.closeSync(B)}}else h.appendFileSync(Q,X)}catch(J){var G=J,H=1}finally{Y0(W,G,H)}},copyFileSync(Q,X){let $=[];try{const Y=X0($,V0`fs.copyFileSync(${Q}  ${X})`,0);h.copyFileSync(Q,X)}catch(W){var J=W,G=1}finally{Y0($,J,G)}},unlinkSync(Q){let Y=[];try{const X=X0(Y,V0`fs.unlinkSync(${Q})`,0);h.unlinkSync(Q)}catch($){var W=$,J=1}finally{Y0(Y,W,J)}},renameSync(Q,X){let $=[];try{const Y=X0($,V0`fs.renameSync(${Q}  ${X})`,0);h.renameSync(Q,X)}catch(W){var J=W,G=1}finally{Y0($,J,G)}},linkSync(Q,X){let $=[];try{const Y=X0($,V0`fs.linkSync(${Q}  ${X})`,0);h.linkSync(Q,X)}catch(W){var J=W,G=1}finally{Y0($,J,G)}},symlinkSync(Q,X,Y){let W=[];try{const $=X0(W,V0`fs.symlinkSync(${Q}  ${X})`,0);h.symlinkSync(Q,X,Y)}catch(J){var G=J,H=1}finally{Y0(W,G,H)}},readlinkSync(Q){let Y=[];try{const X=X0(Y,V0`fs.readlinkSync(${Q})`,0);return h.readlinkSync(Q)}catch($){var W=$,J=1}finally{Y0(Y,W,J)}},realpathSync(Q){let Y=[];try{const X=X0(Y,V0`fs.realpathSync(${Q})`,0);return h.realpathSync(Q).normalize("NFC")}catch($){var W=$,J=1}finally{Y0(Y,W,J)}},mkdirSync(Q,X){let $=[];try{const Y=X0($,V0`fs.mkdirSync(${Q})`,0);if(!h.existsSync(Q)){let H={recursive:!0};if(X?.mode!==void 0)H.mode=X.mode;h.mkdirSync(Q,H)}}catch(W){var J=W,G=1}finally{Y0($,J,G)}},readdirSync(Q){let Y=[];try{const X=X0(Y,V0`fs.readdirSync(${Q})`,0);return h.readdirSync(Q,{withFileTypes:!0})}catch($){var W=$,J=1}finally{Y0(Y,W,J)}},readdirStringSync(Q){let Y=[];try{const X=X0(Y,V0`fs.readdirStringSync(${Q})`,0);return h.readdirSync(Q)}catch($){var W=$,J=1}finally{Y0(Y,W,J)}},isDirEmptySync(Q){let $=[];try{const X=X0($,V0`fs.isDirEmptySync(${Q})`,0);let Y=this.readdirSync(Q);return Y.length===0}catch(W){var J=W,G=1}finally{Y0($,J,G)}},rmdirSync(Q){let Y=[];try{const X=X0(Y,V0`fs.rmdirSync(${Q})`,0);h.rmdirSync(Q)}catch($){var W=$,J=1}finally{Y0(Y,W,J)}},rmSync(Q,X){let $=[];try{const Y=X0($,V0`fs.rmSync(${Q})`,0);h.rmSync(Q,X)}catch(W){var J=W,G=1}finally{Y0($,J,G)}},createWriteStream(Q){return h.createWriteStream(Q)},async readFileBytes(Q,X){if(X===void 0)return M5(Q);let Y=await wq(Q,"r");try{let{size:$}=await Y.stat(),W=Math.min($,X),J=Buffer.allocUnsafe(W),G=0;while(G<W){let{bytesRead:H}=await Y.read(J,G,W-G,G);if(H===0)break;G+=H}return G<W?J.subarray(0,G):J}finally{await Y.close()}}},Aq=Mq;function G1(){return Aq}var jq=["PreToolUse","PostToolUse","PostToolUseFailure","Notification","UserPromptSubmit","SessionStart","SessionEnd","Stop","SubagentStart","SubagentStop","PreCompact","PermissionRequest","Setup","TeammateIdle","TaskCompleted","ConfigChange","WorktreeCreate","WorktreeRemove"],Rq=["clear","logout","prompt_input_exit","other","bypass_permissions_disabled"];class N1 extends Error{}function Z6(){return process.versions.bun!==void 0}import{randomUUID as Iq}from"crypto";import{appendFileSync as bq,existsSync as Eq,mkdirSync as Pq}from"fs";import{join as A5}from"path";var Z9=null,j5=!1;function Zq(){if(j5)return Z9;if(j5=!0,!process.env.DEBUG_CLAUDE_AGENT_SDK)return null;let Q=A5(P6(),"debug");if(Z9=A5(Q,`sdk-${Iq()}.txt`),!Eq(Q))Pq(Q,{recursive:!0});return process.stderr.write(`SDK debug logs: ${Z9}
 `),Z9}function O1(Q){let X=Zq();if(!X)return;let $=`${new Date().toISOString()} ${Q}
-`;bq(X,$)}function R5(Q,X){let Y={...Q};if(X){let $={sandbox:X};if(Y.settings)try{$={...P9(Y.settings),sandbox:X}}catch{}Y.settings=Z0($)}return Y}class H4{options;process;processStdin;processStdout;ready=!1;abortController;exitError;exitListeners=[];processExitHandler;abortHandler;constructor(Q){this.options=Q;this.abortController=Q.abortController||A6(),this.initialize()}getDefaultExecutable(){return Z6()?"bun":"node"}spawnLocalProcess(Q){let{command:X,args:Y,cwd:$,env:W,signal:J}=Q,G=W.DEBUG_CLAUDE_AGENT_SDK||this.options.stderr?"pipe":"ignore",H=Sq(X,Y,{cwd:$,stdio:["pipe","pipe",G],signal:J,env:W,windowsHide:!0});if(W.DEBUG_CLAUDE_AGENT_SDK||this.options.stderr)H.stderr.on("data",(z)=>{let K=z.toString();if(O1(K),this.options.stderr)this.options.stderr(K)});return{stdin:H.stdin,stdout:H.stdout,get killed(){return H.killed},get exitCode(){return H.exitCode},kill:H.kill.bind(H),on:H.on.bind(H),once:H.once.bind(H),off:H.off.bind(H)}}initialize(){try{let{additionalDirectories:Q=[],agent:X,betas:Y,cwd:$,executable:W=this.getDefaultExecutable(),executableArgs:J=[],extraArgs:G={},pathToClaudeCodeExecutable:H,env:B={...process.env},thinkingConfig:z,maxTurns:K,maxBudgetUsd:q,model:U,fallbackModel:V,jsonSchema:L,permissionMode:F,allowDangerouslySkipPermissions:w,permissionPromptToolName:D,continueConversation:j,resume:I,settingSources:T,allowedTools:v=[],disallowedTools:N0=[],tools:O0,mcpServers:c0,strictMcpConfig:t1,canUseTool:U1,includePartialMessages:a1,plugins:Z1,sandbox:s1}=this.options,u=["--output-format","stream-json","--verbose","--input-format","stream-json"];if(z)switch(z.type){case"enabled":if(z.budgetTokens===void 0)u.push("--thinking","adaptive");else u.push("--max-thinking-tokens",z.budgetTokens.toString());break;case"disabled":u.push("--thinking","disabled");break;case"adaptive":u.push("--thinking","adaptive");break}if(this.options.effort)u.push("--effort",this.options.effort);if(K)u.push("--max-turns",K.toString());if(q!==void 0)u.push("--max-budget-usd",q.toString());if(U)u.push("--model",U);if(X)u.push("--agent",X);if(Y&&Y.length>0)u.push("--betas",Y.join(","));if(L)u.push("--json-schema",Z0(L));if(this.options.debugFile)u.push("--debug-file",this.options.debugFile);else if(this.options.debug)u.push("--debug");if(B.DEBUG_CLAUDE_AGENT_SDK)u.push("--debug-to-stderr");if(U1){if(D)throw Error("canUseTool callback cannot be used with permissionPromptToolName. Please use one or the other.");u.push("--permission-prompt-tool","stdio")}else if(D)u.push("--permission-prompt-tool",D);if(j)u.push("--continue");if(I)u.push("--resume",I);if(v.length>0)u.push("--allowedTools",v.join(","));if(N0.length>0)u.push("--disallowedTools",N0.join(","));if(O0!==void 0)if(Array.isArray(O0))if(O0.length===0)u.push("--tools","");else u.push("--tools",O0.join(","));else u.push("--tools","default");if(c0&&Object.keys(c0).length>0)u.push("--mcp-config",Z0({mcpServers:c0}));if(T)u.push("--setting-sources",T.join(","));if(t1)u.push("--strict-mcp-config");if(F)u.push("--permission-mode",F);if(w)u.push("--allow-dangerously-skip-permissions");if(V){if(U&&V===U)throw Error("Fallback model cannot be the same as the main model. Please specify a different model for fallbackModel option.");u.push("--fallback-model",V)}if(a1)u.push("--include-partial-messages");for(let b0 of Q)u.push("--add-dir",b0);if(Z1&&Z1.length>0)for(let b0 of Z1)if(b0.type==="local")u.push("--plugin-dir",b0.path);else throw Error(`Unsupported plugin type: ${b0.type}`);if(this.options.forkSession)u.push("--fork-session");if(this.options.resumeSessionAt)u.push("--resume-session-at",this.options.resumeSessionAt);if(this.options.sessionId)u.push("--session-id",this.options.sessionId);if(this.options.persistSession===!1)u.push("--no-session-persistence");let wQ=R5(G??{},s1);for(let[b0,S1]of Object.entries(wQ))if(S1===null)u.push(`--${b0}`);else u.push(`--${b0}`,S1);if(!B.CLAUDE_CODE_ENTRYPOINT)B.CLAUDE_CODE_ENTRYPOINT="sdk-ts";if(delete B.NODE_OPTIONS,B.DEBUG_CLAUDE_AGENT_SDK)B.DEBUG="1";else delete B.DEBUG;let e1=_q(H),$4=e1?H:W,Q6=e1?[...J,...u]:[...J,H,...u],A9={command:$4,args:Q6,cwd:$,env:B,signal:this.abortController.signal};if(this.options.spawnClaudeCodeProcess)O1(`Spawning Claude Code (custom): ${$4} ${Q6.join(" ")}`),this.process=this.options.spawnClaudeCodeProcess(A9);else{if(!G1().existsSync(H)){let S1=e1?`Claude Code native binary not found at ${H}. Please ensure Claude Code is installed via native installer or specify a valid path with options.pathToClaudeCodeExecutable.`:`Claude Code executable not found at ${H}. Is options.pathToClaudeCodeExecutable set?`;throw ReferenceError(S1)}O1(`Spawning Claude Code: ${$4} ${Q6.join(" ")}`),this.process=this.spawnLocalProcess(A9)}this.processStdin=this.process.stdin,this.processStdout=this.process.stdout;let j9=()=>{if(this.process&&!this.process.killed)this.process.kill("SIGTERM")};this.processExitHandler=j9,this.abortHandler=j9,process.on("exit",this.processExitHandler),this.abortController.signal.addEventListener("abort",this.abortHandler),this.process.on("error",(b0)=>{if(this.ready=!1,this.abortController.signal.aborted)this.exitError=new N1("Claude Code process aborted by user");else this.exitError=Error(`Failed to spawn Claude Code process: ${b0.message}`),O1(this.exitError.message)}),this.process.on("exit",(b0,S1)=>{if(this.ready=!1,this.abortController.signal.aborted)this.exitError=new N1("Claude Code process aborted by user");else{let O6=this.getProcessExitError(b0,S1);if(O6)this.exitError=O6,O1(O6.message)}}),this.ready=!0}catch(Q){throw this.ready=!1,Q}}getProcessExitError(Q,X){if(Q!==0&&Q!==null)return Error(`Claude Code process exited with code ${Q}`);else if(X)return Error(`Claude Code process terminated by signal ${X}`);return}write(Q){if(this.abortController.signal.aborted)throw new N1("Operation aborted");if(!this.ready||!this.processStdin)throw Error("ProcessTransport is not ready for writing");if(this.process?.killed||this.process?.exitCode!==null)throw Error("Cannot write to terminated process");if(this.exitError)throw Error(`Cannot write to process that exited with error: ${this.exitError.message}`);O1(`[ProcessTransport] Writing to stdin: ${Q.substring(0,100)}`);try{if(!this.processStdin.write(Q))O1("[ProcessTransport] Write buffer full, data queued")}catch(X){throw this.ready=!1,Error(`Failed to write to process stdin: ${X.message}`)}}close(){if(this.processStdin)this.processStdin.end(),this.processStdin=void 0;if(this.abortHandler)this.abortController.signal.removeEventListener("abort",this.abortHandler),this.abortHandler=void 0;for(let{handler:Q}of this.exitListeners)this.process?.off("exit",Q);if(this.exitListeners=[],this.process&&!this.process.killed&&this.process.exitCode===null)this.process.kill("SIGTERM"),setTimeout(()=>{if(this.process&&!this.process.killed)this.process.kill("SIGKILL")},5000).unref();if(this.ready=!1,this.processExitHandler)process.off("exit",this.processExitHandler),this.processExitHandler=void 0}isReady(){return this.ready}async*readMessages(){if(!this.processStdout)throw Error("ProcessTransport output stream not available");let Q=Cq({input:this.processStdout});try{for await(let X of Q)if(X.trim())try{yield P9(X)}catch(Y){throw O1(`Non-JSON stdout: ${X}`),Error(`CLI output was not valid JSON. This may indicate an error during startup. Output: ${X.slice(0,200)}${X.length>200?"...":""}`)}await this.waitForExit()}catch(X){throw X}finally{Q.close()}}endInput(){if(this.processStdin)this.processStdin.end()}getInputStream(){return this.processStdin}onExit(Q){if(!this.process)return()=>{};let X=(Y,$)=>{let W=this.getProcessExitError(Y,$);Q(W)};return this.process.on("exit",X),this.exitListeners.push({callback:Q,handler:X}),()=>{if(this.process)this.process.off("exit",X);let Y=this.exitListeners.findIndex(($)=>$.handler===X);if(Y!==-1)this.exitListeners.splice(Y,1)}}async waitForExit(){if(!this.process){if(this.exitError)throw this.exitError;return}if(this.process.exitCode!==null||this.process.killed){if(this.exitError)throw this.exitError;return}return new Promise((Q,X)=>{let Y=(W,J)=>{if(this.abortController.signal.aborted){X(new N1("Operation aborted"));return}let G=this.getProcessExitError(W,J);if(G)X(G);else Q()};this.process.once("exit",Y);let $=(W)=>{this.process.off("exit",Y),X(W)};this.process.once("error",$),this.process.once("exit",()=>{this.process.off("error",$)})})}}function _q(Q){return![".js",".mjs",".tsx",".ts",".jsx"].some((Y)=>Q.endsWith(Y))}class B4{returned;queue=[];readResolve;readReject;isDone=!1;hasError;started=!1;constructor(Q){this.returned=Q}[Symbol.asyncIterator](){if(this.started)throw Error("Stream can only be iterated once");return this.started=!0,this}next(){if(this.queue.length>0)return Promise.resolve({done:!1,value:this.queue.shift()});if(this.isDone)return Promise.resolve({done:!0,value:void 0});if(this.hasError)return Promise.reject(this.hasError);return new Promise((Q,X)=>{this.readResolve=Q,this.readReject=X})}enqueue(Q){if(this.readResolve){let X=this.readResolve;this.readResolve=void 0,this.readReject=void 0,X({done:!1,value:Q})}else this.queue.push(Q)}done(){if(this.isDone=!0,this.readResolve){let Q=this.readResolve;this.readResolve=void 0,this.readReject=void 0,Q({done:!0,value:void 0})}}error(Q){if(this.hasError=Q,this.readReject){let X=this.readReject;this.readResolve=void 0,this.readReject=void 0,X(Q)}}return(){if(this.isDone=!0,this.returned)this.returned();return Promise.resolve({done:!0,value:void 0})}}class bQ{sendMcpMessage;isClosed=!1;constructor(Q){this.sendMcpMessage=Q}onclose;onerror;onmessage;async start(){}async send(Q){if(this.isClosed)throw Error("Transport is closed");this.sendMcpMessage(Q)}async close(){if(this.isClosed)return;this.isClosed=!0,this.onclose?.()}}import{randomUUID as kq}from"crypto";class z4{transport;isSingleUserTurn;canUseTool;hooks;abortController;jsonSchema;initConfig;pendingControlResponses=new Map;cleanupPerformed=!1;sdkMessages;inputStream=new B4;initialization;cancelControllers=new Map;hookCallbacks=new Map;nextCallbackId=0;sdkMcpTransports=new Map;sdkMcpServerInstances=new Map;pendingMcpResponses=new Map;firstResultReceivedResolve;firstResultReceived=!1;hasBidirectionalNeeds(){return this.sdkMcpTransports.size>0||this.hooks!==void 0&&Object.keys(this.hooks).length>0||this.canUseTool!==void 0}constructor(Q,X,Y,$,W,J=new Map,G,H){this.transport=Q;this.isSingleUserTurn=X;this.canUseTool=Y;this.hooks=$;this.abortController=W;this.jsonSchema=G;this.initConfig=H;for(let[B,z]of J)this.connectSdkMcpServer(B,z);this.sdkMessages=this.readSdkMessages(),this.readMessages(),this.initialization=this.initialize(),this.initialization.catch(()=>{})}setError(Q){this.inputStream.error(Q)}async stopTask(Q){await this.request({subtype:"stop_task",task_id:Q})}close(){this.cleanup()}cleanup(Q){if(this.cleanupPerformed)return;this.cleanupPerformed=!0;try{this.transport.close();let X=Error("Query closed before response received");for(let{reject:Y}of this.pendingControlResponses.values())Y(X);this.pendingControlResponses.clear();for(let{reject:Y}of this.pendingMcpResponses.values())Y(X);this.pendingMcpResponses.clear(),this.cancelControllers.clear(),this.hookCallbacks.clear();for(let Y of this.sdkMcpTransports.values())try{Y.close()}catch{}if(this.sdkMcpTransports.clear(),Q)this.inputStream.error(Q);else this.inputStream.done()}catch(X){}}next(...[Q]){return this.sdkMessages.next(...[Q])}return(Q){return this.sdkMessages.return(Q)}throw(Q){return this.sdkMessages.throw(Q)}[Symbol.asyncIterator](){return this.sdkMessages}[Symbol.asyncDispose](){return this.sdkMessages[Symbol.asyncDispose]()}async readMessages(){try{for await(let Q of this.transport.readMessages()){if(Q.type==="control_response"){let X=this.pendingControlResponses.get(Q.response.request_id);if(X)X.handler(Q.response);continue}else if(Q.type==="control_request"){this.handleControlRequest(Q);continue}else if(Q.type==="control_cancel_request"){this.handleControlCancelRequest(Q);continue}else if(Q.type==="keep_alive")continue;if(Q.type==="streamlined_text"||Q.type==="streamlined_tool_use_summary")continue;if(Q.type==="result"){if(this.firstResultReceived=!0,this.firstResultReceivedResolve)this.firstResultReceivedResolve();if(this.isSingleUserTurn)F1("[Query.readMessages] First result received for single-turn query, closing stdin"),this.transport.endInput()}this.inputStream.enqueue(Q)}if(this.firstResultReceivedResolve)this.firstResultReceivedResolve();this.inputStream.done(),this.cleanup()}catch(Q){if(this.firstResultReceivedResolve)this.firstResultReceivedResolve();this.inputStream.error(Q),this.cleanup(Q)}}async handleControlRequest(Q){let X=new AbortController;this.cancelControllers.set(Q.request_id,X);try{let Y=await this.processControlRequest(Q,X.signal),$={type:"control_response",response:{subtype:"success",request_id:Q.request_id,response:Y}};await Promise.resolve(this.transport.write(Z0($)+`
+`;bq(X,$)}function R5(Q,X){let Y={...Q};if(X){let $={sandbox:X};if(Y.settings)try{$={...P9(Y.settings),sandbox:X}}catch{}Y.settings=Z0($)}return Y}class H4{options;process;processStdin;processStdout;ready=!1;abortController;exitError;exitListeners=[];processExitHandler;abortHandler;constructor(Q){this.options=Q;this.abortController=Q.abortController||A6(),this.initialize()}getDefaultExecutable(){return Z6()?"bun":"node"}spawnLocalProcess(Q){let{args:Y,cwd:$,env:W,signal:J}=Q,G=W.DEBUG_CLAUDE_AGENT_SDK||this.options.stderr?"pipe":"ignore",H=Sq(Y[0],Y.slice(1),{cwd:$,stdio:G==="pipe"?["pipe","pipe","pipe","ipc"]:["pipe","pipe","ignore","ipc"],signal:J,env:W});if(W.DEBUG_CLAUDE_AGENT_SDK||this.options.stderr)H.stderr.on("data",(z)=>{let K=z.toString();if(O1(K),this.options.stderr)this.options.stderr(K)});return{stdin:H.stdin,stdout:H.stdout,get killed(){return H.killed},get exitCode(){return H.exitCode},kill:H.kill.bind(H),on:H.on.bind(H),once:H.once.bind(H),off:H.off.bind(H)}}initialize(){try{let{additionalDirectories:Q=[],agent:X,betas:Y,cwd:$,executable:W=this.getDefaultExecutable(),executableArgs:J=[],extraArgs:G={},pathToClaudeCodeExecutable:H,env:B={...process.env},thinkingConfig:z,maxTurns:K,maxBudgetUsd:q,model:U,fallbackModel:V,jsonSchema:L,permissionMode:F,allowDangerouslySkipPermissions:w,permissionPromptToolName:D,continueConversation:j,resume:I,settingSources:T,allowedTools:v=[],disallowedTools:N0=[],tools:O0,mcpServers:c0,strictMcpConfig:t1,canUseTool:U1,includePartialMessages:a1,plugins:Z1,sandbox:s1}=this.options,u=["--output-format","stream-json","--verbose","--input-format","stream-json"];if(z)switch(z.type){case"enabled":if(z.budgetTokens===void 0)u.push("--thinking","adaptive");else u.push("--max-thinking-tokens",z.budgetTokens.toString());break;case"disabled":u.push("--thinking","disabled");break;case"adaptive":u.push("--thinking","adaptive");break}if(this.options.effort)u.push("--effort",this.options.effort);if(K)u.push("--max-turns",K.toString());if(q!==void 0)u.push("--max-budget-usd",q.toString());if(U)u.push("--model",U);if(X)u.push("--agent",X);if(Y&&Y.length>0)u.push("--betas",Y.join(","));if(L)u.push("--json-schema",Z0(L));if(this.options.debugFile)u.push("--debug-file",this.options.debugFile);else if(this.options.debug)u.push("--debug");if(B.DEBUG_CLAUDE_AGENT_SDK)u.push("--debug-to-stderr");if(U1){if(D)throw Error("canUseTool callback cannot be used with permissionPromptToolName. Please use one or the other.");u.push("--permission-prompt-tool","stdio")}else if(D)u.push("--permission-prompt-tool",D);if(j)u.push("--continue");if(I)u.push("--resume",I);if(v.length>0)u.push("--allowedTools",v.join(","));if(N0.length>0)u.push("--disallowedTools",N0.join(","));if(O0!==void 0)if(Array.isArray(O0))if(O0.length===0)u.push("--tools","");else u.push("--tools",O0.join(","));else u.push("--tools","default");if(c0&&Object.keys(c0).length>0)u.push("--mcp-config",Z0({mcpServers:c0}));if(T)u.push("--setting-sources",T.join(","));if(t1)u.push("--strict-mcp-config");if(F)u.push("--permission-mode",F);if(w)u.push("--allow-dangerously-skip-permissions");if(V){if(U&&V===U)throw Error("Fallback model cannot be the same as the main model. Please specify a different model for fallbackModel option.");u.push("--fallback-model",V)}if(a1)u.push("--include-partial-messages");for(let b0 of Q)u.push("--add-dir",b0);if(Z1&&Z1.length>0)for(let b0 of Z1)if(b0.type==="local")u.push("--plugin-dir",b0.path);else throw Error(`Unsupported plugin type: ${b0.type}`);if(this.options.forkSession)u.push("--fork-session");if(this.options.resumeSessionAt)u.push("--resume-session-at",this.options.resumeSessionAt);if(this.options.sessionId)u.push("--session-id",this.options.sessionId);if(this.options.persistSession===!1)u.push("--no-session-persistence");let wQ=R5(G??{},s1);for(let[b0,S1]of Object.entries(wQ))if(S1===null)u.push(`--${b0}`);else u.push(`--${b0}`,S1);if(!B.CLAUDE_CODE_ENTRYPOINT)B.CLAUDE_CODE_ENTRYPOINT="sdk-ts";if(delete B.NODE_OPTIONS,B.DEBUG_CLAUDE_AGENT_SDK)B.DEBUG="1";else delete B.DEBUG;let e1=_q(H),$4=e1?H:W,Q6=e1?[...J,...u]:[...J,H,...u],A9={command:$4,args:Q6,cwd:$,env:B,signal:this.abortController.signal};if(this.options.spawnClaudeCodeProcess)O1(`Spawning Claude Code (custom): ${$4} ${Q6.join(" ")}`),this.process=this.options.spawnClaudeCodeProcess(A9);else{if(!G1().existsSync(H)){let S1=e1?`Claude Code native binary not found at ${H}. Please ensure Claude Code is installed via native installer or specify a valid path with options.pathToClaudeCodeExecutable.`:`Claude Code executable not found at ${H}. Is options.pathToClaudeCodeExecutable set?`;throw ReferenceError(S1)}O1(`Spawning Claude Code: ${$4} ${Q6.join(" ")}`),this.process=this.spawnLocalProcess(A9)}this.processStdin=this.process.stdin,this.processStdout=this.process.stdout;let j9=()=>{if(this.process&&!this.process.killed)this.process.kill("SIGTERM")};this.processExitHandler=j9,this.abortHandler=j9,process.on("exit",this.processExitHandler),this.abortController.signal.addEventListener("abort",this.abortHandler),this.process.on("error",(b0)=>{if(this.ready=!1,this.abortController.signal.aborted)this.exitError=new N1("Claude Code process aborted by user");else this.exitError=Error(`Failed to spawn Claude Code process: ${b0.message}`),O1(this.exitError.message)}),this.process.on("exit",(b0,S1)=>{if(this.ready=!1,this.abortController.signal.aborted)this.exitError=new N1("Claude Code process aborted by user");else{let O6=this.getProcessExitError(b0,S1);if(O6)this.exitError=O6,O1(O6.message)}}),this.ready=!0}catch(Q){throw this.ready=!1,Q}}getProcessExitError(Q,X){if(Q!==0&&Q!==null)return Error(`Claude Code process exited with code ${Q}`);else if(X)return Error(`Claude Code process terminated by signal ${X}`);return}write(Q){if(this.abortController.signal.aborted)throw new N1("Operation aborted");if(!this.ready||!this.processStdin)throw Error("ProcessTransport is not ready for writing");if(this.process?.killed||this.process?.exitCode!==null)throw Error("Cannot write to terminated process");if(this.exitError)throw Error(`Cannot write to process that exited with error: ${this.exitError.message}`);O1(`[ProcessTransport] Writing to stdin: ${Q.substring(0,100)}`);try{if(!this.processStdin.write(Q))O1("[ProcessTransport] Write buffer full, data queued")}catch(X){throw this.ready=!1,Error(`Failed to write to process stdin: ${X.message}`)}}close(){if(this.processStdin)this.processStdin.end(),this.processStdin=void 0;if(this.abortHandler)this.abortController.signal.removeEventListener("abort",this.abortHandler),this.abortHandler=void 0;for(let{handler:Q}of this.exitListeners)this.process?.off("exit",Q);if(this.exitListeners=[],this.process&&!this.process.killed&&this.process.exitCode===null)this.process.kill("SIGTERM"),setTimeout(()=>{if(this.process&&!this.process.killed)this.process.kill("SIGKILL")},5000).unref();if(this.ready=!1,this.processExitHandler)process.off("exit",this.processExitHandler),this.processExitHandler=void 0}isReady(){return this.ready}async*readMessages(){if(!this.processStdout)throw Error("ProcessTransport output stream not available");let Q=Cq({input:this.processStdout});try{for await(let X of Q)if(X.trim())try{yield P9(X)}catch(Y){throw O1(`Non-JSON stdout: ${X}`),Error(`CLI output was not valid JSON. This may indicate an error during startup. Output: ${X.slice(0,200)}${X.length>200?"...":""}`)}await this.waitForExit()}catch(X){throw X}finally{Q.close()}}endInput(){if(this.processStdin)this.processStdin.end()}getInputStream(){return this.processStdin}onExit(Q){if(!this.process)return()=>{};let X=(Y,$)=>{let W=this.getProcessExitError(Y,$);Q(W)};return this.process.on("exit",X),this.exitListeners.push({callback:Q,handler:X}),()=>{if(this.process)this.process.off("exit",X);let Y=this.exitListeners.findIndex(($)=>$.handler===X);if(Y!==-1)this.exitListeners.splice(Y,1)}}async waitForExit(){if(!this.process){if(this.exitError)throw this.exitError;return}if(this.process.exitCode!==null||this.process.killed){if(this.exitError)throw this.exitError;return}return new Promise((Q,X)=>{let Y=(W,J)=>{if(this.abortController.signal.aborted){X(new N1("Operation aborted"));return}let G=this.getProcessExitError(W,J);if(G)X(G);else Q()};this.process.once("exit",Y);let $=(W)=>{this.process.off("exit",Y),X(W)};this.process.once("error",$),this.process.once("exit",()=>{this.process.off("error",$)})})}}function _q(Q){return![".js",".mjs",".tsx",".ts",".jsx"].some((Y)=>Q.endsWith(Y))}class B4{returned;queue=[];readResolve;readReject;isDone=!1;hasError;started=!1;constructor(Q){this.returned=Q}[Symbol.asyncIterator](){if(this.started)throw Error("Stream can only be iterated once");return this.started=!0,this}next(){if(this.queue.length>0)return Promise.resolve({done:!1,value:this.queue.shift()});if(this.isDone)return Promise.resolve({done:!0,value:void 0});if(this.hasError)return Promise.reject(this.hasError);return new Promise((Q,X)=>{this.readResolve=Q,this.readReject=X})}enqueue(Q){if(this.readResolve){let X=this.readResolve;this.readResolve=void 0,this.readReject=void 0,X({done:!1,value:Q})}else this.queue.push(Q)}done(){if(this.isDone=!0,this.readResolve){let Q=this.readResolve;this.readResolve=void 0,this.readReject=void 0,Q({done:!0,value:void 0})}}error(Q){if(this.hasError=Q,this.readReject){let X=this.readReject;this.readResolve=void 0,this.readReject=void 0,X(Q)}}return(){if(this.isDone=!0,this.returned)this.returned();return Promise.resolve({done:!0,value:void 0})}}class bQ{sendMcpMessage;isClosed=!1;constructor(Q){this.sendMcpMessage=Q}onclose;onerror;onmessage;async start(){}async send(Q){if(this.isClosed)throw Error("Transport is closed");this.sendMcpMessage(Q)}async close(){if(this.isClosed)return;this.isClosed=!0,this.onclose?.()}}import{randomUUID as kq}from"crypto";class z4{transport;isSingleUserTurn;canUseTool;hooks;abortController;jsonSchema;initConfig;pendingControlResponses=new Map;cleanupPerformed=!1;sdkMessages;inputStream=new B4;initialization;cancelControllers=new Map;hookCallbacks=new Map;nextCallbackId=0;sdkMcpTransports=new Map;sdkMcpServerInstances=new Map;pendingMcpResponses=new Map;firstResultReceivedResolve;firstResultReceived=!1;hasBidirectionalNeeds(){return this.sdkMcpTransports.size>0||this.hooks!==void 0&&Object.keys(this.hooks).length>0||this.canUseTool!==void 0}constructor(Q,X,Y,$,W,J=new Map,G,H){this.transport=Q;this.isSingleUserTurn=X;this.canUseTool=Y;this.hooks=$;this.abortController=W;this.jsonSchema=G;this.initConfig=H;for(let[B,z]of J)this.connectSdkMcpServer(B,z);this.sdkMessages=this.readSdkMessages(),this.readMessages(),this.initialization=this.initialize(),this.initialization.catch(()=>{})}setError(Q){this.inputStream.error(Q)}async stopTask(Q){await this.request({subtype:"stop_task",task_id:Q})}close(){this.cleanup()}cleanup(Q){if(this.cleanupPerformed)return;this.cleanupPerformed=!0;try{this.transport.close();let X=Error("Query closed before response received");for(let{reject:Y}of this.pendingControlResponses.values())Y(X);this.pendingControlResponses.clear();for(let{reject:Y}of this.pendingMcpResponses.values())Y(X);this.pendingMcpResponses.clear(),this.cancelControllers.clear(),this.hookCallbacks.clear();for(let Y of this.sdkMcpTransports.values())try{Y.close()}catch{}if(this.sdkMcpTransports.clear(),Q)this.inputStream.error(Q);else this.inputStream.done()}catch(X){}}next(...[Q]){return this.sdkMessages.next(...[Q])}return(Q){return this.sdkMessages.return(Q)}throw(Q){return this.sdkMessages.throw(Q)}[Symbol.asyncIterator](){return this.sdkMessages}[Symbol.asyncDispose](){return this.sdkMessages[Symbol.asyncDispose]()}async readMessages(){try{for await(let Q of this.transport.readMessages()){if(Q.type==="control_response"){let X=this.pendingControlResponses.get(Q.response.request_id);if(X)X.handler(Q.response);continue}else if(Q.type==="control_request"){this.handleControlRequest(Q);continue}else if(Q.type==="control_cancel_request"){this.handleControlCancelRequest(Q);continue}else if(Q.type==="keep_alive")continue;if(Q.type==="streamlined_text"||Q.type==="streamlined_tool_use_summary")continue;if(Q.type==="result"){if(this.firstResultReceived=!0,this.firstResultReceivedResolve)this.firstResultReceivedResolve();if(this.isSingleUserTurn)F1("[Query.readMessages] First result received for single-turn query, closing stdin"),this.transport.endInput()}this.inputStream.enqueue(Q)}if(this.firstResultReceivedResolve)this.firstResultReceivedResolve();this.inputStream.done(),this.cleanup()}catch(Q){if(this.firstResultReceivedResolve)this.firstResultReceivedResolve();this.inputStream.error(Q),this.cleanup(Q)}}async handleControlRequest(Q){let X=new AbortController;this.cancelControllers.set(Q.request_id,X);try{let Y=await this.processControlRequest(Q,X.signal),$={type:"control_response",response:{subtype:"success",request_id:Q.request_id,response:Y}};await Promise.resolve(this.transport.write(Z0($)+`
 `))}catch(Y){let $={type:"control_response",response:{subtype:"error",request_id:Q.request_id,error:Y.message||String(Y)}};await Promise.resolve(this.transport.write(Z0($)+`
 `))}finally{this.cancelControllers.delete(Q.request_id)}}handleControlCancelRequest(Q){let X=this.cancelControllers.get(Q.request_id);if(X)X.abort(),this.cancelControllers.delete(Q.request_id)}async processControlRequest(Q,X){if(Q.request.subtype==="can_use_tool"){if(!this.canUseTool)throw Error("canUseTool callback is not provided.");return{...await this.canUseTool(Q.request.tool_name,Q.request.input,{signal:X,suggestions:Q.request.permission_suggestions,blockedPath:Q.request.blocked_path,decisionReason:Q.request.decision_reason,toolUseID:Q.request.tool_use_id,agentID:Q.request.agent_id}),toolUseID:Q.request.tool_use_id}}else if(Q.request.subtype==="hook_callback")return await this.handleHookCallbacks(Q.request.callback_id,Q.request.input,Q.request.tool_use_id,X);else if(Q.request.subtype==="mcp_message"){let Y=Q.request,$=this.sdkMcpTransports.get(Y.server_name);if(!$)throw Error(`SDK MCP server not found: ${Y.server_name}`);if("method"in Y.message&&"id"in Y.message&&Y.message.id!==null)return{mcp_response:await this.handleMcpControlRequest(Y.server_name,Y,$)};else{if($.onmessage)$.onmessage(Y.message);return{mcp_response:{jsonrpc:"2.0",result:{},id:0}}}}throw Error("Unsupported control request subtype: "+Q.request.subtype)}async*readSdkMessages(){for await(let Q of this.inputStream)yield Q}async initialize(){let Q;if(this.hooks){Q={};for(let[W,J]of Object.entries(this.hooks))if(J.length>0)Q[W]=J.map((G)=>{let H=[];for(let B of G.hooks){let z=`hook_${this.nextCallbackId++}`;this.hookCallbacks.set(z,B),H.push(z)}return{matcher:G.matcher,hookCallbackIds:H,timeout:G.timeout}})}let X=this.sdkMcpTransports.size>0?Array.from(this.sdkMcpTransports.keys()):void 0,Y={subtype:"initialize",hooks:Q,sdkMcpServers:X,jsonSchema:this.jsonSchema,systemPrompt:this.initConfig?.systemPrompt,appendSystemPrompt:this.initConfig?.appendSystemPrompt,agents:this.initConfig?.agents,promptSuggestions:this.initConfig?.promptSuggestions};return(await this.request(Y)).response}async interrupt(){await this.request({subtype:"interrupt"})}async setPermissionMode(Q){await this.request({subtype:"set_permission_mode",mode:Q})}async setModel(Q){await this.request({subtype:"set_model",model:Q})}async setMaxThinkingTokens(Q){await this.request({subtype:"set_max_thinking_tokens",max_thinking_tokens:Q})}async applyFlagSettings(Q){await this.request({subtype:"apply_flag_settings",settings:Q})}async rewindFiles(Q,X){return(await this.request({subtype:"rewind_files",user_message_id:Q,dry_run:X?.dryRun})).response}async processPendingPermissionRequests(Q){for(let X of Q)if(X.request.subtype==="can_use_tool")this.handleControlRequest(X).catch(()=>{})}request(Q){let X=Math.random().toString(36).substring(2,15),Y={request_id:X,type:"control_request",request:Q};return new Promise(($,W)=>{this.pendingControlResponses.set(X,{handler:(J)=>{if(this.pendingControlResponses.delete(X),J.subtype==="success")$(J);else if(W(Error(J.error)),J.pending_permission_requests)this.processPendingPermissionRequests(J.pending_permission_requests)},reject:W}),Promise.resolve(this.transport.write(Z0(Y)+`
 `))})}async initializationResult(){return this.initialization}async supportedCommands(){return(await this.initialization).commands}async supportedModels(){return(await this.initialization).models}async reconnectMcpServer(Q){await this.request({subtype:"mcp_reconnect",serverName:Q})}async toggleMcpServer(Q,X){await this.request({subtype:"mcp_toggle",serverName:Q,enabled:X})}async mcpAuthenticate(Q){return(await this.request({subtype:"mcp_authenticate",serverName:Q})).response}async mcpClearAuth(Q){return(await this.request({subtype:"mcp_clear_auth",serverName:Q})).response}async mcpServerStatus(){return(await this.request({subtype:"mcp_status"})).response.mcpServers}async setMcpServers(Q){let X={},Y={};for(let[H,B]of Object.entries(Q))if(B.type==="sdk"&&"instance"in B)X[H]=B.instance;else Y[H]=B;let $=new Set(this.sdkMcpServerInstances.keys()),W=new Set(Object.keys(X));for(let H of $)if(!W.has(H))await this.disconnectSdkMcpServer(H);for(let[H,B]of Object.entries(X))if(!$.has(H))this.connectSdkMcpServer(H,B);let J={};for(let H of Object.keys(X))J[H]={type:"sdk",name:H};return(await this.request({subtype:"mcp_set_servers",servers:{...Y,...J}})).response}async accountInfo(){return(await this.initialization).account}async streamInput(Q){F1("[Query.streamInput] Starting to process input stream");try{let X=0;for await(let Y of Q){if(X++,F1(`[Query.streamInput] Processing message ${X}: ${Y.type}`),this.abortController?.signal.aborted)break;await Promise.resolve(this.transport.write(Z0(Y)+`
